<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CVE-2025-13329 File Uploader for WooCommerce | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="CVE-2025-13329 File Uploader for WooCommerce &lt;&#x3D; 1.0.3 - Unauthenticated Arbitrary File Upload via add-image-data File Uploader for WooCommerce PluginOverview Published: 2025-12-20 CVE-ID: CVE-">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2025-13329 File Uploader for WooCommerce">
<meta property="og:url" content="https://pzhat.github.io/2026/02/03/2026-02-03-CVE-2025-13329/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="CVE-2025-13329 File Uploader for WooCommerce &lt;&#x3D; 1.0.3 - Unauthenticated Arbitrary File Upload via add-image-data File Uploader for WooCommerce PluginOverview Published: 2025-12-20 CVE-ID: CVE-">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2026-02-03T15:56:51.995Z">
<meta property="article:modified_time" content="2026-02-03T16:06:57.409Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="WordPress">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CVE-2025-13329 File Uploader for WooCommerce",
  "url": "https://pzhat.github.io/2026/02/03/2026-02-03-CVE-2025-13329/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2026-02-03T15:56:51.995Z",
  "dateModified": "2026-02-03T16:06:57.409Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2026/02/03/2026-02-03-CVE-2025-13329/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CVE-2025-13329 File Uploader for WooCommerce',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">CVE-2025-13329 File Uploader for WooCommerce</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">CVE-2025-13329 File Uploader for WooCommerce</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-02-03T15:56:51.995Z" title="Created 2026-02-03 22:56:51">2026-02-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-03T16:06:57.409Z" title="Updated 2026-02-03 23:06:57">2026-02-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/CVE/">CVE</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="CVE-2025-13329-File-Uploader-for-WooCommerce"><a href="#CVE-2025-13329-File-Uploader-for-WooCommerce" class="headerlink" title="CVE-2025-13329 File Uploader for WooCommerce &lt;&#x3D; 1.0.3 - Unauthenticated Arbitrary File Upload via add-image-data"></a>CVE-2025-13329 File Uploader for WooCommerce &lt;&#x3D; 1.0.3 - Unauthenticated Arbitrary File Upload via add-image-data</h1><p><img src="https://hackmd.io/_uploads/SJGvzVA8bg.png" alt="image"></p>
<h1 id="File-Uploader-for-WooCommerce-Plugin"><a href="#File-Uploader-for-WooCommerce-Plugin" class="headerlink" title="File Uploader for WooCommerce Plugin"></a>File Uploader for WooCommerce Plugin</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul>
<li><strong>Published:</strong> 2025-12-20</li>
<li><strong>CVE-ID:</strong> CVE-2025-13329</li>
<li><strong>Affected Plugin:</strong> File Uploader for WooCommerce</li>
<li><strong>Affected Versions:</strong> &lt;&#x3D; 1.0.3</li>
<li><strong>Vulnerability Type:</strong> Unauthenticated Arbitrary File Upload via add-image-data</li>
<li><strong>CWE-434:</strong> CWE-434 Unrestricted Upload of File with Dangerous Type</li>
</ul>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><strong>The File Uploader for WooCommerce</strong> plugin for <strong>WordPress</strong> is <strong>vulnerable to arbitrary file uploads</strong> due to missing file type validation in the callback function for the <strong>‘add-image-data’</strong> <strong>REST API</strong> endpoint in all versions up to, and including, <strong>1.0.3</strong>. This makes it possible for <strong>unauthenticated</strong> attackers to upload arbitrary files to the Uploadcare service and subsequently download them on the affected site’s server which may make <strong>remote code execution</strong> possible.</p>
<h2 id="Patch-Commit-Analysis"><a href="#Patch-Commit-Analysis" class="headerlink" title="Patch &amp; Commit Analysis"></a>Patch &amp; Commit Analysis</h2><p>Comparing the source code of version <strong>1.0.3</strong> and <strong>1.0.4</strong>, I identified two <strong>critical changes</strong> that address the vulnerability:</p>
<p><img src="https://hackmd.io/_uploads/ByC98lJD-x.png" alt="image"></p>
<p><strong>Authorization Check <code>src/JsonApi/class-imagejsonapi.php</code></strong>:</p>
<p>In the vulnerable version, the <strong>REST API</strong> endpoint <strong>add-image-data</strong> was publicly accessible because the <strong>permission_callback</strong> was set to allow any user.</p>
<ul>
<li><p><strong>Vulnerable Code (v1.0.3)</strong>: The <strong>check_user_permissions</strong> function simply returned true, and there was no <strong>Nonce verification</strong> in the <strong>register_rest_route</strong> callback.</p>
</li>
<li><p><strong>Patched Code (v1.0.4)</strong>: The developer added a <strong>Nonce verification</strong> step. The server now checks for a valid <strong>wcu_upload_nonce</strong> before processing the request. If the nonce is missing or invalid, it returns a <strong>403 Forbidden</strong> error.</p>
</li>
</ul>
<p><img src="https://hackmd.io/_uploads/SylA_l1PWl.png" alt="image"></p>
<p><strong>File Extension Validation <code>src/Classes/Helpers/UploaderHelper.php</code></strong></p>
<p>The most <strong>critical fix</strong> was applied to the file <strong>handling logic</strong>.</p>
<ul>
<li><strong>Vulnerable Code (v1.0.3):</strong> The <strong>upload_image</strong> function accepted the <strong>fileName parameter</strong> directly from the <strong>user request</strong> and used it to save the file on the server. There was <strong>no validation</strong> of the file <strong>extension</strong>.</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// v1.0.3 logic</span></span><br><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">sanitize_text_field</span>( <span class="variable">$uuid</span> . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$filename_from_url</span>[<span class="string">&#x27;extension&#x27;</span>] );</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Patched Code (v1.0.4):</strong> The developer implemented a strict <strong>Allowlist (Whitelist)</strong> mechanism.<ul>
<li><strong>Uses wp_check_filetype()</strong> to validate the file type.</li>
<li>Defines an <strong>$allowed_types</strong> array containing only image formats (jpg, jpeg, png, gif, webp).</li>
<li>If the uploaded <strong>file’s extension</strong> does not match the <strong>allowlist</strong>, the process is <strong>terminated immediately</strong>.</li>
</ul>
</li>
</ul>
<h2 id="Root-Cause-Analysis"><a href="#Root-Cause-Analysis" class="headerlink" title="Root Cause Analysis"></a>Root Cause Analysis</h2><p>The vulnerability stems from a combination of Insecure Design in the API endpoint and Insufficient Input Validation.</p>
<p><strong>Entry Point (class-imagejsonapi.php):</strong> The plugin registers a custom <strong>REST API</strong> route <strong>&#x2F;wp-json&#x2F;v1&#x2F;add-image-data</strong>. The <strong>check_user_permissions()</strong> method explicitly returns true, allowing unauthenticated access.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check_user_permissions</span>(<span class="params"></span>): <span class="title">bool</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// Allow logged-out users.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>The Exploit Sink (class-uploaderhelper.php):</strong> The <strong>upload_image</strong> function retrieves a file from the <strong>Uploadcare CDN</strong> (ucarecdn.com) using a provided <strong>UUID</strong>.</p>
<ul>
<li>The function constructs the local file path using the fileName parameter supplied by the user:</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filename_from_url</span> = <span class="title function_ invoke__">pathinfo</span>( <span class="variable">$original_file_name</span> );</span><br><span class="line"><span class="keyword">if</span> ( ! <span class="keyword">isset</span>( <span class="variable">$filename_from_url</span>[<span class="string">&#x27;extension&#x27;</span>] ) || ! <span class="variable">$filename_from_url</span>[<span class="string">&#x27;extension&#x27;</span>] ) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$upload_dir</span>    = <span class="title function_ invoke__">wp_get_upload_dir</span>();</span><br><span class="line"><span class="variable">$file_name</span>     = <span class="title function_ invoke__">sanitize_text_field</span>( <span class="variable">$uuid</span> . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$filename_from_url</span>[<span class="string">&#x27;extension&#x27;</span>] );</span><br><span class="line"><span class="variable">$modifications</span> = <span class="title function_ invoke__">sanitize_text_field</span>( <span class="variable">$modifications</span> );</span><br><span class="line"></span><br><span class="line"><span class="variable">$file_path</span> = <span class="variable">$upload_dir</span>[<span class="string">&#x27;basedir&#x27;</span>] . <span class="string">&#x27;/file-uploader/&#x27;</span> . <span class="variable">$file_name</span>;</span><br><span class="line"><span class="keyword">if</span> ( <span class="title function_ invoke__">is_file</span>( <span class="variable">$file_path</span> ) ) &#123;</span><br><span class="line">	<span class="title function_ invoke__">unlink</span>( <span class="variable">$file_path</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Since <strong>sanitize_text_field</strong> does validate file’s <strong>extension</strong> (ex: .php), an attacker can supply a <strong>malicious filename</strong> (e.g., shell.php).</li>
<li>The plugin then <strong>downloads</strong> the <strong>content</strong> from <strong>Uploadcare</strong> and <strong>saves</strong> it to the WordPress uploads directory with the <strong>executable extension</strong>.</li>
</ul>
<p><img src="https://hackmd.io/_uploads/Hyorj-kPbg.png" alt="image"></p>
<p>Tracing the <strong>execution flow</strong> reveals that the <strong>$original_file_name</strong> variable is populated directly from the request’s <strong>fileName parameter</strong>. As seen in the debugger, the value <strong>‘pokemon00.jpg’</strong> is assigned <strong>without any validation</strong> against a strict <strong>allowlist</strong> at this stage.</p>
<p><img src="https://hackmd.io/_uploads/B1c_ezkvbe.png" alt="image"></p>
<p>The <strong>execution flow</strong> then proceeds to the <strong>UploaderHelper:upload_image</strong> method. Here, the root cause of the vulnerability is exposed. The code utilizes <strong>pathinfo()</strong> to parse the extension from the unverified <strong>$original_file_name</strong>.</p>
<p>Crucially, instead of verifying if this <strong>extension</strong> is a safe image format (like PNG or JPEG), the code <strong>blindly concatenates</strong> it to the <strong>UUID</strong>. The screenshot demonstrates this behavior, where the $file_name variable is constructed using the attacker-controlled extension.</p>
<h2 id="Proof-Of-Concept"><a href="#Proof-Of-Concept" class="headerlink" title="Proof Of Concept"></a>Proof Of Concept</h2><p><img src="https://hackmd.io/_uploads/HkI6WckDWl.png" alt="image"></p>
<p>As observed in UploaderHelper.php (line 56), the plugin hardcodes the download URL to the ucarecdn.com domain. However, when I uploaded the shell payload via a free Uploadcare account, the file was hosted on ucarecd.net (specifically 2pn21h45pa.ucarecd.net).</p>
<p><img src="https://hackmd.io/_uploads/r1UimcJvWl.png" alt="image"></p>
<p>The Reality of the Payload, my <strong>browser</strong> clearly shows that your <strong>uploaded payload (phpinfo)</strong> is being hosted on a <strong>different domain</strong>: ucarecd.net (specifically 2pn21h45pa.ucarecd.net).</p>
<p><strong>Note:</strong> Uploadcare often uses ucarecd.net for <strong>free&#x2F;demo accounts</strong> or specific CDN regions, whereas the plugin assumes the production <strong>ucarecdn.com</strong> domain.</p>
<p>The Conflict: The plugin attempts to fetch <a target="_blank" rel="noopener" href="https://ucarecdn.com/">https://ucarecdn.com/</a><UUID>&#x2F;, but the file actually resides at <a target="_blank" rel="noopener" href="https://2pn21h45pa.ucarecd.net/">https://2pn21h45pa.ucarecd.net/</a><UUID>&#x2F;. This domain mismatch causes the server to return a 404 Not Found error during the sink operation.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://ucarecdn.com/&lt;UUID&gt;/</span><br></pre></td></tr></table></figure>

<p>However, my file actually exists at:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://2pn21h45pa.ucarecd.net/&lt;UUID&gt;/</span><br></pre></td></tr></table></figure>

<p>Because the file does not exist on the <strong>.com domain</strong>, the server returns a <strong>404 Not Found</strong>, and the sink (file save) operation fails.</p>
<p><strong>The Solution</strong><br><strong>Environment Limitation Bypass:</strong> To reproduce this vulnerability in a local lab environment without a <strong>paid Uploadcare subscription</strong>, I performed a <strong>white-box modification</strong>. I <strong>patched the code</strong> to accept a <strong>custom URL</strong> via the originalUrl parameter, overriding the <strong>hardcoded ucarecdn.com</strong> domain.</p>
<p><img src="https://hackmd.io/_uploads/SkViN5kDWl.png" alt="image"></p>
<p><strong>Note:</strong> This modification is <strong>only required for testing</strong> with <strong>free accounts</strong>. In a <strong>real-world scenario</strong>, an attacker could utilize a compatible Uploadcare account or endpoint to bypass this restriction without modifying the plugin code</p>
<p><img src="https://hackmd.io/_uploads/S1eDSckPWg.png" alt="image"></p>
<p><strong>Payload Creation:</strong> Created a simple PHP shell named pwn.txt containing : </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>Uploaded the file</strong> to Uploadcare via cURL and retrieved the <strong>UUID</strong></p>
<p><img src="https://hackmd.io/_uploads/SyWkI9JD-x.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/Skux8q1wZx.png" alt="image"></p>
<p>The url to the file was .net because the account issue but the code will handle it.</p>
<p><img src="https://hackmd.io/_uploads/HyPO8cyv-e.png" alt="image"></p>
<p>Sent a <strong>POST</strong> request to the <strong>WordPress endpoint</strong>. Due to the <strong>white-box patch</strong>, the plugin <strong>accepted</strong> the <strong>.net domain</strong> from my originalUrl parameter, downloaded the <strong>pwn.txt</strong> content, and saved it locally as <strong>shell.php</strong></p>
<p><img src="https://hackmd.io/_uploads/rJy7vqywZl.png" alt="image"></p>
<p>Finally, I navigated to the <strong>upload directory</strong>. Accessing <strong>UUID.php</strong> executed the PHP code successfully, confirming <strong>Remote Code Execution</strong> (RCE). This concludes the <strong>Proof of Concept</strong>.</p>
<h2 id="Mitigation"><a href="#Mitigation" class="headerlink" title="Mitigation"></a>Mitigation</h2><p>To fix this vulnerability and prevent similar attacks, the following steps should be taken:</p>
<p><strong>Strict File Type Validation (Allowlist):</strong></p>
<ul>
<li><p>Do not rely on client-side checks or user-provided filenames.</p>
</li>
<li><p>Implement server-side validation using wp_check_filetype() to ensure only specific extensions (e.g., .jpg, .png, .gif) are allowed.</p>
</li>
<li><p><strong>Action:</strong> If a file extension is not in the allowlist, terminate the upload immediately.</p>
</li>
</ul>
<p><strong>Implement Authorization &amp; Nonce Checks:</strong></p>
<ul>
<li><p>The API endpoint must verify user permissions. Add a permission_callback to ensure only authorized users (e.g., admins or shop managers) can access the route.</p>
</li>
<li><p>Include Nonce verification to protect against CSRF and unauthorized direct API access.</p>
</li>
</ul>
<p><strong>Secure Filename Generation:</strong></p>
<ul>
<li><p>Never trust the fileName parameter from the request.</p>
</li>
<li><p>Generate a new, random filename on the server (e.g., using MD5&#x2F;SHA256 of the UUID) and append the safe extension derived from the validation step.</p>
</li>
</ul>
<p><strong>Server Hardening (Defense-in-Depth):</strong></p>
<ul>
<li>Configure the web server (Apache&#x2F;Nginx) to disable PHP execution in the wp-content&#x2F;uploads directory. This prevents uploaded webshells from running even if they bypass the application logic.</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2026/02/03/2026-02-03-CVE-2025-13329/">https://pzhat.github.io/2026/02/03/2026-02-03-CVE-2025-13329/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/WordPress/">WordPress</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</div></div><div class="info-2"><div class="info-item-1">CVE-2025-68519 WordPress Brands for WooCommerce Plugin &lt;&#x3D; 3.8.6.3 is vulnerable to SQL Injection WordPress Brands for WooCommerce PluginOverview Published: 2025-12-24 CVE ID: CVE-2025-68519 Affected Plugin: WordPress Brands for WooCommerce Affected Versions: &lt;&#x3D; 3.8.6.3  Vulnerability Type: SQL Injection vulnerability  DescriptionImproper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’) vulnerability in BeRocket Brands for WooCommerce brands-for-wooco...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-27</div><div class="info-item-2">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</div></div><div class="info-2"><div class="info-item-1"> WordPress Shipping Rate By Cities PluginOverview CVE ID: CVE-2025-14770 Affected Plugin: Shipping Rate By Cities Affected Versions: ≤ 2.0.0 Vulnerability Type: Unauthenticated SQL Injection Attack Vector: Network Authentication Required: No  DescriptionThe Shipping Rate By Cities WordPress plugin contains an unauthenticated SQL Injection vulnerability in versions up to 2.0.0.The issue originates from unsafe handling of the city parameter, which is concatenated directly into an SQL query with...</div></div></div></a><a class="pagination-related" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-01</div><div class="info-item-2">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</div></div><div class="info-2"><div class="info-item-1">CVE-2025-68519 WordPress Brands for WooCommerce Plugin &lt;&#x3D; 3.8.6.3 is vulnerable to SQL Injection WordPress Brands for WooCommerce PluginOverview Published: 2025-12-24 CVE ID: CVE-2025-68519 Affected Plugin: WordPress Brands for WooCommerce Affected Versions: &lt;&#x3D; 3.8.6.3  Vulnerability Type: SQL Injection vulnerability  DescriptionImproper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’) vulnerability in BeRocket Brands for WooCommerce brands-for-wooco...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Cookie-Arena-Cmdi/" title="Cookie Arena Challenges WU (@Phatmh)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Cookie Arena Challenges WU (@Phatmh)</div></div><div class="info-2"><div class="info-item-1">Cookie Arena Web Challenges WriteUp by (@Phatmh)NSLookup (Level 1)Đây là một Website có chức năng là nslookup sử dụng hàm shell_exec của php để thực thi. Ta tiến hành truy cập để xem giao diện của web app.Ở đây ta thấy nó khá là basic khi chỉ có duy nhất một nơi có chức năng nslookup và bên cạnh là source code cho sẵn của chall, ta sẽ tiến hành phân tích source code được cấp sẵn. Ở ngay đầu tiên ta gặp khởi tạo và include file design và tạo object ($design) có tên là NSLookup Tool. Đến với nh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Cmdi/" title="Java Servlet Command Injection Vulnerability Challenges"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Command Injection Vulnerability Challenges</div></div><div class="info-2"><div class="info-item-1">Java Servlet Command Injection Vulnerability ChallengesCấu trúc Project Cấu trúc Project   1234567891011121314151617181920212223242526272829303132333435+---.idea+---.mvnª   +---wrapper+---srcª   +---mainª   ª   +---javaª   ª   ª   +---ciª   ª   ª       +---controllerª   ª   ª       +---serviceª   ª   ª       +---utilª   ª   +---resourcesª   ª   ª   +---META-INFª   ª   +---webappª   ª       +---WEB-INFª   +---testª       +---javaª       +---resources+---target    +---classes    ª   +---ci    ª...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-FileUpload-Servlet/" title="Java Servlet FileUpload Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet FileUpload Vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet FileUpload Vulnerability by @PhatmhLỗ hổng File UploadBản chất của File Upload: File Upload đối với tôi nó đơn giản chỉ là lợidụng Unsafe Method để truyền một Untrusted Data vào nhằm thay đổi hànhvi của hệ thống trong trường hợp này là Web App, với FileUpload những gìUser Upload lên sẽ chính là Untrusted Data và với Feature Upload Filenhư này sẽ thế nào nếu nó không được Validate một cách cẩn thận ta sẽđến với DEMO bằng Java Servlet. Web App OverviewĐây là một Web App được dựng v...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CVE-2025-13329-File-Uploader-for-WooCommerce"><span class="toc-number">1.</span> <span class="toc-text">CVE-2025-13329 File Uploader for WooCommerce &lt;&#x3D; 1.0.3 - Unauthenticated Arbitrary File Upload via add-image-data</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#File-Uploader-for-WooCommerce-Plugin"><span class="toc-number">2.</span> <span class="toc-text">File Uploader for WooCommerce Plugin</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Overview"><span class="toc-number">2.1.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Description"><span class="toc-number">2.2.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Patch-Commit-Analysis"><span class="toc-number">2.3.</span> <span class="toc-text">Patch &amp; Commit Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root-Cause-Analysis"><span class="toc-number">2.4.</span> <span class="toc-text">Root Cause Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proof-Of-Concept"><span class="toc-number">2.5.</span> <span class="toc-text">Proof Of Concept</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mitigation"><span class="toc-number">2.6.</span> <span class="toc-text">Mitigation</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/03/2026-02-03-CVE-2025-13329/" title="CVE-2025-13329 File Uploader for WooCommerce">CVE-2025-13329 File Uploader for WooCommerce</a><time datetime="2026-02-03T15:56:51.995Z" title="Created 2026-02-03 22:56:51">2026-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</a><time datetime="2026-01-31T17:12:36.483Z" title="Created 2026-02-01 00:12:36">2026-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)">Ysoserial Common Collections 3 Analyst (CC3)</a><time datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge">Velocity Server Side Template Injection Challenge</a><time datetime="2025-12-31T04:43:06.549Z" title="Created 2025-12-31 11:43:06">2025-12-31</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>