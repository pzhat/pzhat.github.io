<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Ysoserial Common Collections 3 Analyst (CC3) | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Ysoserial Common Collections 3 Analyst (CC3)Tổng quanCC3 (CommonsCollections3) trong ysoserial là một gadget chain dựa trên thư viện Apache Commons Collections để kích hoạt hành vi nguy hiểm thông qua">
<meta property="og:type" content="article">
<meta property="og:title" content="Ysoserial Common Collections 3 Analyst (CC3)">
<meta property="og:url" content="https://pzhat.github.io/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="Ysoserial Common Collections 3 Analyst (CC3)Tổng quanCC3 (CommonsCollections3) trong ysoserial là một gadget chain dựa trên thư viện Apache Commons Collections để kích hoạt hành vi nguy hiểm thông qua">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2026-01-21T05:35:18.206Z">
<meta property="article:modified_time" content="2026-01-21T05:40:45.576Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="ysoserial">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Ysoserial Common Collections 3 Analyst (CC3)",
  "url": "https://pzhat.github.io/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2026-01-21T05:35:18.206Z",
  "dateModified": "2026-01-21T05:40:45.576Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Ysoserial Common Collections 3 Analyst (CC3)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Ysoserial Common Collections 3 Analyst (CC3)</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Ysoserial Common Collections 3 Analyst (CC3)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-01-21T05:40:45.576Z" title="Updated 2026-01-21 12:40:45">2026-01-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/ysoserial/">ysoserial</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Ysoserial-Common-Collections-3-Analyst-CC3"><a href="#Ysoserial-Common-Collections-3-Analyst-CC3" class="headerlink" title="Ysoserial Common Collections 3 Analyst (CC3)"></a>Ysoserial Common Collections 3 Analyst (CC3)</h1><h3 id="Tong-quan"><a href="#Tong-quan" class="headerlink" title="Tổng quan"></a>Tổng quan</h3><p><code>CC3 (CommonsCollections3)</code> trong ysoserial là một <code>gadget chain</code> dựa trên thư viện <code>Apache Commons Collections</code> để kích hoạt hành vi nguy hiểm thông qua <code>Java deserialization</code>. Nó dựa vào cách một số lớp trong thư viện có thể được “xâu chuỗi” (chain) để thực thi <code>logic</code> ngoài ý muốn khi một đối tượng được <code>deserialization</code>.</p>
<h3 id="SetUp-Debug-trong-IntelliJ"><a href="#SetUp-Debug-trong-IntelliJ" class="headerlink" title="SetUp Debug trong IntelliJ"></a>SetUp Debug trong IntelliJ</h3><p><img src="https://hackmd.io/_uploads/By9T0v3rWx.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/BJtJ1O2B-l.png" alt="image"></p>
<p>Lúc tiến hành setup để có thể debug, phải chú ý rằng CC1 và CC3 đã không còn chạy được sau Java version 8u71, vì sau phiên bản java đó <code>sun.reflect.annotation.AnnotationInvocationHandler</code> đã thay đổi và không còn khả dụng. Vì vậy setup đẹp nhất là sử tải <code>JDK 1.7</code> kèm theo đó là sử dụng <code>Ysoserial Commons Collections version 3.1</code>.</p>
<h3 id="Cac-ham-can-co"><a href="#Cac-ham-can-co" class="headerlink" title="Các hàm cần có"></a>Các hàm cần có</h3><h4 id="InstantiateTransformer"><a href="#InstantiateTransformer" class="headerlink" title="InstantiateTransformer"></a>InstantiateTransformer</h4><h5 id="Constructor"><a href="#Constructor" class="headerlink" title="Constructor"></a>Constructor</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="title function_">InstantiateTransformer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        iParamTypes = <span class="literal">null</span>;</span><br><span class="line">        iArgs = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">InstantiateTransformer</span><span class="params">(Class[] paramTypes, Object[] args)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        iParamTypes = paramTypes;</span><br><span class="line">        iArgs = args;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="Cac-ham-Transform"><a href="#Cac-ham-Transform" class="headerlink" title="Các hàm Transform"></a>Các hàm Transform</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object input)</span> &#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">if</span> (input <span class="keyword">instanceof</span> Class == <span class="literal">false</span>) &#123;</span><br><span class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(</span><br><span class="line">                   <span class="string">&quot;InstantiateTransformer: Input object was not an instanceof Class, it was a &quot;</span></span><br><span class="line">                       + (input == <span class="literal">null</span> ? <span class="string">&quot;null object&quot;</span> : input.getClass().getName()));</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="type">Constructor</span> <span class="variable">con</span> <span class="operator">=</span> ((Class) input).getConstructor(iParamTypes);</span><br><span class="line">           <span class="keyword">return</span> con.newInstance(iArgs);</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (NoSuchMethodException ex) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(<span class="string">&quot;InstantiateTransformer: The constructor must exist and be public &quot;</span>);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (InstantiationException ex) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(<span class="string">&quot;InstantiateTransformer: InstantiationException&quot;</span>, ex);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (IllegalAccessException ex) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(<span class="string">&quot;InstantiateTransformer: Constructor must be public&quot;</span>, ex);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (InvocationTargetException ex) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FunctorException</span>(<span class="string">&quot;InstantiateTransformer: Constructor threw an exception&quot;</span>, ex);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>Tại hàm này, tiến hành khởi tạo một đối tượng thông qua Java Reflection.</p>
<h4 id="TrAXFilter"><a href="#TrAXFilter" class="headerlink" title="TrAXFilter"></a>TrAXFilter</h4><h5 id="Constructor-1"><a href="#Constructor-1" class="headerlink" title="Constructor"></a>Constructor</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">TrAXFilter</span><span class="params">(Templates templates)</span>  <span class="keyword">throws</span> </span><br><span class="line">    TransformerConfigurationException</span><br><span class="line">&#123;</span><br><span class="line">    _templates = templates;</span><br><span class="line">    _transformer = (TransformerImpl) templates.newTransformer();</span><br><span class="line">    _transformerHandler = <span class="keyword">new</span> <span class="title class_">TransformerHandlerImpl</span>(_transformer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Ở đoạn code này ta có đoạn : </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_transformer = (TransformerImpl) templates.newTransformer();</span><br><span class="line">_transformerHandler = <span class="keyword">new</span> <span class="title class_">TransformerHandlerImpl</span>(_transformer);</span><br></pre></td></tr></table></figure>

<p>Ở đoạn code đó, nó tiến hành gọi hàm <code>newTransformer()</code> đây chính là nơi trigger lên payload. Khi TrAXFilter gọi templates.newTransformer(), luồng xử lý sẽ đi vào bên trong <code>TemplatesImpl</code> như sau:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> Transformer <span class="title function_">newTransformer</span><span class="params">()</span></span><br><span class="line">   <span class="keyword">throws</span> TransformerConfigurationException </span><br><span class="line">   &#123;</span><br><span class="line">   TransformerImpl transformer;</span><br><span class="line"></span><br><span class="line">   transformer = <span class="keyword">new</span> <span class="title class_">TransformerImpl</span>(getTransletInstance(), _outputProperties,</span><br><span class="line">       _indentNumber, _tfactory);</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (_uriResolver != <span class="literal">null</span>) &#123;</span><br><span class="line">       transformer.setURIResolver(_uriResolver);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span> (_tfactory.getFeature(XMLConstants.FEATURE_SECURE_PROCESSING)) &#123;</span><br><span class="line">       transformer.setSecureProcessing(<span class="literal">true</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> transformer;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>Hàm này không có xử lý hay làm cái gì nhiều, chỉ cần để ý rằng nó gọi đến hàm <code>getTransletInstance()</code> ta đi đến hàm đó : </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Translet <span class="title function_">getTransletInstance</span><span class="params">()</span></span><br><span class="line">    <span class="keyword">throws</span> TransformerConfigurationException &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (_name == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (_class == <span class="literal">null</span>) defineTransletClasses();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The translet needs to keep a reference to all its auxiliary </span></span><br><span class="line">        <span class="comment">// class to prevent the GC from collecting them</span></span><br><span class="line">        <span class="type">AbstractTranslet</span> <span class="variable">translet</span> <span class="operator">=</span> (AbstractTranslet) _class[_transletIndex].newInstance();</span><br><span class="line">            translet.postInitialization();</span><br><span class="line">        translet.setTemplates(<span class="built_in">this</span>);</span><br><span class="line">        <span class="keyword">if</span> (_auxClasses != <span class="literal">null</span>) &#123;</span><br><span class="line">            translet.setAuxiliaryClasses(_auxClasses);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> translet;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Đây là một hàm quan trọng, nhiệm vụ của nó là biến mảng <code>byte (_bytecodes)</code> thành một <code>Class</code> và khởi tạo nó. Sau đó là tới nhiệm vụ của hàm <code>defineTransletClasses()</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">defineTransletClasses</span><span class="params">()</span></span><br><span class="line">    <span class="keyword">throws</span> TransformerConfigurationException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_bytecodes == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">ErrorMsg</span> <span class="variable">err</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.NO_TRANSLET_CLASS_ERR);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">TransletClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> (TransletClassLoader)</span><br><span class="line">            AccessController.doPrivileged(<span class="keyword">new</span> <span class="title class_">PrivilegedAction</span>() &#123;</span><br><span class="line">                <span class="keyword">public</span> Object <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TransletClassLoader</span>(ObjectFactory.findClassLoader());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">classCount</span> <span class="operator">=</span> _bytecodes.length;</span><br><span class="line">        _class = <span class="keyword">new</span> <span class="title class_">Class</span>[classCount];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (classCount &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            _auxClasses = <span class="keyword">new</span> <span class="title class_">Hashtable</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; classCount; i++) &#123;</span><br><span class="line">        _class[i] = loader.defineClass(_bytecodes[i]);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Class</span> <span class="variable">superClass</span> <span class="operator">=</span> _class[i].getSuperclass();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check if this is the main class</span></span><br><span class="line">        <span class="keyword">if</span> (superClass.getName().equals(ABSTRACT_TRANSLET)) &#123;</span><br><span class="line">            _transletIndex = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            _auxClasses.put(_class[i].getName(), _class[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (_transletIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        ErrorMsg err= <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.NO_MAIN_TRANSLET_ERR, _name);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ClassFormatError e) &#123;</span><br><span class="line">        <span class="type">ErrorMsg</span> <span class="variable">err</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_CLASS_ERR, _name);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (LinkageError e) &#123;</span><br><span class="line">        <span class="type">ErrorMsg</span> <span class="variable">err</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_OBJECT_ERR, _name);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Hàm này có vai trò chịu trách nhiệm chuyển đổi mảng <code>byte[]</code> thành <code>Class&lt;?&gt;</code> trong JVM.</p>
<h3 id="Gadget-Chain-Trigger-Flow-Debug-based"><a href="#Gadget-Chain-Trigger-Flow-Debug-based" class="headerlink" title="Gadget Chain Trigger Flow (Debug-based)"></a>Gadget Chain Trigger Flow (Debug-based)</h3><p>Mặc dù <code>InstantiateTransformer</code> chứa logic khởi tạo <code>TrAXFilter</code>, nhưng bản thân nó không được gọi trực tiếp. Trong CC3, phương thức <code>transform()</code> được kích hoạt gián tiếp thông qua cơ chế <code>Map</code> khi đối tượng được <code>deserialization</code>.</p>
<p>Cấu trúc của Chain sẽ là như sau : </p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">readObject()</span><br><span class="line"> └─ AnnotationInvocationHandler</span><br><span class="line">     └─ invoke()</span><br><span class="line">         └─ LazyMap.get()</span><br><span class="line">             └─ ChainedTransformer.transform()</span><br><span class="line">                 ├─ ConstantTransformer → TrAXFilter.class</span><br><span class="line">                 └─ InstantiateTransformer → new TrAXFilter()</span><br><span class="line">                     └─ TemplatesImpl.newTransformer()</span><br><span class="line">                         └─ defineTransletClasses()</span><br><span class="line">                             └─ payload &lt;clinit&gt; → RCE</span><br></pre></td></tr></table></figure>

<p>Bây giờ mình sẽ tiến hành debug.</p>
<h4 id="BREAKPOINT-1-–-ENTRY-POINT-DESERIALIZATION"><a href="#BREAKPOINT-1-–-ENTRY-POINT-DESERIALIZATION" class="headerlink" title="BREAKPOINT 1 – ENTRY POINT DESERIALIZATION"></a>BREAKPOINT 1 – ENTRY POINT DESERIALIZATION</h4><p><img src="https://hackmd.io/_uploads/rJpgqTnHbg.png" alt="image"></p>
<p>Tiến hành đặt <code>breakpoint</code> tại đoạn <code>readObject(ObjectInputStream var1)</code> sau đó trigger payload.</p>
<p><img src="https://hackmd.io/_uploads/Bkroia2H-e.png" alt="image"></p>
<p>Sau khi chạy lên, biến <code>var(1)</code> được gán giá trị là <code>ObjectInputStream@923</code>, vẫn chưa có gì mới nhưng ta sẽ để ý vào giá trị <code>memberValues</code> sau đó tiếp tục chạy.</p>
<p><img src="https://hackmd.io/_uploads/HynKkA2HWe.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/SymbeR3rWl.png" alt="image"></p>
<p>Sau khi chạy tiếp bước nữa đến dòng thứ 2, sau khi thực hiện <code>readObject</code> và gán giá trị cho var 1 thì bây giờ biến <code>memberValues</code> đã gọi đến <code>LazyMap</code>, cùng với đó là tại biến <code>type</code> nó đã gọi đến <code>java.lang.Override</code> hay <code>Override.class</code>, 2 điều trên chứng mình rằng gadget đầu tiên đã tiến hành <code>deserialize</code> và gọi tới <code>LazyMap(payload)</code>, đây chính là nơi khởi đầu.</p>
<h4 id="BREAKPOINT-2-–-PROXY-TRIGGER"><a href="#BREAKPOINT-2-–-PROXY-TRIGGER" class="headerlink" title="BREAKPOINT 2 – PROXY TRIGGER"></a>BREAKPOINT 2 – PROXY TRIGGER</h4><p><img src="https://hackmd.io/_uploads/rypfkkpSWl.png" alt="image"></p>
<p>Tại breakpoint thứ 2, ta thấy quá trình <code>deserialization</code> đã kích hoạt lời gọi tới một đối tượng <code>Proxy</code>. Nguyên nhân là trong <code>readObject()</code> (breakpoint 1), phương thức <code>memberValues.entrySet()</code> được gọi. Tuy nhiên, <code>memberValues</code> không phải là một <code>Map</code> thông thường mà là một <code>LazyMap</code> được <code>wrap</code> bởi <code>java.lang.reflect.Proxy</code>. Do đó, khi một <code>method</code> của <code>Map</code> (ví dụ entrySet() hoặc các method liên quan) được gọi trên đối tượng này, <code>JVM</code> sẽ chuyển hướng lời gọi đó tới phương thức <code>invoke()</code> của <code>InvocationHandler</code>, cụ thể là <code>AnnotationInvocationHandler.invoke()</code>.</p>
<h4 id="BREAKPOINT-3-–-memberValues-get"><a href="#BREAKPOINT-3-–-memberValues-get" class="headerlink" title="BREAKPOINT 3 – memberValues.get()"></a>BREAKPOINT 3 – memberValues.get()</h4><p><img src="https://hackmd.io/_uploads/rk-2HkTSWe.png" alt="image"></p>
<p>Tại breakpoint thứ 3, giá trị <code>var4</code> được xác định là “annotationType” và được sử dụng làm <code>key</code> trong lời gọi <code>memberValues.get(var4)</code>. Tuy nhiên, <code>memberValues</code> không phải là một <code>Map</code> thông thường mà là một <code>LazyMap</code>. Do đó, khi phương thức <code>get()</code> được gọi với <code>key</code> chưa tồn tại, <code>LazyMap</code> sẽ kích hoạt <code>factory.transform(key)</code>. Trong <code>CC3</code>, <code>factory</code> chính là <code>InstantiateTransformer</code>, từ đó dẫn đến việc khởi tạo <code>TrAXFilter</code>. Quá trình này tiếp tục gọi <code>TemplatesImpl.newTransformer()</code>, nơi <code>bytecode</code> độc hại được <code>load</code> và thực thi, dẫn tới <code>Remote Code Execution</code>. <code>Proxy</code> trong <code>chain</code> chỉ đóng vai trò kích hoạt <code>InvocationHandler.invoke()</code>, còn RCE thực sự xảy ra tại thời điểm <code>LazyMap.get()</code> gọi <code>transform()</code>.</p>
<h4 id="BREAKPOINT-4-–-CHAINED-TRANSFORMER-EXECUTION"><a href="#BREAKPOINT-4-–-CHAINED-TRANSFORMER-EXECUTION" class="headerlink" title="BREAKPOINT 4 – CHAINED TRANSFORMER EXECUTION"></a>BREAKPOINT 4 – CHAINED TRANSFORMER EXECUTION</h4><p><img src="https://hackmd.io/_uploads/BJTY-6TSbg.png" alt="image"></p>
<p>Tại <code>breakpoint 4</code>, luồng thực thi đi vào <code>ChainedTransformer.transform()</code>.<br>Đây là điểm trung tâm của CC3, nơi các <code>transformer</code> được thực thi tuần tự.<br><code>ConstantTransformer</code> trả về <code>TrAXFilter.class</code>, sau đó <code>InstantiateTransformer</code> sử dụng <code>reflection</code> để khởi tạo đối tượng <code>TrAXFilter</code> với tham số <code>TemplatesImpl</code>.<br>Trong quá trình khởi tạo, <code>constructor</code> của <code>TrAXFilter</code> gọi <code>TemplatesImpl.newTransformer()</code>, dẫn đến việc load và thực thi bytecode độc hại, từ đó gây ra <code>Remote Code Execution</code>.</p>
<p>Từ đây, luồng xử lý không còn thuộc Commons-Collections nữa, mà chuyển sang:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TemplatesImpl.newTransformer()</span><br><span class="line"> └─ getTransletInstance()</span><br><span class="line">     └─ defineTransletClasses()</span><br><span class="line">         └─ defineClass(bytecode)</span><br><span class="line">             └─ &lt;clinit&gt; → Runtime.exec()</span><br></pre></td></tr></table></figure>

<h4 id="BREAKPOINT-5-–-Runtime-exec"><a href="#BREAKPOINT-5-–-Runtime-exec" class="headerlink" title="BREAKPOINT 5 – Runtime.exec()"></a>BREAKPOINT 5 – Runtime.exec()</h4><p><img src="https://hackmd.io/_uploads/ByvzFpTHZx.png" alt="image"></p>
<p>Sau khi TemplatesImpl load class độc hại thông qua <code>defineClass(byte[])</code>, JVM tự động thực thi <code>static initializer &lt;clinit&gt;</code> của <code>class</code> này. <code>Payload</code> của <code>ysoserial</code> được nhúng trong <code>&lt;clinit&gt;</code>, dẫn tới lời gọi <code>Runtime.getRuntime().exec()</code>. Tại thời điểm này, mã lệnh hệ điều hành <code>(calc.exe)</code> được thực thi, chứng minh <code>Remote Code Execution</code> thành công.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/">https://pzhat.github.io/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/ysoserial/">ysoserial</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</div></div><div class="info-2"><div class="info-item-1"> WordPress Shipping Rate By Cities PluginOverview CVE ID: CVE-2025-14770 Affected Plugin: Shipping Rate By Cities Affected Versions: ≤ 2.0.0 Vulnerability Type: Unauthenticated SQL Injection Attack Vector: Network Authentication Required: No  DescriptionThe Shipping Rate By Cities WordPress plugin contains an unauthenticated SQL Injection vulnerability in versions up to 2.0.0.The issue originates from unsafe handling of the city parameter, which is concatenated directly into an SQL query with...</div></div></div></a><a class="pagination-related" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Velocity Server Side Template Injection Challenge</div></div><div class="info-2"><div class="info-item-1">Velocity Server Side Template Injection ChallengeTổng quan về lab Velocity SSTIĐây là một lab mình thiết kế ra để demo và học về SSTI. Bên trong lab được chia ra làm 4 level với các lớp filter khác nhau. Nhiệm vụ của mình là bypass được các lớp bảo mật đó nhằm mục đích cuối cùng là RCE. Bây giờ mình sẽ đi vào phân tích chức năng của web app. Phân tích Web Application Đi vào đầu tiên là giao diện của web, vì là lab mô phỏng nên mình chỉ làm đơn giản. Nó bao gồm form để mình nhập tên vào và một...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-10-28-Ysoserial-URLDNS/" title="Java Deserialze - URLDNS Chain analysis (ysoserial)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Deserialze - URLDNS Chain analysis (ysoserial)</div></div><div class="info-2"><div class="info-item-1">Java Deserialze - URLDNS Chain analysis (ysoserial) Java Deserialize là gì? Java cung cấp cho người dùng hàm writeObject() để tiến hành quá trình serialize các object ở đây quá trình serialize sinh ra để chuyển một đối tượng Java thành chuỗi byte để lưu trữ (file, DB) hoặc truyền qua mạng (socket, RMI, JMS). Và để có thể đọc được dữ liệu được serialize từ ObjectInputStream ta có quá trình deserialize ở java sử dụng hàm readObject() cho quá trình đó.  Khai thác Java Object Injection Rủi ro sẽ ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-07-Ysoserial-CC5/" title="Ysoserial Commons Collections 5 Analyst"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ysoserial Commons Collections 5 Analyst</div></div><div class="info-2"><div class="info-item-1">Ysoserial Commons Collections 5 AnalystTổng quan CommonsCollections 5 trong YsoserialCommonsCollections là một trong những gadget chain nổi tiếng nhất trong các cuộc tấn công khai thác Java deserialization không an toàn, đặc biệt khi ứng dụng sử dụng thư viện Apache Commons Collections. Trong bài viết này, chúng ta sẽ tập trung vào CommonsCollections5 (CC5) — một trong các chain được tích hợp sẵn trong công cụ ysoserial . Mình chọn phân tích CC5 vì đây là chain được nhiều người đề xuất để học...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Cmdi/" title="Java Servlet Command Injection Vulnerability Challenges"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Command Injection Vulnerability Challenges</div></div><div class="info-2"><div class="info-item-1">Java Servlet Command Injection Vulnerability ChallengesCấu trúc Project Cấu trúc Project   1234567891011121314151617181920212223242526272829303132333435+---.idea+---.mvnª   +---wrapper+---srcª   +---mainª   ª   +---javaª   ª   ª   +---ciª   ª   ª       +---controllerª   ª   ª       +---serviceª   ª   ª       +---utilª   ª   +---resourcesª   ª   ª   +---META-INFª   ª   +---webappª   ª       +---WEB-INFª   +---testª       +---javaª       +---resources+---target    +---classes    ª   +---ci    ª...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-16-WebSec.fr-level28/" title="WebSec.fr Level 28 CTF challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">WebSec.fr Level 28 CTF challenge</div></div><div class="info-2"><div class="info-item-1">WebSec.fr Level 28 CTF challengeTổng quan: 1234567891011121314151617181920212223&lt;?phpif(isset($_POST[&#x27;submit&#x27;])) &#123;  if ($_FILES[&#x27;flag_file&#x27;][&#x27;size&#x27;] &gt; 4096) &#123;    die(&#x27;Your file is too heavy.&#x27;);  &#125;  $filename = &#x27;./tmp/&#x27; . md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) . &#x27;.php&#x27;;  $fp = fopen($_FILES[&#x27;flag_file&#x27;][&#x27;tmp_name&#x27;], &#x27;r&#x27;);  $flagfilecontent = fread($fp, filesize($_FILES[&#x27;flag_file...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Sql-Injection/" title="Java Servlet Sql Injection Vulnerability by @Phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Sql Injection Vulnerability by @Phatmh</div></div><div class="info-2"><div class="info-item-1">Java Servlet Sql Injection Vulnerability by @PhatmhTổng quan cấu trúc file java123456789101112131415161718192021222324252627282930313233343536373839+---.idea   +---dataSources+---.mvn   +---wrapper+---src   +---main      +---java         +---sql_injection             +---controller             +---dao             +---model             +---util      +---resources         +---META-INF      +---webapp          +---WEB-INF   +---test       +---java       +---resources+---target    +---classes    ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Ysoserial-Common-Collections-3-Analyst-CC3"><span class="toc-number">1.</span> <span class="toc-text">Ysoserial Common Collections 3 Analyst (CC3)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tong-quan"><span class="toc-number">1.1.</span> <span class="toc-text">Tổng quan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SetUp-Debug-trong-IntelliJ"><span class="toc-number">1.2.</span> <span class="toc-text">SetUp Debug trong IntelliJ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cac-ham-can-co"><span class="toc-number">1.3.</span> <span class="toc-text">Các hàm cần có</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#InstantiateTransformer"><span class="toc-number">1.3.1.</span> <span class="toc-text">InstantiateTransformer</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Constructor"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">Constructor</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cac-ham-Transform"><span class="toc-number">1.3.2.</span> <span class="toc-text">Các hàm Transform</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TrAXFilter"><span class="toc-number">1.3.3.</span> <span class="toc-text">TrAXFilter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Constructor-1"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">Constructor</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gadget-Chain-Trigger-Flow-Debug-based"><span class="toc-number">1.4.</span> <span class="toc-text">Gadget Chain Trigger Flow (Debug-based)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BREAKPOINT-1-%E2%80%93-ENTRY-POINT-DESERIALIZATION"><span class="toc-number">1.4.1.</span> <span class="toc-text">BREAKPOINT 1 – ENTRY POINT DESERIALIZATION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BREAKPOINT-2-%E2%80%93-PROXY-TRIGGER"><span class="toc-number">1.4.2.</span> <span class="toc-text">BREAKPOINT 2 – PROXY TRIGGER</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BREAKPOINT-3-%E2%80%93-memberValues-get"><span class="toc-number">1.4.3.</span> <span class="toc-text">BREAKPOINT 3 – memberValues.get()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BREAKPOINT-4-%E2%80%93-CHAINED-TRANSFORMER-EXECUTION"><span class="toc-number">1.4.4.</span> <span class="toc-text">BREAKPOINT 4 – CHAINED TRANSFORMER EXECUTION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BREAKPOINT-5-%E2%80%93-Runtime-exec"><span class="toc-number">1.4.5.</span> <span class="toc-text">BREAKPOINT 5 – Runtime.exec()</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/11/2026-11-02-CVE-2026-23550/" title="CVE-2026-23550 WordPress Modular DS Plugin &lt;= 2.5.1 is vulnerable to a high priority Privilege Escalation">CVE-2026-23550 WordPress Modular DS Plugin &lt;= 2.5.1 is vulnerable to a high priority Privilege Escalation</a><time datetime="2026-02-11T02:25:47.507Z" title="Created 2026-02-11 09:25:47">2026-02-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/03/2026-02-03-CVE-2025-13329/" title="CVE-2025-13329 File Uploader for WooCommerce">CVE-2025-13329 File Uploader for WooCommerce</a><time datetime="2026-02-03T15:56:51.995Z" title="Created 2026-02-03 22:56:51">2026-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</a><time datetime="2026-01-31T17:12:36.483Z" title="Created 2026-02-01 00:12:36">2026-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)">Ysoserial Common Collections 3 Analyst (CC3)</a><time datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>