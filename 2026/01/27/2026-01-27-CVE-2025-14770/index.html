<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="WordPress Shipping Rate By Cities PluginCVE-2025-14770 – Unauthenticated SQL Injection via “city” ParameterOverview CVE ID: CVE-2025-14770 Affected Plugin: Shipping Rate By Cities Affected Versions:">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">
<meta property="og:url" content="https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="WordPress Shipping Rate By Cities PluginCVE-2025-14770 – Unauthenticated SQL Injection via “city” ParameterOverview CVE ID: CVE-2025-14770 Affected Plugin: Shipping Rate By Cities Affected Versions:">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2026-01-27T14:19:14.489Z">
<meta property="article:modified_time" content="2026-01-27T14:25:23.655Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="WordPress">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter",
  "url": "https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2026-01-27T14:19:14.489Z",
  "dateModified": "2026-01-27T14:25:23.655Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-01-27T14:25:23.655Z" title="Updated 2026-01-27 21:25:23">2026-01-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/CVE/">CVE</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="https://hackmd.io/_uploads/r1isJ3HLZl.png" alt="image"></p>
<h1 id="WordPress-Shipping-Rate-By-Cities-Plugin"><a href="#WordPress-Shipping-Rate-By-Cities-Plugin" class="headerlink" title="WordPress Shipping Rate By Cities Plugin"></a>WordPress Shipping Rate By Cities Plugin</h1><h2 id="CVE-2025-14770-–-Unauthenticated-SQL-Injection-via-“city”-Parameter"><a href="#CVE-2025-14770-–-Unauthenticated-SQL-Injection-via-“city”-Parameter" class="headerlink" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter"></a>CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</h2><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul>
<li><strong>CVE ID:</strong> CVE-2025-14770</li>
<li><strong>Affected Plugin:</strong> Shipping Rate By Cities</li>
<li><strong>Affected Versions:</strong> ≤ 2.0.0</li>
<li><strong>Vulnerability Type:</strong> Unauthenticated SQL Injection</li>
<li><strong>Attack Vector:</strong> Network</li>
<li><strong>Authentication Required:</strong> No</li>
</ul>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>The <strong>Shipping Rate By Cities</strong> WordPress plugin contains an <strong>unauthenticated SQL Injection</strong> vulnerability in versions up to <strong>2.0.0</strong>.<br>The issue originates from unsafe handling of the <code>city</code> parameter, which is concatenated directly into an SQL query without proper preparation.</p>
<p>Because the vulnerable code is reachable during the <strong>WooCommerce checkout flow</strong>, an attacker does <strong>not need authentication</strong> to exploit it.</p>
<p>Successful exploitation allows an attacker to manipulate SQL queries, potentially leading to:</p>
<ul>
<li>Sensitive data disclosure</li>
<li>Database enumeration</li>
<li>Service degradation via time-based payloads</li>
</ul>
<h3 id="Patch-Commit-Analysis"><a href="#Patch-Commit-Analysis" class="headerlink" title="Patch &amp; Commit Analysis"></a>Patch &amp; Commit Analysis</h3><p><img src="https://hackmd.io/_uploads/SyZ78G8LWg.png" alt="image"></p>
<p>Based on the image provided, here is the technical analysis of the patch for <strong>CVE-2025-14770</strong> in the “Shipping Rate by Cities” WordPress plugin.</p>
<p><strong>The Vulnerability: SQL Injection (SQLi)</strong></p>
<p>Looking at the right side (the old version), the code for the getCityFee function was:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCityFee</span>(<span class="params"><span class="variable">$city_name</span></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">global</span> <span class="variable">$wpdb</span>;</span><br><span class="line">       <span class="variable">$table</span> = <span class="variable">$wpdb</span>-&gt;prefix . <span class="string">&quot;shiprate_cities&quot;</span>;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable">$wpdb</span>-&gt;<span class="title function_ invoke__">get_row</span>(<span class="string">&quot;SELECT rate FROM <span class="subst">$table</span> where city_name = &#x27;<span class="subst">$city_name</span>&#x27;&quot;</span>, ARRAY_A);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>The Problem</strong>: The variable <strong>$city_name</strong> was directly concatenated into the SQL query string.</li>
<li><strong>The Risk</strong>: Since <strong>$city_name</strong> likely comes from a user-controlled source (like a checkout form), an attacker could input something like ‘ OR 1&#x3D;1 – to manipulate the query, bypass logic, or extract sensitive data from the database.</li>
</ul>
<p><strong>The Patch</strong>: Secure Coding Practices<br>The left side (the new version) introduces several layers of defense to mitigate this vulnerability</p>
<p><strong>Input Sanitization</strong><br>The patch adds:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$city_name</span> = <span class="title function_ invoke__">sanitize_text_field</span>(<span class="variable">$city_name</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>This is the first line of defense. It strips out HTML tags and characters that shouldn’t be in a simple text field, reducing the attack surface.</li>
</ul>
<p><strong>Prepared Statements (The Core Fix)</strong><br>The most critical change is the shift to the $wpdb-&gt;prepare() method:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="variable">$wpdb</span>-&gt;<span class="title function_ invoke__">get_row</span>(</span><br><span class="line">    <span class="variable">$wpdb</span>-&gt;<span class="title function_ invoke__">prepare</span>(</span><br><span class="line">        <span class="string">&quot;SELECT rate FROM <span class="subst">&#123;$wpdb-&gt;prefix&#125;</span>shiprate_cities WHERE city_name = %s&quot;</span>,</span><br><span class="line">        <span class="variable">$city_name</span></span><br><span class="line">    ),</span><br><span class="line">    ARRAY_A</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>How it works:</strong> Instead of building a string, it uses a placeholder (%s). WordPress then handles the data binding, ensuring that the value of $city_name is treated strictly as data, not as part of the SQL command. This effectively kills the SQL Injection vector.</li>
</ul>
<p><strong>Implementation of Object Caching</strong><br>The patch also introduces the WordPress Cache API:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cached</span> = <span class="title function_ invoke__">wp_cache_get</span>(<span class="variable">$cache_key</span>, <span class="variable">$cache_group</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">false</span> !== <span class="variable">$cached</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cached</span>;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="title function_ invoke__">wp_cache_set</span>(<span class="variable">$cache_key</span>, <span class="variable">$result</span>, <span class="variable">$cache_group</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>While primarily introduced for performance optimization, object caching may reduce repeated identical queries, but it should not be considered a security mitigation against SQL Injection or DoS attacks, as attackers can still bypass cache by varying input values.</li>
</ul>
<h3 id="Attack-Flow"><a href="#Attack-Flow" class="headerlink" title="Attack Flow"></a>Attack Flow</h3><p>I have categorized the data flow into two main processes:</p>
<ul>
<li>Admin Process: How data is stored in the database (Configuration).</li>
</ul>
<p><img src="https://hackmd.io/_uploads/rJHqDXUIWg.png" alt="image"></p>
<ul>
<li>User&#x2F;Checkout Process: How data is retrieved and used (The Vulnerable Path).</li>
</ul>
<p><img src="https://hackmd.io/_uploads/H19y_78UWg.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/BJMFOQ8U-x.png" alt="image"></p>
<h3 id="POC-And-Debug"><a href="#POC-And-Debug" class="headerlink" title="POC And Debug"></a>POC And Debug</h3><p>When a user updates their shipping information on a WooCommerce site, the browser sends a POST request to the Store API. The payload looks like this:</p>
<p><strong>Endpoint:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;billing_address&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hanoi&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;shipping_address&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hanoi&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/BJGN-QLIZx.png" alt="image"></p>
<p>Once the API receives this data, the following “domino effect” occurs inside WordPress:</p>
<ul>
<li><strong>Data Processing:</strong> WooCommerce receives the JSON and updates the session&#x2F;cart object with the new address.</li>
<li><strong>Shipping Recalculation:</strong> WooCommerce triggers a recalculation of shipping costs to reflect the new address. It looks for active shipping methods.</li>
<li><strong>The Hook:</strong> The “Shipping Rate by Cities” plugin is activated. It retrieves the city name from the cart to look up the specific rate in its database table.</li>
<li><strong>The Vulnerable Call:</strong> The plugin passes the raw, unsanitized string from the API directly into the function we saw in the diff:</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getCityFee</span>(<span class="variable">$city_name</span>);</span><br></pre></td></tr></table></figure>

<p>Using that logic vulnerable at city variable, now i can inject SQL query to trigger vulnerability.</p>
<p><img src="https://hackmd.io/_uploads/B13JXmI8Zl.png" alt="image"></p>
<p>The response time is roughly 4x the sleep value. This behavior is consistent with WooCommerce’s cart recalculation lifecycle, where shipping methods may be evaluated multiple times per request (e.g., for billing and shipping contexts), resulting in repeated execution of the vulnerable query.</p>
<p>To further validate this behavior, the sleep duration was modified to observe the corresponding change in response time.</p>
<p><img src="https://hackmd.io/_uploads/ByyeVXUIZx.png" alt="image"></p>
<p>After change payload’s sleep time to 5 and sent the request, look at the response show that the time response was decrease about half and it took just 21s. That prove that POC success.</p>
<h3 id="Remediation-Recommendations"><a href="#Remediation-Recommendations" class="headerlink" title="Remediation &amp; Recommendations"></a>Remediation &amp; Recommendations</h3><p><strong>For Site Administrators</strong></p>
<ul>
<li><strong>Immediate Update:</strong> If you are using the “Shipping Rate by Cities” plugin, ensure you have updated to version 2.0.1 or higher. This version includes the critical security patches analyzed in this report.</li>
<li><strong>Deploy a Web Application Firewall (WAF):</strong> Use a WAF (such as Cloudflare, Wordfence, or Sucuri) to detect and block common SQL injection patterns (e.g., SLEEP(), UNION SELECT), while acknowledging that WAFs should not be relied upon as the sole defense.</li>
<li><strong>Audit Database Permissions:</strong> Ensure the database user for WordPress has the least privilege necessary. This limits the potential damage if an SQL injection vulnerability is exploited.</li>
</ul>
<p><strong>For Developers</strong></p>
<ul>
<li><strong>Never Trust User Input:</strong> Always treat data coming from APIs or forms as untrusted. Use built-in WordPress sanitization functions like sanitize_text_field() or absint() as a first layer of defense.</li>
<li><strong>Mandatory use of $wpdb-&gt;prepare():</strong> Never concatenate variables directly into SQL queries. The $wpdb-&gt;prepare() method is the industry standard for preventing SQLi in WordPress by ensuring that data is safely escaped and handled as a literal value.</li>
<li><strong>Implement Rate Limiting:</strong> Since this vulnerability is unauthenticated, implement rate limiting on sensitive endpoints like &#x2F;wp-json&#x2F;wc&#x2F;store&#x2F;v1&#x2F;cart&#x2F;update-customer to prevent automated scanning and brute-forcing.</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/">https://pzhat.github.io/2026/01/27/2026-01-27-CVE-2025-14770/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/WordPress/">WordPress</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Ysoserial Common Collections 3 Analyst (CC3)</div></div><div class="info-2"><div class="info-item-1">Ysoserial Common Collections 3 Analyst (CC3)Tổng quanCC3 (CommonsCollections3) trong ysoserial là một gadget chain dựa trên thư viện Apache Commons Collections để kích hoạt hành vi nguy hiểm thông qua Java deserialization. Nó dựa vào cách một số lớp trong thư viện có thể được “xâu chuỗi” (chain) để thực thi logic ngoài ý muốn khi một đối tượng được deserialization. SetUp Debug trong IntelliJ  Lúc tiến hành setup để có thể debug, phải chú ý rằng CC1 và CC3 đã không còn chạy được sau Java versi...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-09-09-Cookie-Arena-Cmdi/" title="Cookie Arena Challenges WU (@Phatmh)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Cookie Arena Challenges WU (@Phatmh)</div></div><div class="info-2"><div class="info-item-1">Cookie Arena Web Challenges WriteUp by (@Phatmh)NSLookup (Level 1)Đây là một Website có chức năng là nslookup sử dụng hàm shell_exec của php để thực thi. Ta tiến hành truy cập để xem giao diện của web app.Ở đây ta thấy nó khá là basic khi chỉ có duy nhất một nơi có chức năng nslookup và bên cạnh là source code cho sẵn của chall, ta sẽ tiến hành phân tích source code được cấp sẵn. Ở ngay đầu tiên ta gặp khởi tạo và include file design và tạo object ($design) có tên là NSLookup Tool. Đến với nh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-FileUpload-Servlet/" title="Java Servlet FileUpload Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet FileUpload Vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet FileUpload Vulnerability by @PhatmhLỗ hổng File UploadBản chất của File Upload: File Upload đối với tôi nó đơn giản chỉ là lợidụng Unsafe Method để truyền một Untrusted Data vào nhằm thay đổi hànhvi của hệ thống trong trường hợp này là Web App, với FileUpload những gìUser Upload lên sẽ chính là Untrusted Data và với Feature Upload Filenhư này sẽ thế nào nếu nó không được Validate một cách cẩn thận ta sẽđến với DEMO bằng Java Servlet. Web App OverviewĐây là một Web App được dựng v...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Sql-Injection/" title="Java Servlet Sql Injection Vulnerability by @Phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Sql Injection Vulnerability by @Phatmh</div></div><div class="info-2"><div class="info-item-1">Java Servlet Sql Injection Vulnerability by @PhatmhTổng quan cấu trúc file java123456789101112131415161718192021222324252627282930313233343536373839+---.idea   +---dataSources+---.mvn   +---wrapper+---src   +---main      +---java         +---sql_injection             +---controller             +---dao             +---model             +---util      +---resources         +---META-INF      +---webapp          +---WEB-INF   +---test       +---java       +---resources+---target    +---classes    ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-19-Path-Traversal-Servlet/" title="Java Servlet Path Traversal vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Path Traversal vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet Path Traversal vulnerabilitySource Code:[Github Link] Overview Đây là chức năng hiển thị hình ảnh của các file đã nằm trong folder images.  Ở đây ta test file skibidi.jpg và request nó sẽ hiển thị lên cho ta.  Đây là nơi chứa các file có thể hiển thị. Vì là build trên môi trường windows localhost qua apache tôi sẽ tạo một thư mục /protected có chứa file bí mật.  Tiến hành khai thác và POCLevel 1:123456789101112131415161718192021private void handleLevel1(String fileName, HttpServl...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Cmdi/" title="Java Servlet Command Injection Vulnerability Challenges"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Command Injection Vulnerability Challenges</div></div><div class="info-2"><div class="info-item-1">Java Servlet Command Injection Vulnerability ChallengesCấu trúc Project Cấu trúc Project   1234567891011121314151617181920212223242526272829303132333435+---.idea+---.mvnª   +---wrapper+---srcª   +---mainª   ª   +---javaª   ª   ª   +---ciª   ª   ª       +---controllerª   ª   ª       +---serviceª   ª   ª       +---utilª   ª   +---resourcesª   ª   ª   +---META-INFª   ª   +---webappª   ª       +---WEB-INFª   +---testª       +---javaª       +---resources+---target    +---classes    ª   +---ci    ª...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WordPress-Shipping-Rate-By-Cities-Plugin"><span class="toc-number">1.</span> <span class="toc-text">WordPress Shipping Rate By Cities Plugin</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2025-14770-%E2%80%93-Unauthenticated-SQL-Injection-via-%E2%80%9Ccity%E2%80%9D-Parameter"><span class="toc-number">1.1.</span> <span class="toc-text">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Overview"><span class="toc-number">1.2.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Description"><span class="toc-number">1.3.</span> <span class="toc-text">Description</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Patch-Commit-Analysis"><span class="toc-number">1.3.1.</span> <span class="toc-text">Patch &amp; Commit Analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Attack-Flow"><span class="toc-number">1.3.2.</span> <span class="toc-text">Attack Flow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#POC-And-Debug"><span class="toc-number">1.3.3.</span> <span class="toc-text">POC And Debug</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Remediation-Recommendations"><span class="toc-number">1.3.4.</span> <span class="toc-text">Remediation &amp; Recommendations</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)">Ysoserial Common Collections 3 Analyst (CC3)</a><time datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge">Velocity Server Side Template Injection Challenge</a><time datetime="2025-12-31T04:43:06.549Z" title="Created 2025-12-31 11:43:06">2025-12-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/25/2025-12-25-CBJS-Misconfiguration/" title="CBJS Java Misconfiguration Challenge">CBJS Java Misconfiguration Challenge</a><time datetime="2025-12-25T13:30:27.815Z" title="Created 2025-12-25 20:30:27">2025-12-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/05/2025-12-05-TryHackMe-Hammer/" title="Tryhackme Hammer challenge WriteUp">Tryhackme Hammer challenge WriteUp</a><time datetime="2025-12-04T18:19:12.763Z" title="Created 2025-12-05 01:19:12">2025-12-05</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>