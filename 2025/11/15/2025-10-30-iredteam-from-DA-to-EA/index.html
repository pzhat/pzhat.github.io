<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Ired.Team From Domain Admin to Enterprise Admin | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Ired.Team From Domain Admin to Enterprise AdminOverviewỞ lab này ta sẽ lợi dụng mối quan hệ giữa Parent-Child domain từ đó lợi dụng mối quan hệ đó và gây nên leo thang đặc quyền. Build lab SetUp domai">
<meta property="og:type" content="article">
<meta property="og:title" content="Ired.Team From Domain Admin to Enterprise Admin">
<meta property="og:url" content="https://pzhat.github.io/2025/11/15/2025-10-30-iredteam-from-DA-to-EA/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="Ired.Team From Domain Admin to Enterprise AdminOverviewỞ lab này ta sẽ lợi dụng mối quan hệ giữa Parent-Child domain từ đó lợi dụng mối quan hệ đó và gây nên leo thang đặc quyền. Build lab SetUp domai">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-11-14T19:34:38.241Z">
<meta property="article:modified_time" content="2025-11-14T18:50:52.075Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Pentest">
<meta property="article:tag" content="RedTeam">
<meta property="article:tag" content="iredteam">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Ired.Team From Domain Admin to Enterprise Admin",
  "url": "https://pzhat.github.io/2025/11/15/2025-10-30-iredteam-from-DA-to-EA/",
  "image": "https://pzhat.github.io/img/butterfly-icon.png",
  "datePublished": "2025-11-14T19:34:38.241Z",
  "dateModified": "2025-11-14T18:50:52.075Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/11/15/2025-10-30-iredteam-from-DA-to-EA/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Ired.Team From Domain Admin to Enterprise Admin',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Ired.Team From Domain Admin to Enterprise Admin</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Ired.Team From Domain Admin to Enterprise Admin</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-14T19:34:38.241Z" title="Created 2025-11-15 02:34:38">2025-11-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-14T18:50:52.075Z" title="Updated 2025-11-15 01:50:52">2025-11-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/RedTeam/">RedTeam</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/RedTeam/pentesting/">pentesting</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Ired-Team-From-Domain-Admin-to-Enterprise-Admin"><a href="#Ired-Team-From-Domain-Admin-to-Enterprise-Admin" class="headerlink" title="Ired.Team From Domain Admin to Enterprise Admin"></a>Ired.Team From Domain Admin to Enterprise Admin</h1><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>Ở lab này ta sẽ lợi dụng mối quan hệ giữa <strong>Parent-Child</strong> domain từ đó lợi dụng mối quan hệ đó và gây nên leo thang đặc quyền.</p>
<h3 id="Build-lab"><a href="#Build-lab" class="headerlink" title="Build lab"></a>Build lab</h3><p><img src="https://hackmd.io/_uploads/BJhTNPJk-x.png" alt="image"></p>
<p>SetUp domain đặt tên là <code>offense.local</code> đây là domain cha với IP là <code>192.168.10.10/24</code> và <code>DNS: 127.0.0.1</code>.</p>
<p><img src="https://hackmd.io/_uploads/BkRX1OR0ge.png" alt="image"></p>
<ul>
<li><p>Đã cài xong <code>Active Directory Domain Services (AD DS).</code></p>
</li>
<li><p>Đã promote máy thành <code>Domain Controller</code> cho domain: <code>offense.local</code>.</p>
</li>
<li><p>Đã có <code>DNS Server</code> chạy trên DC.</p>
</li>
<li><p>Đang dùng <code>VMware host-only network.</code></p>
</li>
</ul>
<p>Sau đó setup máy <code>red.offense</code> đưa nó vào domain <code>offense.local</code>.</p>
<p><img src="https://hackmd.io/_uploads/SJ3Drv1kZx.png" alt="image"></p>
<p>Gán ip sau đó set DNS trỏ đến ip của máy <code>parent.local</code>.</p>
<ul>
<li><p>Network Adapter: <code>Host-only</code></p>
</li>
<li><p>IP: <code>192.688.10.20/24</code></p>
</li>
<li><p>DNS: <code>192.168.10.10 (MANTVYDAS DC - offense local).</code></p>
</li>
</ul>
<h3 id="Parent-child-domain"><a href="#Parent-child-domain" class="headerlink" title="Parent-child domain"></a>Parent-child domain</h3><p><img src="https://hackmd.io/_uploads/BkbC5by1-x.png" alt="image"></p>
<p>Ở đây cài đặt domain <code>red.offense</code> là con của <code>offense.local</code> ở đây khi mình truy cập vào <code>Active Directory Domains and Trusts</code> ở đây ta thấy nó cho ta thấy mối quan hệ giữa 2 domains và bên cạnh đó và <code>default trust</code> của 2 domains đó.</p>
<p><img src="https://hackmd.io/_uploads/HJlVIPJyWx.png" alt="image"></p>
<p>Ở đây ta sử dụng lệnh ở cả 2 domain để kiểm tra :</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ADTrust</span> <span class="literal">-Filter</span> *</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/H11-PDy1Wg.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/HkKmPP11Wl.png" alt="image"></p>
<ul>
<li>Console đầu tiên show cho ta thấy được mối quan hệ giữa 2 domain trust ở đây là console của <code>offense.local</code> nó cho ta thấy nó là <code>Name : red.offense.local</code>.</li>
<li>Console thứ 2 cũng thể hiện mối quan hệ tương tự giữa <code>2 domains</code>.</li>
<li>Ta để ý rằng cái Direction là <code>BiDirectional</code> điều đó có nghĩa là các thành viên có thể xác thực từ domain này sang domain khác khi họ muốn truy cập vào các resources được chia sẻ.</li>
</ul>
<p><img src="https://hackmd.io/_uploads/SkssDvy1bl.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/Byp2DvyyZl.png" alt="image"></p>
<p>Sử dụng lệnh <code>nltest /domain_trusts</code>.Thông tin tương tự nhưng rất đơn giản có thể được thu thập từ tệp nhị phân Windows.</p>
<p>Tương tự ta sử dụng lệnh dưới đây để lấy được thông tin tương tự như bên trên : </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">([<span class="type">System.DirectoryServices.ActiveDirectory.Domain</span>]::GetCurrentDomain()).GetAllTrustRelationships()</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/rkYzuvkkbx.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/rkDXODkJZx.png" alt="image"></p>
<p><code>SourceName</code> với <code>TargetName</code> đã thể hiện và TrustType là <code>ParentChild</code>.</p>
<p><img src="https://hackmd.io/_uploads/SJTmguyybx.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/HyLrlOJ1-x.png" alt="image"></p>
<h3 id="Forest-Trust"><a href="#Forest-Trust" class="headerlink" title="Forest Trust"></a>Forest Trust</h3><p><img src="https://hackmd.io/_uploads/HJ38edy1bl.png" alt="image"></p>
<p>Tạo một máy <code>DC-BLUE</code> có domain là <code>defense.local</code> sau đó đưa 2 cái DC là <code>MANTVYDAS</code> và <code>BLUE</code> vào cùng dải ip và cùng DNS Zone.</p>
<p><img src="https://hackmd.io/_uploads/Syk5b_ykWg.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/ByK9b_11We.png" alt="image"></p>
<p>SetUp DNS Forward ở cả 2 máy bây giờ 2 máy hoàn toàn có thể nslookup được cho nhau.</p>
<p><img src="https://hackmd.io/_uploads/SyQ4BdyJbx.png" alt="image"></p>
<p>Tiến hành config forest trust cho <code>defense.local</code> cho <code>offense.local</code>ở đây ta tạo incoming trust.</p>
<p><img src="https://hackmd.io/_uploads/SJR8L_JkZx.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/SysDI_Jy-l.png" alt="image"></p>
<p>Giờ ta hoàn toàn có thể truy cập dữ liệu của máy <code>defense.local</code> bằng máy <code>offense.local</code> nhưng máy <code>defense</code> sẽ không thể làm được điều ngược lại lí do là vì nó không được máy <code>offense</code> trust, user trên <code>dc-mantvydas.offense.local</code> không thể chia sẻ thư mục với <code>defense\administrator</code> &#x3D;&#x3D;(vì offensive.local không tin tưởng defense.local)&#x3D;&#x3D;.</p>
<h3 id="From-DA-to-EA"><a href="#From-DA-to-EA" class="headerlink" title="From DA to EA"></a>From DA to EA</h3><p>Bây giờ ta sẽ đi đến với kỹ thuật biến từ <code>Domain Admin</code> thành <code>Enterprise Admin</code> dựa theo kỹ thuật có sẵn.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Tạo user</span></span><br><span class="line"><span class="built_in">New-ADUser</span> <span class="literal">-Name</span> <span class="string">&quot;spotless&quot;</span> <span class="literal">-SamAccountName</span> <span class="string">&quot;spotless&quot;</span> <span class="literal">-Enabled</span> <span class="variable">$true</span> <span class="literal">-AccountPassword</span> (<span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;Password123!&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gán vào Domain Admins</span></span><br><span class="line"><span class="built_in">Add-ADGroupMember</span> <span class="literal">-Identity</span> <span class="string">&quot;Domain Admins&quot;</span> <span class="literal">-Members</span> <span class="string">&quot;spotless&quot;</span></span><br></pre></td></tr></table></figure>

<p>Ta sẽ tạo user ở <code>DC-RED</code> là user <code>spotless</code> và đưa user đó vào thành <code>Domain Admin</code>.</p>
<p>Bây giờ nó đã là <code>child admin</code> ở đây mình sẽ không dùng empire powershell mà demo tấn công theo cách khác ở đây ta bỏ qua bước AD recon với lateral movement vì empire bị lỗi ta sẽ vào thẳng shell của dc-red luôn.</p>
<h4 id="Buoc-1-Xac-nhan-trust-parent-child"><a href="#Buoc-1-Xac-nhan-trust-parent-child" class="headerlink" title="Bước 1: Xác nhận trust parent-child"></a>Bước 1: Xác nhận trust parent-child</h4><p><img src="https://hackmd.io/_uploads/SkO2GbWkWe.png" alt="image"></p>
<h4 id="Buoc-2-Xac-nhan-Domain-Admin"><a href="#Buoc-2-Xac-nhan-Domain-Admin" class="headerlink" title="Bước 2: Xác nhận Domain Admin"></a>Bước 2: Xác nhận Domain Admin</h4><p><img src="https://hackmd.io/_uploads/SyYJQ-bk-x.png" alt="image"></p>
<h4 id="Buoc-3-Lay-SID-cua-Enterprise-Admins-parent"><a href="#Buoc-3-Lay-SID-cua-Enterprise-Admins-parent" class="headerlink" title="Bước 3: Lấy SID của Enterprise Admins (parent)"></a>Bước 3: Lấy SID của Enterprise Admins (parent)</h4><p><img src="https://hackmd.io/_uploads/rJLc7-Z1bg.png" alt="image"></p>
<p>Ta có SID là <code>S-1-5-21-3710096372-560042618-2387674259-519</code>.</p>
<p><img src="https://hackmd.io/_uploads/rJNG8ZZJWx.png" alt="image"></p>
<p>Sau đó ta lấy SID của <code>krbtgt</code> là <code>S-1-5-21-1522518357-539094533-3136975768-502</code>.</p>
<h4 id="Buoc-4-Bat-dau-chay-psexec-exe-mo-CMD-moi-voi-quyen-SYSTEM"><a href="#Buoc-4-Bat-dau-chay-psexec-exe-mo-CMD-moi-voi-quyen-SYSTEM" class="headerlink" title="Bước 4: Bắt đầu chạy psexec.exe mở CMD mới với quyền SYSTEM"></a>Bước 4: Bắt đầu chạy <code>psexec.exe</code> mở CMD mới với quyền SYSTEM</h4><p><img src="https://hackmd.io/_uploads/ByChUZbyWg.png" alt="image"></p>
<h4 id="Buoc-5-Tao-golden-ticket-trong-mimikatz"><a href="#Buoc-5-Tao-golden-ticket-trong-mimikatz" class="headerlink" title="Bước 5: Tạo golden ticket trong mimikatz"></a>Bước 5: Tạo golden ticket trong mimikatz</h4><p><img src="https://hackmd.io/_uploads/ByyWDZby-l.png" alt="image"></p>
<h4 id="Buoc-6-Nap-ticket-va-kiem-tra"><a href="#Buoc-6-Nap-ticket-va-kiem-tra" class="headerlink" title="Bước 6: Nạp ticket và kiểm tra"></a>Bước 6: Nạp ticket và kiểm tra</h4><p><img src="https://hackmd.io/_uploads/S1o4PWWkWe.png" alt="image"></p>
<h4 id="Buoc-7"><a href="#Buoc-7" class="headerlink" title="Bước 7:"></a>Bước 7:</h4><p>Sau khi tạo ticket tôi spawn ra cmd mới và kiểm tra user.</p>
<p><img src="https://hackmd.io/_uploads/B1VCs-WJbe.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/SkeHlX-J-x.png" alt="image"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/11/15/2025-10-30-iredteam-from-DA-to-EA/">https://pzhat.github.io/2025/11/15/2025-10-30-iredteam-from-DA-to-EA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RedTeam/">RedTeam</a><a class="post-meta__tags" href="/tags/Pentest/">Pentest</a><a class="post-meta__tags" href="/tags/iredteam/">iredteam</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/15/2025-11-04-THM-Basic-Pentesting/" title="Tryhackme Basic Pentesting Challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Tryhackme Basic Pentesting Challenge</div></div><div class="info-2"><div class="info-item-1">Tryhackme Basic Pentesting Challenge Sử dụng nmap để scan các port đang mở của target ở đây tôi sử dụng lệnh nmap -sV -T4 &lt;ip&gt; để scan cho nhanh và ta nhận được kết quả là 4 port đang mở. Với câu hỏi đầu là What is the name of the hidden directory on the web server ta sẽ tiến hành scan directory bằng gobuster ở đâu mình dùng lệnh :  1gobuster dir -u http://10.10.237.96 -w /usr/share/wordlists/dirb/common.txt -t 20 -x php,html,txt   Ta tìm được directory hidden đó là /development và trả ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-10-28-Ysoserial-URLDNS/" title="Java Deserialze - URLDNS Chain analysis (ysoserial)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Java Deserialze - URLDNS Chain analysis (ysoserial)</div></div><div class="info-2"><div class="info-item-1">Java Deserialze - URLDNS Chain analysis (ysoserial) Java Deserialize là gì? Java cung cấp cho người dùng hàm writeObject() để tiến hành quá trình serialize các object ở đây quá trình serialize sinh ra để chuyển một đối tượng Java thành chuỗi byte để lưu trữ (file, DB) hoặc truyền qua mạng (socket, RMI, JMS). Và để có thể đọc được dữ liệu được serialize từ ObjectInputStream ta có quá trình deserialize ở java sử dụng hàm readObject() cho quá trình đó.  Khai thác Java Object Injection Rủi ro sẽ ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-11-03-I.redteam-Kerberoasting/" title="Ired.Team Kerberoasting (Credential Access)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team Kerberoasting (Credential Access)</div></div><div class="info-2"><div class="info-item-1">Ired.Team Kerberoasting (Credential Access)Giải thích về các khái niệmKerberos trong Active Directory Trong môi trường Windows Active Directory (AD), Kerberos là giao thức xác thực mặc định. Nó sử dụng các ticket để xác thực người dùng và dịch vụ mà không truyền mật khẩu qua mạng.  Các thành phần chính:  KDC (Key Distribution Center): Thường là Domain Controller (DC). TGT (Ticket Granting Ticket): Cấp cho user sau khi đăng nhập thành công → dùng để xin ticket cho dịch vụ. TGS (Ticket Granting...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-15-I.redteam-Kerberos-Silver-Ticket/" title="Ired.Team Kerberos Silver Ticket Execution"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team Kerberos Silver Ticket Execution</div></div><div class="info-2"><div class="info-item-1">Ired.Team Kerberos Silver TicketTiếp tục chuỗi series AD abuse thì tiếp theo ta tiến tới Kerberos Silver Ticket có nghĩa là ta sẽ hack quyền từ Kerberos nhưng không phải tạo golden ticket để truy cập mọi tài nguyên trong DC mà ở đây ta chỉ tạo Silver Ticket có quyền truy cập một số tài nguyên nhất định vì đôi khi ta cũng không cần phải full quyền để làm gì nhiều lúc sẽ dễ bị phát hiện nên ta chỉ cần lấy một vài tài nguyên, chính điều đó thì Silver Ticket ra đời. ExecutionBước 1: Chuẩn bị môi ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Pickle-Rick-THM/" title="TryHackme Pickle Rick Challenge WriteUp by Phatmh."><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">TryHackme Pickle Rick Challenge WriteUp by Phatmh.</div></div><div class="info-2"><div class="info-item-1">TryHackme Pickle Rick Challenge WriteUp by Phatmh.[link challenge]:https://tryhackme.com/room/picklerickTiến hành dùng Openvpn kết nối với Tryhackme.Tiến hành kiểm tra mình đã cùng mạng mới máy bên Tryhackme hay chưa.Câu hỏi và Ip của challenge nãy đã test và kết nối thành công. Bước 1: ReconSử dụng Nmap để tiến hành kiểm tra xem có port nào đang được mở ra, ở đây phát hiện ra được bên máy đang mở port 22&#x2F;tcp và port 88&#x2F;tcp ở đây tôi nghĩ là server nạn nhân đang chạy SSH và HTTP. Tư...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-THM-EvilGPT/" title="Tryhackme EvilGPT challenge WriteUp by @phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Tryhackme EvilGPT challenge WriteUp by @phatmh</div></div><div class="info-2"><div class="info-item-1">Tryhackme EvilGPT challenge WriteUp by @phatmhDùng netcat để tiến hành kết nối với chall và tiến hành LLM Inject để có thể moi được flag từ con AI.Sau khi test thử thì đây không phải con AI bình thường như tôi nghĩ mà nó là một con AI thực thi các câu lệnh OS vậy bây giờ tiến hành thử moi ra các thứ có trong server.Tiến hành đọc thử source code của con AI xem nó có những cái gì. Tóm tắt chức năngTập tin Python evilai.py là một server Telnet đơn giản. Khi người dùng kết nối, nó: Nhận yêu cầu t...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-10-10-PentesterLab-From-Sql-To-Shell/" title="Pentester Lab From Sql Injection to Shell"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Pentester Lab From Sql Injection to Shell</div></div><div class="info-2"><div class="info-item-1">Pentester Lab From Sql Injection to ShellFingerprinting Sử dụng nmap với cú pháp: 1sudo nmap -sV 192.168.179.132 -T4  Kết quả trả về cho thấy đang có 2 port đang được mở đó là port 22 và 80 như ta đã biết port 22 là SSH còn 80 là Apache httpd thì có nghĩa là nó đang host 1 cái web nào đó.  Tiến hành curl đến xem thử có tồn tại không và để lấy được source code của web được host ở đây nó đưa cho ta thông tin về server và web được code bằng PHP/5.3.3-7+squeeze14.  Truy cập GUI để cho dễ nhìn và ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-04-THM-Basic-Pentesting/" title="Tryhackme Basic Pentesting Challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Tryhackme Basic Pentesting Challenge</div></div><div class="info-2"><div class="info-item-1">Tryhackme Basic Pentesting Challenge Sử dụng nmap để scan các port đang mở của target ở đây tôi sử dụng lệnh nmap -sV -T4 &lt;ip&gt; để scan cho nhanh và ta nhận được kết quả là 4 port đang mở. Với câu hỏi đầu là What is the name of the hidden directory on the web server ta sẽ tiến hành scan directory bằng gobuster ở đâu mình dùng lệnh :  1gobuster dir -u http://10.10.237.96 -w /usr/share/wordlists/dirb/common.txt -t 20 -x php,html,txt   Ta tìm được directory hidden đó là /development và trả ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">A blog about cybersecurity, hacking, pentesting, red teaming and more.</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Ired-Team-From-Domain-Admin-to-Enterprise-Admin"><span class="toc-number">1.</span> <span class="toc-text">Ired.Team From Domain Admin to Enterprise Admin</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Overview"><span class="toc-number">1.1.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Build-lab"><span class="toc-number">1.2.</span> <span class="toc-text">Build lab</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Parent-child-domain"><span class="toc-number">1.3.</span> <span class="toc-text">Parent-child domain</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forest-Trust"><span class="toc-number">1.4.</span> <span class="toc-text">Forest Trust</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#From-DA-to-EA"><span class="toc-number">1.5.</span> <span class="toc-text">From DA to EA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-1-Xac-nhan-trust-parent-child"><span class="toc-number">1.5.1.</span> <span class="toc-text">Bước 1: Xác nhận trust parent-child</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-2-Xac-nhan-Domain-Admin"><span class="toc-number">1.5.2.</span> <span class="toc-text">Bước 2: Xác nhận Domain Admin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-3-Lay-SID-cua-Enterprise-Admins-parent"><span class="toc-number">1.5.3.</span> <span class="toc-text">Bước 3: Lấy SID của Enterprise Admins (parent)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-4-Bat-dau-chay-psexec-exe-mo-CMD-moi-voi-quyen-SYSTEM"><span class="toc-number">1.5.4.</span> <span class="toc-text">Bước 4: Bắt đầu chạy psexec.exe mở CMD mới với quyền SYSTEM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-5-Tao-golden-ticket-trong-mimikatz"><span class="toc-number">1.5.5.</span> <span class="toc-text">Bước 5: Tạo golden ticket trong mimikatz</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-6-Nap-ticket-va-kiem-tra"><span class="toc-number">1.5.6.</span> <span class="toc-text">Bước 6: Nạp ticket và kiểm tra</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-7"><span class="toc-number">1.5.7.</span> <span class="toc-text">Bước 7:</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/15/2025-11-04-THM-Basic-Pentesting/" title="Tryhackme Basic Pentesting Challenge">Tryhackme Basic Pentesting Challenge</a><time datetime="2025-11-14T19:34:38.244Z" title="Created 2025-11-15 02:34:38">2025-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/15/2025-11-03-I.redteam-Kerberoasting/" title="Ired.Team Kerberoasting (Credential Access)">Ired.Team Kerberoasting (Credential Access)</a><time datetime="2025-11-14T19:34:38.244Z" title="Created 2025-11-15 02:34:38">2025-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/15/2025-11-07-Ysoserial-CC5/" title="Ysoserial Commons Collections 5 Analyst">Ysoserial Commons Collections 5 Analyst</a><time datetime="2025-11-14T19:34:38.244Z" title="Created 2025-11-15 02:34:38">2025-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/15/2025-11-07-I.redteam-Kerberos-Golden-Ticket/" title="Ired.Team Kerberos Golden Tickets Lab">Ired.Team Kerberos Golden Tickets Lab</a><time datetime="2025-11-14T19:34:38.244Z" title="Created 2025-11-15 02:34:38">2025-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/15/2025-11-14-CSRF-PortSwigger-Challenge/" title="PortSwigger CSRF Challenge WriteUps">PortSwigger CSRF Challenge WriteUps</a><time datetime="2025-11-14T19:34:38.244Z" title="Created 2025-11-15 02:34:38">2025-11-15</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>