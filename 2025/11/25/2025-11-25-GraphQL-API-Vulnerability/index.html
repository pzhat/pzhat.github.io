<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>GraphQL API Vulnerability | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="GraphQL API Vulnerability PortSwigger ChallengeOverview về GraphQLGraphQL là một ngôn ngữ truy vấn cho API (Query Language for APIs) và cũng là một môi trường thực thi phía máy chủ (server-side runtim">
<meta property="og:type" content="article">
<meta property="og:title" content="GraphQL API Vulnerability">
<meta property="og:url" content="https://pzhat.github.io/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="GraphQL API Vulnerability PortSwigger ChallengeOverview về GraphQLGraphQL là một ngôn ngữ truy vấn cho API (Query Language for APIs) và cũng là một môi trường thực thi phía máy chủ (server-side runtim">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-11-24T21:38:11.491Z">
<meta property="article:modified_time" content="2025-11-24T21:38:38.052Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="PortSwigger">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "GraphQL API Vulnerability",
  "url": "https://pzhat.github.io/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2025-11-24T21:38:11.491Z",
  "dateModified": "2025-11-24T21:38:38.052Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'GraphQL API Vulnerability',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">GraphQL API Vulnerability</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">GraphQL API Vulnerability</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-24T21:38:11.491Z" title="Created 2025-11-25 04:38:11">2025-11-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-24T21:38:38.052Z" title="Updated 2025-11-25 04:38:38">2025-11-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="GraphQL-API-Vulnerability-PortSwigger-Challenge"><a href="#GraphQL-API-Vulnerability-PortSwigger-Challenge" class="headerlink" title="GraphQL API Vulnerability PortSwigger Challenge"></a>GraphQL API Vulnerability PortSwigger Challenge</h1><h3 id="Overview-ve-GraphQL"><a href="#Overview-ve-GraphQL" class="headerlink" title="Overview về GraphQL"></a>Overview về GraphQL</h3><p>GraphQL là một ngôn ngữ truy vấn cho API (Query Language for APIs) và cũng là một môi trường thực thi phía máy chủ (server-side runtime) để thực hiện các truy vấn đó.</p>
<p>Để dễ hiểu hãy hình dung như sau: </p>
<ul>
<li>Với <code>API truyền thống</code> (như REST API): Bạn phải gọi nhiều <code>&quot;endpoint&quot;</code>(đường dẫn) khác nhau để lấy các loại dữ liệu khác nhau.</li>
</ul>
<p>Ví dụ: để lấy thông tin người dùng và các bài viết của họ, bạn có thể phải gọi &#x2F;users&#x2F;1 để lấy thông tin người dùng, sau đó gọi <code>/users/1/posts</code> để lấy danh sách bài viết. Bạn thường nhận về toàn bộ dữ liệu mà endpoint đó cung cấp, dù bạn có cần hết hay không.</p>
<ul>
<li>Với <code>GraphQL</code>: Bạn chỉ cần <code>một endpoint duy nhất</code>. Phía <code>client</code> (ứng dụng của bạn) sẽ gửi một truy vấn (query) duy nhất mô tả chính xác những dữ liệu nào nó cần.</li>
</ul>
<p>Ví dụ: Bạn có thể gửi một truy vấn duy nhất yêu cầu “lấy tên và email của người dùng có ID là 1, và chỉ lấy tiêu đề của 3 bài viết gần nhất của người đó”.</p>
<figure class="highlight graphql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">query</span> <span class="punctuation">&#123;</span></span><br><span class="line">  user<span class="punctuation">(</span><span class="symbol">id</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    name</span><br><span class="line">    email</span><br><span class="line">    posts<span class="punctuation">(</span><span class="symbol">last</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">      title</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Các đặc điểm chính của GraphQL:</p>
<ul>
<li>Lấy chính xác những gì bạn cần: Giúp tránh tình trạng “over-fetching” (lấy quá nhiều dữ liệu không cần thiết) và “under-fetching” (phải gọi thêm nhiều API khác để lấy đủ dữ liệu). Điều này rất hữu ích cho các ứng dụng di động có băng thông hạn chế.</li>
<li>Một yêu cầu, nhiều tài nguyên: Có thể lấy nhiều tài nguyên liên quan (như người dùng, bài viết, bình luận) chỉ trong một lần gọi API duy nhất.</li>
<li>Hệ thống kiểu dữ liệu mạnh mẽ (Strongly Typed): Toàn bộ API được định nghĩa bằng một “schema”, trong đó mô tả rõ ràng tất cả các loại dữ liệu và các truy vấn có thể thực hiện. Điều này giúp client và server có chung một “ngôn ngữ”, dễ dàng phát triển và kiểm tra.</li>
<li>Tự động tạo tài liệu (Self-documenting): Nhờ có schema, tài liệu API luôn được cập nhật và có thể được khám phá tự động (thông qua công cụ như GraphiQL hoặc GraphQL Playground).</li>
<li>Không phụ thuộc vào cơ sở dữ liệu: GraphQL chỉ là một lớp nằm giữa client và các dịch vụ backend của bạn. Nó có thể lấy dữ liệu từ bất kỳ đâu: cơ sở dữ liệu SQL, NoSQL, các REST API khác, hoặc thậm chí là một file tĩnh.</li>
</ul>
<h3 id="Lab-exploit-and-POC"><a href="#Lab-exploit-and-POC" class="headerlink" title="Lab exploit and POC"></a>Lab exploit and POC</h3><h4 id="Lab-Accessing-private-GraphQL-posts"><a href="#Lab-Accessing-private-GraphQL-posts" class="headerlink" title="Lab: Accessing private GraphQL posts"></a>Lab: Accessing private GraphQL posts</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The blog page for this lab contains a hidden blog post that has a secret password. To solve the lab, find the hidden blog post and enter the password.</span><br></pre></td></tr></table></figure>

<p>Đây là một trang web blog sử dụng graphQL API bây giờ ta sẽ sử dụng burpsuite để bắt các request.</p>
<p><img src="https://hackmd.io/_uploads/BJFxrbjg-g.png" alt="image"></p>
<p>Ở đây sau khi nó load xong trang thì ta thấy một POST request với API là <code>/graphql/v1</code> đây chính là request gọi đến <code>graphql</code> ta có thế thấy ở bên dưới là câu query của nó gọi đến <code>allBlogPosts</code> ta có thể thấy rằng response trả về là data của trang blog.</p>
<p>Vậy với nội dung query xuất hiện ở bên trong request như này liệu ta có thao túng được nó để có thể thay đổi nội dung mà mình cần không?</p>
<p><img src="https://hackmd.io/_uploads/rkKF8bolZl.png" alt="image"></p>
<p>Tại đây sau khi thử inject vào : </p>
<figure class="highlight graphql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"> <span class="string">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;&#123;__typename&#125;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Ta thấy rằng response trả về kết quả 200 cùng với kết quả câu query.</p>
<p><img src="https://hackmd.io/_uploads/HJSgPWoeWg.png" alt="image"></p>
<p>Với tiêu đề của bài ta đã đọc ở trên thì sẽ có 1 secret password nằm trong bài blog nào đó, với lab này có vẻ như không có filter nào hết và ta hoàn toàn có thể thao túng query vì vậy ta có thể thao túng đến các blog và lấy thử password được giấu trong blog đó.</p>
<p><img src="https://hackmd.io/_uploads/SJtOvWixbe.png" alt="image"></p>
<p>Sau khi bấm đại đại vào một blog nào đó ta có thể thấy được biến id nằm trong request của API bây giờ ta sẽ thử thêm cả một biến nữa đó là biến <code>postPassword</code> xem thử nó sẽ ra kết quả như nào,</p>
<p><img src="https://hackmd.io/_uploads/SJJe6Zix-l.png" alt="image"></p>
<p>Ở đây với postid&#x3D;4 thì có vẻ như không có password trong này nên ta sẽ bắt request của trang chính khi mà nó hiển thị tất cả blog cà inject giá trị password vào để kiểm tra hết.</p>
<p><img src="https://hackmd.io/_uploads/HyH56Wol-g.png" alt="image"></p>
<p>Gọi hết thì thấy thiếu đi id&#x3D;3 chắc nó giấu rồi nên trở lại với request gọi từng bài và thay giá trị id từ 4 về 3 sau đó gửi thử.</p>
<p><img src="https://hackmd.io/_uploads/rJ_66-sebe.png" alt="image"></p>
<p>Thành công lấy được postPassword và solve lab.</p>
<h4 id="Lab-Accidental-exposure-of-private-GraphQL-fields"><a href="#Lab-Accidental-exposure-of-private-GraphQL-fields" class="headerlink" title="Lab: Accidental exposure of private GraphQL fields"></a>Lab: Accidental exposure of private GraphQL fields</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The user management functions for this lab are powered by a GraphQL endpoint. The lab contains an access control vulnerability whereby you can induce the API to reveal user credential fields.</span><br><span class="line"></span><br><span class="line">To solve the lab, sign in as the administrator and delete the username carlos.</span><br></pre></td></tr></table></figure>

<p>Đến với lab này thì yêu cầu đề đã thay đổi bây giờ nó bắt mình khai thác lỗ hổng access control bằng graphql sau đó dùng quyền admin để xoá đi username carlos, bây giờ ta sẽ tiếp tục bắt request xem thử kết quả trả về ra sao.</p>
<p><img src="https://hackmd.io/_uploads/HkdyBmogWl.png" alt="image"></p>
<p>Như cũ ta vẫn sẽ bắt được cái API gọi graphql ở đây nó query đến hết nội dung của trang bây giờ ta sẽ tiến hành login.</p>
<p><img src="https://hackmd.io/_uploads/B18Fm02gbg.png" alt="image"></p>
<p>Tại đây ta bắt được một request gọi đến graphql login ở đây ta thấy rằng response ta đã login thành công với user wiener.</p>
<p>Sau đó ta sẽ sử dụng một extension đã tải từ Bapp của burpsuite có tên là InQL Scanner để tiến hành phân tích request graphql vừa rồi.</p>
<p><img src="https://hackmd.io/_uploads/SJBDdKTe-x.png" alt="image"></p>
<p>Tại đây ta tìm được một query nhạy cảm đó là <code>getUser</code> có khả năng trả về username và password và nó nhận biến id để truy xuất user theo số id vậy bây giờ ta sẽ copy đoạn query này và đưa nó vào request để xem ta có lợi dụng nó thay đổi biến id để lấy được username và password của user admin không.</p>
<p><img src="https://hackmd.io/_uploads/Sk5tFK6lbl.png" alt="image"></p>
<p>Nó trả lỗi về dòng <code>&quot;Unknown operation named &#39;login&#39;.&quot;</code> ta sẽ đổi getUser thành login vì đây là đoạn mình sẽ phải query đến chức năng login.</p>
<p><img src="https://hackmd.io/_uploads/BJ0pYtpgbl.png" alt="image"></p>
<p>Thành công leak ra được username password của user peter, bây giờ ta tiếp tục thay đổi id đến khi tìm được admin.</p>
<p><img src="https://hackmd.io/_uploads/rJ2W5Yag-g.png" alt="image"></p>
<p>Thành công lấy được username và password của administrator bây giờ đăng nhập vào admin và xoá user carlos thôi.</p>
<p><img src="https://hackmd.io/_uploads/HJdO9YTebg.png" alt="image"></p>
<h4 id="Lab-Finding-a-hidden-GraphQL-endpoint"><a href="#Lab-Finding-a-hidden-GraphQL-endpoint" class="headerlink" title="Lab: Finding a hidden GraphQL endpoint"></a>Lab: Finding a hidden GraphQL endpoint</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The user management functions for this lab are powered by a hidden GraphQL endpoint. You won&#x27;t be able to find this endpoint by simply clicking pages in the site. The endpoint also has some defenses against introspection.</span><br><span class="line"></span><br><span class="line">To solve the lab, find the hidden endpoint and delete carlos</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/B15iSqaeWg.png" alt="image"></p>
<p>Sau khi vào page và tiến hành thử đăng nhập thì ở đây đúng như description của bài đã nói rằng bây giờ cái graphql đã hidden nên ta sẽ không tìm được endpoint <code>/graphql</code> như mấy lab trước. Bây giờ ta sẽ tiến hành brute-force thử để tìm các endpoint graphql ở đây tôi có tạo một cái list nhỏ.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/graphql</span><br><span class="line">/api</span><br><span class="line">/graphql/v1</span><br><span class="line">/api/graphql</span><br><span class="line">/v1</span><br><span class="line">/v1/graphql</span><br><span class="line">/graphql/graphql</span><br><span class="line">/api</span><br><span class="line">/api/graphql</span><br></pre></td></tr></table></figure>

<p>Bây giờ gửi request vào intruder và tiến hành brute force xem thử response trả về ra sao.</p>
<p><img src="https://hackmd.io/_uploads/Hy7PcfRgbg.png" alt="image"></p>
<p>Ở đây ta thấy hầu như nó sẽ đều trả về status code là 404 là not found nhưng riêng với <code>/api</code> thì status code trả về kết quả là 405 có nghĩa là method not allowed vậy thì có nghĩa endpoint này tồn tại bây giờ đem nó ra repeater xem thử.</p>
<p><img src="https://hackmd.io/_uploads/Hy3xsM0e-e.png" alt="image"></p>
<p>Ta thấy rằng nó trả về method not allowed bây giờ ta sẽ thử đổi method thành GET xem kết quả trả về ra sao.</p>
<p><img src="https://hackmd.io/_uploads/SytmjfRlbl.png" alt="image"></p>
<p>Nó trả về dòng <code>&quot;Query not present&quot;</code> do là ở đây ta chưa có viết query của graphql vào nên nó không có gì thì nó báo bây giờ ta sẽ thử một query đơn giản xem sao.</p>
<p><img src="https://hackmd.io/_uploads/H1dRhGRgWl.png" alt="image"></p>
<p>Tại đây mình inject vào : </p>
<figure class="highlight graphql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="string">&quot;query&quot;</span><span class="punctuation">:</span><span class="string">&quot;query&#123;__typename&#125;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Ở đây nó vẫn trả về kết qủa của <code>__typename</code> đây đơn giản là một meta-field luôn có sẵn trong GraphQL. Nó đơn giản trả về tên của type hiện tại trong kết quả. Vậy bây giờ ta sẽ thử với Introspection thì sao bây giờ vào inql để chỉnh lại cái typename thành schema thử xem vì introspection thường ám chỉ việc truy vấn schema bằng các field đặc biệt như <code>__schema</code> hoặc <code>__type</code>. Những field này cho phép attacker khám phá toàn bộ cấu trúc API.</p>
<p><img src="https://hackmd.io/_uploads/HkmS0GCgZg.png" alt="image"></p>
<p>Sau khi inject sửa thành : </p>
<figure class="highlight graphql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">query</span><span class="punctuation">&#123;</span>__schema<span class="punctuation">&#123;</span>queryType<span class="punctuation">&#123;</span>name<span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Thì đã bị ăn một cái error là <code>&quot;GraphQL introspection is not allowed, but the query contained __schema or __type&quot;</code> vậy là ở đây introspection bị chặn rồi bây giờ ta phải tìm cách để bypass được bước này.</p>
<p>Ở đây sau khi tìm kiếm vài nguồn thì có cái trick áp dụng thành công đó là xuống dòng, cái trick này nó không hẳn là cách để bypass introspection mà cía này nó liên quan đến cách mà server parse GraphQl vì ở đây thì theo standard thì graphql cho phép ta xuống dòng nhưng ở đây filter có vẻ như đã dùng cơ chế lọc string hoặc có thể là xài regex để bắt các keyword như <code>__schema</code> và có vẻ nó chưa được filter chặt ở các đoạn xuống hàng hoặc khoảng trắng thì trong trường hợp này nó đã không làm tốt đoạn payload ta có thể xuống hàng vì nó sẽ chỉ check graphql nằm trên cùng 1 hàng.</p>
<p><img src="https://hackmd.io/_uploads/SJBFeX0xZx.png" alt="image"></p>
<p>Ở đây schema có thể hoạt động có nghĩa là introspection có họat động bây giờ ta sẽ tìm cách truy vấn schema đến các object ta cần.</p>
<p>Tham khảo thêm ở : <a target="_blank" rel="noopener" href="https://graphql.org/learn/introspection/">https://graphql.org/learn/introspection/</a></p>
<p>Tại đây sử dụng câu truy vấn kiếm được từ nguồn để leak trường bên trong.</p>
<p><img src="https://hackmd.io/_uploads/B1RHGm0l-g.png" alt="image"></p>
<p>Ở đây ta sẽ để ý đến là có User và có cả chức năng <code>DeleteOrganizationUser</code> đây là một mảnh ghép thông tin rất lớn, bây giờ ta sẽ tìm cách dùng schema leak user.</p>
<p><img src="https://hackmd.io/_uploads/SknxXmAgWg.png" alt="image"></p>
<p>Không thấy dữ liệu nào trở về nên ta sẽ kiếm thêm coi có payload introspection nào có thể leak ra dữ liệu không.</p>
<p>Sau khi mò trong <a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL%20Injection</a> thì mình có payload để có thể test vào.</p>
<p><img src="https://hackmd.io/_uploads/ByoKmmCxbx.png" alt="image"></p>
<p>Vì payload test rất rộng nên response trả về rất nhiều dữ liệu nên ta sẽ phải nhờ đến extension inql để lấy query ra nhìn cho dễ.</p>
<p><img src="https://hackmd.io/_uploads/rJr_L7AlWg.png" alt="image"></p>
<p>Tại đây ở query ta thấy có <code>getUser</code> và ở Mutation có <code>deleteOrganizationUser</code> bây giờ ta sẽ test với query <code>getUser</code> trước xem sao.</p>
<p><img src="https://hackmd.io/_uploads/r1O1w7Ae-l.png" alt="image"></p>
<p>Vừa mới nhét cái id&#x3D;1 thì nó đã nổ ra luôn username là administrator luôn bây giờ ta sẽ tìm id của user carlos xem thử.</p>
<p><img src="https://hackmd.io/_uploads/S1kmDmReWe.png" alt="image"></p>
<p>Tìm được user carlos có id là 3 bây giờ ta sẽ lợi dụng <code>deleteOrganiztionUser</code> để xóa đi user carlos graphql sẽ thực hiện truy vấn và xóa đi user carlos.</p>
<p><img src="https://hackmd.io/_uploads/BkFeOm0ebg.png" alt="image"></p>
<p>Thành công xóa user carlos ở đây có cái message <code>Exception while fetching data (/deleteOrganizationUser) : User does not exist</code> vì lỡ click 2 lần nó xóa rồi xóa lần nữa thì còn cái nịt mà xóa.</p>
<p><img src="https://hackmd.io/_uploads/SJYmum0e-x.png" alt="image"></p>
<p>Thành công solve lab.</p>
<h4 id="Lab-Bypassing-GraphQL-brute-force-protections"><a href="#Lab-Bypassing-GraphQL-brute-force-protections" class="headerlink" title="Lab: Bypassing GraphQL brute force protections"></a>Lab: Bypassing GraphQL brute force protections</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The user login mechanism for this lab is powered by a GraphQL API. The API endpoint has a rate limiter that returns an error if it receives too many requests from the same origin in a short space of time.</span><br><span class="line"></span><br><span class="line">To solve the lab, brute force the login mechanism to sign in as carlos. Use the list of authentication lab passwords as your password source.</span><br></pre></td></tr></table></figure>

<p>Đọc description thì ta cũng đã hiểu phần nào về bài rằng bây giờ ở chức năng login sẽ sử dụng graphql nhưng vẫn đề là API endpoint đã bị rate limit nếu request quá nhiều nó sẽ bị sleep trong một khoảng thời gian vì thế sẽ khó để có thể brute force như là ở lab trước.</p>
<p><img src="https://hackmd.io/_uploads/rkTSMdWZZg.png" alt="image"></p>
<p>Sau khi tôi thử đăng nhập vài lần liên tục thì đã dính rate limit và nó sẽ sleep trong vòng 1 phút thì tương tự đó nếu thực hiện các thao tác khác nhiều lần nó cũng sẽ bị rate limit.</p>
<p><img src="https://hackmd.io/_uploads/r1Qb7u-bWg.png" alt="image"></p>
<p>Bây giờ chuyển sang tab đọc graphql thì ta thấy một cái mutation login.</p>
<ul>
<li><p>Mutation là một loại operation trong GraphQL dùng để thay đổi dữ liệu trên server.</p>
</li>
<li><p>Nếu query chỉ để đọc dữ liệu (giống như SELECT trong SQL), thì mutation giống như các thao tác ghi&#x2F;chỉnh sửa (INSERT, UPDATE, DELETE).</p>
</li>
</ul>
<p>Vậy ở đây ta có một cái mutation dùng để login vậy có cách nào để ta lợi dụng nó để có thể brute force là lấy được credentials của user carlos không, tại đây ta sẽ phải tìm hướng bypass được cái rate limit và tìm đường brute force.</p>
<p>Sau khi tìm kiếm ở document thì có một cách đó là sử dụng alias.</p>
<p><img src="https://hackmd.io/_uploads/BybmVdZZ-g.png" alt="image"></p>
<ul>
<li><p>GraphQL cho phép dùng alias để gọi nhiều mutation trong cùng một request.</p>
</li>
<li><p>Rate limiter chỉ tính số lượng request, không tính số lượng alias bên trong.</p>
</li>
<li><p>Nghĩa là ta có thể gửi một request duy nhất nhưng chứa hàng chục (hoặc hàng trăm) lần thử mật khẩu khác nhau.</p>
</li>
</ul>
<p>Vậy có nghĩa kịch bản tấn công là ta sẽ tạo một mutation có nhiều alias đăng nhập để có thể đăng nhập nhiều lần chỉ trong 1 request có nghĩa ta sẽ test được nhiều password của user carlos trong 1 lần và đó là cách bypass để brute force được cơ chế rate limit ở đây.</p>
<p><img src="https://hackmd.io/_uploads/BkHT8OWW-l.png" alt="image"></p>
<p>Sau khi viết lại mutation để có thể brute thì ở đây ta thành công gửi nhiều request cùng lúc nhưng ở đây kết quả false hết nên ta sẽ phải tìm thêm cái wordlist để brute cho chuẩn.</p>
<p><img src="https://hackmd.io/_uploads/rywOt_Wbbx.png" alt="image"></p>
<p>Sau khi tạo hết request để test password trong wordlist thì ta đã tìm ra được password của user carlos khi mà request brute thứ 65 đã trả cho về giá trị là true.</p>
<p><img src="https://hackmd.io/_uploads/SJk0KubZ-l.png" alt="image"></p>
<p>Thành công có được password bây giờ tôi sẽ thử đăng nhập xem có truy cập được không.</p>
<p><img src="https://hackmd.io/_uploads/HylUb5u-W-g.png" alt="image"></p>
<p>Thành công đăng nhập vào user carlos và solve lab.</p>
<h4 id="Lab-Performing-CSRF-exploits-over-GraphQL"><a href="#Lab-Performing-CSRF-exploits-over-GraphQL" class="headerlink" title="Lab: Performing CSRF exploits over GraphQL"></a>Lab: Performing CSRF exploits over GraphQL</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The user management functions for this lab are powered by a GraphQL endpoint. The endpoint accepts requests with a content-type of x-www-form-urlencoded and is therefore vulnerable to cross-site request forgery (CSRF) attacks.</span><br><span class="line"></span><br><span class="line">To solve the lab, craft some HTML that uses a CSRF attack to change the viewer&#x27;s email address, then upload it to your exploit server.</span><br><span class="line"></span><br><span class="line">You can log in to your own account using the following credentials: wiener:peter.</span><br></pre></td></tr></table></figure>

<p>Đến với bài lab cuối này thì ngay ở tiêu đề thì ta đã biết rằng bây giờ sẽ phải tìm cách lợi dụng graphql để có thể thực hiện CSRF, nó còn nói rằng nếu như có endpoint accept loại content-type là <code>x-www-form-urlencoded</code> thì nó có thể bị CSRF không nói nhiều vào bài luôn.</p>
<p><img src="https://hackmd.io/_uploads/S1ifoHzZZe.png" alt="image"></p>
<p>Sau khi đăng nhập bằng user wiener thì có thể thấy một chức năng update email y hệt như các lab CSRF trước đây bây giờ mình sẽ thử update mail lên và bắt request về.</p>
<p><img src="https://hackmd.io/_uploads/S1ijiSfbbe.png" alt="image"></p>
<p>Ở đây ta sẽ thấy câu query graphql để mà thực hiện update email lên rồi bên response trả về thực hiện câu query thành công bây giờ email đã bị đổi.</p>
<p>Ở đây nếu như muốn thực hiện CSRF qua câu query của graphql thì ta sẽ thử đổi method header 2 lần từ POST thành GET và về lại POST để thay đổi content type hoặc là ta sẽ tự thay đổi luôn content type cho nhanh thành <code>Content-Type: application/x-www-form-urlencoded</code> với content type này thì có lý do để nó phải thành như vậy đó là: </p>
<p>Cơ chế CSRF hoạt động dựa trên trình duyệt: Khi nạn nhân truy cập một trang HTML độc hại, trình duyệt sẽ tự động gửi request kèm cookie session của họ đến server.</p>
<ul>
<li><p>Trình duyệt chỉ tự động gửi form với một số loại content-type mặc định:</p>
</li>
<li><p>application&#x2F;x-www-form-urlencoded</p>
</li>
<li><p>multipart&#x2F;form-data</p>
</li>
<li><p>text&#x2F;plain Đây là các loại mà HTML form hỗ trợ trực tiếp.</p>
</li>
</ul>
<p>GraphQL endpoint mặc định thường nhận JSON (application&#x2F;json):</p>
<ul>
<li><p>Nếu request yêu cầu application&#x2F;json, thì attacker không thể tạo một form HTML đơn giản để gửi dữ liệu, vì form không hỗ trợ gửi JSON.</p>
</li>
<li><p>Muốn gửi JSON thì phải dùng JavaScript (fetch, XMLHttpRequest), nhưng khi đó lại bị chặn bởi Same-Origin Policy (SOP), nên không thể thực hiện CSRF.</p>
</li>
</ul>
<p>Khi server chấp nhận application&#x2F;x-www-form-urlencoded:</p>
<ul>
<li><p>Attacker có thể tạo một form HTML bình thường với method&#x3D;”POST” và enctype&#x3D;”application&#x2F;x-www-form-urlencoded”.</p>
</li>
<li><p>Trình duyệt sẽ tự động gửi request kèm cookie của nạn nhân.</p>
</li>
<li><p>Như vậy, attacker có thể ép nạn nhân thực hiện hành động (ví dụ: đổi email) mà không cần vượt qua SOP.</p>
</li>
</ul>
<p>Còn kịch bản ở đây là sẽ cố gắng lợi dụng CSRF và graphql để thực hiện graphql query nhằm thay đổi được email của victim mà mình gửi payload tới.</p>
<p><img src="https://hackmd.io/_uploads/r1aipBzW-x.png" alt="image"></p>
<p>Sau khi mình gửi request thay đổi content-type thì nó trả về dòng <code>&quot;Query not present&quot;</code> nó là bình thường tại ở đây là đổi sang Content-Type: application&#x2F;x-www-form-urlencoded, server không còn nhận dữ liệu ở dạng JSON nữa. Nhưng với x-www-form-urlencoded, dữ liệu phải được encode theo dạng form.</p>
<p><img src="https://hackmd.io/_uploads/r17FCrfbZx.png" alt="image"></p>
<p>Tại đây sau khi sửa và thêm url encoded thì ta đã thành công trong việc gửi đi được query đúng chuẩn bây giờ kịch bản tấn công sẽ lợi dụng việc query này ta sẽ tạo payload CSRF sau đó gửi tới victim khi mà click vào thì nó sẽ thực hiện html nhằm thay đổi được email của victim.</p>
<p><img src="https://hackmd.io/_uploads/HJpWyIGZWl.png" alt="image"></p>
<p>Tại đây mình sẽ dùng chức năng gen ra CSRF POC luôn cho nhanh để thực hiện gửi exploit tới exploit server hay là victim mà ta vừa nhắc tới à nhớ đổi email nữa.</p>
<p><img src="https://hackmd.io/_uploads/BkEKyLfWZe.png" alt="image"></p>
<p>Thành công exploit lab này khai thác được CSRF từ graphql và cũng kết thúc chuỗi lỗ hổng GraphQL.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/">https://pzhat.github.io/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/PortSwigger/">PortSwigger</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/01/2025-12-01-SSTI-Lab/" title="ServerSide Template Injection (SSTI) Lab"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">ServerSide Template Injection (SSTI) Lab</div></div><div class="info-2"><div class="info-item-1">ServerSide Template Injection (SSTI) LabSSTI là gìServer-Side Template Injection (SSTI) là một lỗ hổng bảo mật web nghiêm trọng cho phép kẻ tấn công chèn mã độc vào template của ứng dụng, dẫn đến việc mã này được thực thi trên phía server. Lỗ hổng này thường xảy ra khi dữ liệu đầu vào từ người dùng được nối trực tiếp vào template thay vì được truyền dưới dạng dữ liệu an toàn. Cơ chế hoạt động của SSTISSTI xảy ra khi web app sử dụng template engine để hiển thị nội dung động (dynamic) nhưng lại...</div></div></div></a><a class="pagination-related" href="/2025/11/16/2025-11-16-CORS-PortSwigger/" title="PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUpOverview về CORSCORS là gì? Vì sao lại xuất hiện CORS (Cross-Origin Resource Sharing) là một cơ chế bảo mật trong web cho phép các tài nguyên trên một máy chủ được chia sẻ với các trang web có nguồn (origin) khác. “Nguồn” ở đây được định nghĩa bởi ba yếu tố: giao thức (http, https), tên miền (domain), và cổng (port).  Theo mặc định, các trình duyệt web tuân thủ Chính sách Cùng Nguồn Gốc (Same-Origin Policy - SOP). Chính sách nà...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/16/2025-11-16-CORS-PortSwigger/" title="PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-16</div><div class="info-item-2">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUpOverview về CORSCORS là gì? Vì sao lại xuất hiện CORS (Cross-Origin Resource Sharing) là một cơ chế bảo mật trong web cho phép các tài nguyên trên một máy chủ được chia sẻ với các trang web có nguồn (origin) khác. “Nguồn” ở đây được định nghĩa bởi ba yếu tố: giao thức (http, https), tên miền (domain), và cổng (port).  Theo mặc định, các trình duyệt web tuân thủ Chính sách Cùng Nguồn Gốc (Same-Origin Policy - SOP). Chính sách nà...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-14-CSRF-PortSwigger-Challenge/" title="PortSwigger CSRF Challenge WriteUps"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">PortSwigger CSRF Challenge WriteUps</div></div><div class="info-2"><div class="info-item-1">PortSwigger CSRF Challenge WriteUpGiới thiệu về CSRF (Cross-Site Request Forgery)Lỗ hổng CSRF là gì : Cross-Site Request Forgery hay còn gọi theo tiếng việt là giả mạo yêu cầu trên nhiều trang, là một lỗ hổng bảo mật cho phép attacker lừa người dùng đã được xác thực (đã đăng nhập) thực hiện các hành động không mong muốn trên 1 ứng dụng Web. Nói đơn giản thì attacker sẽ mượn danh tính và session của một victim để gửi đi một yêu cầu giả mạo đến ứng dụng mà victim không hề hay biết. Nếu ứng dụng...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-FileUpload-Servlet/" title="Java Servlet FileUpload Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet FileUpload Vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet FileUpload Vulnerability by @PhatmhLỗ hổng File UploadBản chất của File Upload: File Upload đối với tôi nó đơn giản chỉ là lợidụng Unsafe Method để truyền một Untrusted Data vào nhằm thay đổi hànhvi của hệ thống trong trường hợp này là Web App, với FileUpload những gìUser Upload lên sẽ chính là Untrusted Data và với Feature Upload Filenhư này sẽ thế nào nếu nó không được Validate một cách cẩn thận ta sẽđến với DEMO bằng Java Servlet. Web App OverviewĐây là một Web App được dựng v...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Cookie-Arena-Cmdi/" title="Cookie Arena Challenges WU (@Phatmh)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Cookie Arena Challenges WU (@Phatmh)</div></div><div class="info-2"><div class="info-item-1">Cookie Arena Web Challenges WriteUp by (@Phatmh)NSLookup (Level 1)Đây là một Website có chức năng là nslookup sử dụng hàm shell_exec của php để thực thi. Ta tiến hành truy cập để xem giao diện của web app.Ở đây ta thấy nó khá là basic khi chỉ có duy nhất một nơi có chức năng nslookup và bên cạnh là source code cho sẵn của chall, ta sẽ tiến hành phân tích source code được cấp sẵn. Ở ngay đầu tiên ta gặp khởi tạo và include file design và tạo object ($design) có tên là NSLookup Tool. Đến với nh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Sql-Injection/" title="Java Servlet Sql Injection Vulnerability by @Phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Sql Injection Vulnerability by @Phatmh</div></div><div class="info-2"><div class="info-item-1">Java Servlet Sql Injection Vulnerability by @PhatmhTổng quan cấu trúc file java123456789101112131415161718192021222324252627282930313233343536373839+---.idea   +---dataSources+---.mvn   +---wrapper+---src   +---main      +---java         +---sql_injection             +---controller             +---dao             +---model             +---util      +---resources         +---META-INF      +---webapp          +---WEB-INF   +---test       +---java       +---resources+---target    +---classes    ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GraphQL-API-Vulnerability-PortSwigger-Challenge"><span class="toc-number">1.</span> <span class="toc-text">GraphQL API Vulnerability PortSwigger Challenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Overview-ve-GraphQL"><span class="toc-number">1.1.</span> <span class="toc-text">Overview về GraphQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lab-exploit-and-POC"><span class="toc-number">1.2.</span> <span class="toc-text">Lab exploit and POC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-Accessing-private-GraphQL-posts"><span class="toc-number">1.2.1.</span> <span class="toc-text">Lab: Accessing private GraphQL posts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-Accidental-exposure-of-private-GraphQL-fields"><span class="toc-number">1.2.2.</span> <span class="toc-text">Lab: Accidental exposure of private GraphQL fields</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-Finding-a-hidden-GraphQL-endpoint"><span class="toc-number">1.2.3.</span> <span class="toc-text">Lab: Finding a hidden GraphQL endpoint</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-Bypassing-GraphQL-brute-force-protections"><span class="toc-number">1.2.4.</span> <span class="toc-text">Lab: Bypassing GraphQL brute force protections</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lab-Performing-CSRF-exploits-over-GraphQL"><span class="toc-number">1.2.5.</span> <span class="toc-text">Lab: Performing CSRF exploits over GraphQL</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/05/2025-12-05-TryHackMe-Hammer/" title="Tryhackme Hammer challenge WriteUp">Tryhackme Hammer challenge WriteUp</a><time datetime="2025-12-04T18:19:12.763Z" title="Created 2025-12-05 01:19:12">2025-12-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/" title="IredTeam AS-REP Roasting">IredTeam AS-REP Roasting</a><time datetime="2025-12-01T19:26:14.492Z" title="Created 2025-12-02 02:26:14">2025-12-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/01/2025-12-01-SSTI-Lab/" title="ServerSide Template Injection (SSTI) Lab">ServerSide Template Injection (SSTI) Lab</a><time datetime="2025-12-01T08:32:26.148Z" title="Created 2025-12-01 15:32:26">2025-12-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/" title="GraphQL API Vulnerability">GraphQL API Vulnerability</a><time datetime="2025-11-24T21:38:11.491Z" title="Created 2025-11-25 04:38:11">2025-11-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/16/2025-11-16-CORS-PortSwigger/" title="PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp">PortSwigger CORS (Cross-Origin Resource Sharing) challenge WriteUp</a><time datetime="2025-11-16T09:11:55.936Z" title="Created 2025-11-16 16:11:55">2025-11-16</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>