<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Tryhackme Hammer challenge WriteUp | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="TryHackMe Hammer Web Challenge WriteUp Enumeration Tại đây, mình tiến hành scan và được 2 port đang mở bao gồm :   22&#x2F;tcp : đây là port SSH 1337&#x2F;tcp : đây là port của một cái http service và">
<meta property="og:type" content="article">
<meta property="og:title" content="Tryhackme Hammer challenge WriteUp">
<meta property="og:url" content="https://pzhat.github.io/2025/12/05/2025-12-05-TryHackMe-Hammer/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="TryHackMe Hammer Web Challenge WriteUp Enumeration Tại đây, mình tiến hành scan và được 2 port đang mở bao gồm :   22&#x2F;tcp : đây là port SSH 1337&#x2F;tcp : đây là port của một cái http service và">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-12-04T18:19:12.763Z">
<meta property="article:modified_time" content="2025-12-27T23:15:25.438Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Pentest">
<meta property="article:tag" content="RedTeam">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Tryhackme Hammer challenge WriteUp",
  "url": "https://pzhat.github.io/2025/12/05/2025-12-05-TryHackMe-Hammer/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2025-12-04T18:19:12.763Z",
  "dateModified": "2025-12-27T23:15:25.438Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/12/05/2025-12-05-TryHackMe-Hammer/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Tryhackme Hammer challenge WriteUp',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Tryhackme Hammer challenge WriteUp</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Tryhackme Hammer challenge WriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-04T18:19:12.763Z" title="Created 2025-12-05 01:19:12">2025-12-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-27T23:15:25.438Z" title="Updated 2025-12-28 06:15:25">2025-12-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/">pentesting</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/pentesting/Web-Exploitation/">Web-Exploitation</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="TryHackMe-Hammer-Web-Challenge-WriteUp"><a href="#TryHackMe-Hammer-Web-Challenge-WriteUp" class="headerlink" title="TryHackMe Hammer Web Challenge WriteUp"></a>TryHackMe Hammer Web Challenge WriteUp</h1><p><img src="https://hackmd.io/_uploads/S1-1mNlzbl.png" alt="image-14"></p>
<h3 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h3><p><img src="https://hackmd.io/_uploads/rJKJXExMZx.png" alt="image-15"></p>
<p>Tại đây, mình tiến hành scan và được 2 port đang mở bao gồm : </p>
<ul>
<li>22&#x2F;tcp : đây là port SSH</li>
<li>1337&#x2F;tcp : đây là port của một cái http service và cái web app này được host lên bằng apache httpd. Bây giờ mình sẽ truy cập vào trang web.</li>
</ul>
<h3 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h3><p><img src="https://hackmd.io/_uploads/HkmgQNeG-e.png" alt="image-16"></p>
<p>Sau khi truy cập web trả về cho mình một trang login. Vấn đề ở đây là mình không hề có account để truy cập vậy nên mình sẽ thử với các gói request qua burp proxy.</p>
<p><img src="https://hackmd.io/_uploads/BJVWmEefZx.png" alt="image-18"></p>
<p>Kiểm tra request thì ngoài trường cookie ra thì chưa có nhiều điểm đáng chú ý, take note cookie lại.</p>
<p><img src="https://hackmd.io/_uploads/rkffX4xGZg.png" alt="image-19"></p>
<p>Tại đây, mình thử truy cập vào chức năng reset password và được forward qua <code>/reset_password.php</code>. Vấn đề tại đây vẫn là thiếu đi email nên mình sẽ thử inspect source. </p>
<p><img src="https://hackmd.io/_uploads/rkGXQ4gMZg.png" alt="image-21"></p>
<p>Sau khi inspect vào souce thì mình để ý có đoạn :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Dev Note: Directory naming convention must be hmr_DIRECTORY_NAME --&gt;</span><br></pre></td></tr></table></figure>

<p>Có vẻ anh Dev note vào đây trong lúc code app mà quên xoá thì ở đây cái note nói rằng directory sẽ có dạng là <code>hmr_ABCXYZ</code> bây giờ mình sẽ tiến hành Fuzzing các directory ở đây.</p>
<p><img src="https://hackmd.io/_uploads/ry0Q74xzbx.png" alt="image-22"></p>
<p>Tại đây ta có được vài directory : </p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">css                     [Status: 301, Size: 323, Words: 20, Lines: 10, Duration: 110ms]</span><br><span class="line">images                  [Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 109ms]</span><br><span class="line">js                      [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 109ms]</span><br><span class="line">logs                    [Status: 301, Size: 324, Words: 20, Lines: 10, Duration: 120ms]</span><br></pre></td></tr></table></figure>

<p>Status đều là 301 nên ta sẽ truy cập vào xem từng cái : </p>
<p><img src="https://hackmd.io/_uploads/BJuNm4xzZe.png" alt="image-23"></p>
<p>Truy cập vào <code>hmr_css</code> thì chỉ có file CSS ngoài ra không có gì đáng chú ý.</p>
<p><img src="https://hackmd.io/_uploads/rk0SX4lMbe.png" alt="image-24"></p>
<p>Truy cập vào <code>hmr_images</code> có file ảnh hình cây búa và lại tiếp tục chẳng có gì.</p>
<p><img src="https://hackmd.io/_uploads/S1XUX4xGWg.png" alt="image-25"></p>
<p>Đây chưa file JS khá dài và không có thông tin đáng giá.</p>
<p><img src="https://hackmd.io/_uploads/By9IQElf-x.png" alt="image-26"></p>
<p>Đến với directory là <code>hmr_logs</code> có vẻ file log, thường file log sẽ để lộ các credentials nhạy cảm nên mình truy cập vào đọc.</p>
<p><img src="https://hackmd.io/_uploads/B1JwmVeGZe.png" alt="image-27"></p>
<p>Ở đây, mình có được một cái mail của một user đó là <code>tester@hammer.thm</code> bây giờ mình sẽ thử reset password với mail này xem có hợp lệ không.</p>
<p><img src="https://hackmd.io/_uploads/SyNPX4lGbl.png" alt="image-28"></p>
<p>Tại đây email đã qua bước đầu nhưng vẫn còn xác thực OPT trong vòng 200 giây, với thời gian dài như vậy mình nghĩ ngay tới brute force.</p>
<p>Tại đây mình dùng ffuf brute force OTP.</p>
<p><img src="https://hackmd.io/_uploads/ByKwXNgM-x.png" alt="image-29"></p>
<p>Ở đây mình dùng <code>sequence</code> tạo nhanh một wordlist 10k số từ 0000 &gt; 9999 để tiến hành brute.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w OTP.txt \</span><br><span class="line">-u http://10.49.162.194:1337/reset_password.php \</span><br><span class="line">-X POST \</span><br><span class="line">-d <span class="string">&quot;recovery_code=FUZZ&amp;s=60&quot;</span> \</span><br><span class="line">-H <span class="string">&quot;Cookie: PHPSESSID=ihgkqpmppe65lboqrhrnet7luk&quot;</span> \</span><br><span class="line">-H <span class="string">&quot;X-Forwarded-For: FUZZ&quot;</span> \</span><br><span class="line">-H <span class="string">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> \</span><br><span class="line">-fr <span class="string">&quot;Invalid&quot;</span> -s</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/SklO74eGZx.png" alt="image-30"></p>
<p>Nó thành công trả về OTP bypass được bây giờ thử nhập vào.</p>
<p><img src="https://hackmd.io/_uploads/B1LuXVxGbl.png" alt="image-31"></p>
<p>Bypass thành công bây giờ mình tiến hành reset password.</p>
<p><img src="https://hackmd.io/_uploads/BJwF4Nxzbx.png" alt="image"></p>
<p>Thành công login và có được flag đầu tiên.</p>
<p>Sau khi login ta có một funtion chạy các OS command, lúc đầu mình nghĩ sẽ là CMDi nhưng hoá ra nó block khá nhiều câu lệnh nên phải tìm thêm hướng khác.</p>
<p><img src="https://hackmd.io/_uploads/Skm9VEeGbx.png" alt="image-33"></p>
<p>Thử với câu lệnh ls thì nó leak ra một danh sách :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">188ade1.key</span><br><span class="line">composer.json</span><br><span class="line">config.php</span><br><span class="line">dashboard.php</span><br><span class="line">execute_command.php</span><br><span class="line">hmr_css</span><br><span class="line">hmr_images</span><br><span class="line">hmr_js</span><br><span class="line">hmr_logs</span><br><span class="line">index.php</span><br><span class="line">logout.php</span><br><span class="line">reset_password.php</span><br><span class="line">vendor</span><br></pre></td></tr></table></figure>

<p>Tại đây có một file là <code>188ade1.key</code> khả năng sẽ có key quan trọng nên mình thử lệnh cat.</p>
<p><img src="https://hackmd.io/_uploads/HyoqV4ef-g.png" alt="image-34"></p>
<p>Nó không cho cat nên ta sẽ thử truy cập trực tiếp. Bây giờ truy cập qua <code>http://10.49.162.194:1337/188ade1.key</code> nó sẽ download file về bây giờ tiến hành kiểm tra nội dung.</p>
<p><img src="https://hackmd.io/_uploads/S1goN4xG-l.png" alt="image-35"></p>
<p>Mình có được key, chưa biết mục đích của nó nên ta sẽ tìm hiểu thêm một chút tại web app.</p>
<p><img src="https://hackmd.io/_uploads/SkIoNVlfZx.png" alt="image-36"></p>
<p>Kiểm tra request, có thể thấy rằng web app sử dụng JWT để validate user mà cái key mình lấy có khả năng chính là secret key của JWT. Nếu đúng ta có thể sử dụng nó để nâng quyền user lên.</p>
<p><img src="https://hackmd.io/_uploads/B1nsV4eM-x.png" alt="image-37"></p>
<p>Decode JWT token ra, nó hiển thị cho ta các thông tin ở đây, mình để ý trường <code>kid</code> có giá trị là <code>/var/www/mykey.key</code> khả năng cao cái key này dùng để xác định rằng cái token có bị thay đổi không, và bên cạnh đó role vẫn là <code>user</code> nên mình sẽ tạo một payload JWT để có thể biến mình thành admin.</p>
<p><img src="https://hackmd.io/_uploads/S1PnNNgzZe.png" alt="image-45"></p>
<p>Đây là 3 giá trị chính mà mình thay đổi và thêm vào lý do là vì :</p>
<ul>
<li><p>File 188ade1.key chính là secret mà ứng dụng dùng để verify JWT.</p>
</li>
<li><p>Khi chỉnh kid trong header để trỏ đến file key, rồi dùng chính key đó để ký lại token, bạn bypass được hạn chế role và chiếm quyền admin.</p>
</li>
</ul>
<p>Và ở đây mình phải dùng chính file <code>188ade1.key</code> lấy key, trong đó để tạo ra được valid sign JWT thì nó mới trỏ đến file và nó sẽ xác nhận đúng phần payload được ở đây mình dùng công thức rồi đem vào trong JWT.io sau đó ta sẽ lấy token và inject vào.</p>
<p><img src="https://hackmd.io/_uploads/rJTnE4gMWx.png" alt="image-46"></p>
<p>Có vẻ ổn rồi bây giờ inject vào thử xem sao.</p>
<p><img src="https://hackmd.io/_uploads/SkrpEVlGbl.png" alt="image-47"></p>
<p>Thành công thực thi câu lệnh id thứ mà đã bị cấm ở lúc trước bây giờ thì cat file flag ra thôi.</p>
<p><img src="https://hackmd.io/_uploads/r1j64Vlzbg.png" alt="image-48"></p>
<p>Thành công cat được file flag và tin chắc rằng bây giờ ta đã thành công RCE được web server hoàn thành lab.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/12/05/2025-12-05-TryHackMe-Hammer/">https://pzhat.github.io/2025/12/05/2025-12-05-TryHackMe-Hammer/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RedTeam/">RedTeam</a><a class="post-meta__tags" href="/tags/Pentest/">Pentest</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/25/2025-12-25-CBJS-Misconfiguration/" title="CBJS Java Misconfiguration Challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">CBJS Java Misconfiguration Challenge</div></div><div class="info-2"><div class="info-item-1">CBJS Java Misconfiguration ChallengeStatement Viewer 1: Lỗ hổng từ đặc quyền “Privileged” và sự hớ hênh của AdminTổng quan ứng dụng  Ứng dụng cung cấp chức năng cơ bản: cho phép người dùng upload file (định dạng PDF&#x2F;TXT) và view statement để xem lại các tệp tin đã tải lên. Mỗi tệp tin được cấp một đường dẫn riêng biệt để truy xuất. Qua phân tích mã nguồn (Whitebox), chúng ta sẽ tập trung vào những &quot;backdoor&quot; mà developer đã bỏ quên. Phân tích lỗ hổng (Code Breakdown) Mắt xích y...</div></div></div></a><a class="pagination-related" href="/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/" title="IredTeam AS-REP Roasting"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">IredTeam AS-REP Roasting</div></div><div class="info-2"><div class="info-item-1">IredTeam AS-REP RoastingAS-REP là gì?AS-REP (viết tắt của Authentication Service Reply) là một thông điệp trong giao thức xác thực Kerberos. Đây là bước thứ hai trong quá trình xác thực ban đầu, được gửi từ Key Distribution Center (KDC), thường là một Domain Controller trong môi trường Active Directory, đến người dùng. Thông điệp này chứa Ticket-Granting Ticket (TGT), một ticket được mã hóa dùng để yêu cầu các vé dịch vụ khác mà không cần người dùng phải nhập lại mật khẩu. Một phần của thông ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-09-09-Pickle-Rick-THM/" title="TryHackme Pickle Rick Challenge WriteUp by Phatmh."><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">TryHackme Pickle Rick Challenge WriteUp by Phatmh.</div></div><div class="info-2"><div class="info-item-1">TryHackme Pickle Rick Challenge WriteUp by Phatmh.[link challenge]:https://tryhackme.com/room/picklerickTiến hành dùng Openvpn kết nối với Tryhackme.Tiến hành kiểm tra mình đã cùng mạng mới máy bên Tryhackme hay chưa.Câu hỏi và Ip của challenge nãy đã test và kết nối thành công. Bước 1: ReconSử dụng Nmap để tiến hành kiểm tra xem có port nào đang được mở ra, ở đây phát hiện ra được bên máy đang mở port 22&#x2F;tcp và port 88&#x2F;tcp ở đây tôi nghĩ là server nạn nhân đang chạy SSH và HTTP. Tư...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-THM-EvilGPT/" title="Tryhackme EvilGPT challenge WriteUp by @phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Tryhackme EvilGPT challenge WriteUp by @phatmh</div></div><div class="info-2"><div class="info-item-1">Tryhackme EvilGPT challenge WriteUp by @phatmhDùng netcat để tiến hành kết nối với chall và tiến hành LLM Inject để có thể moi được flag từ con AI.Sau khi test thử thì đây không phải con AI bình thường như tôi nghĩ mà nó là một con AI thực thi các câu lệnh OS vậy bây giờ tiến hành thử moi ra các thứ có trong server.Tiến hành đọc thử source code của con AI xem nó có những cái gì. Tóm tắt chức năngTập tin Python evilai.py là một server Telnet đơn giản. Khi người dùng kết nối, nó: Nhận yêu cầu t...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-10-10-PentesterLab-From-Sql-To-Shell/" title="Pentester Lab From Sql Injection to Shell"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Pentester Lab From Sql Injection to Shell</div></div><div class="info-2"><div class="info-item-1">Pentester Lab From Sql Injection to ShellFingerprinting Sử dụng nmap với cú pháp: 1sudo nmap -sV 192.168.179.132 -T4  Kết quả trả về cho thấy đang có 2 port đang được mở đó là port 22 và 80 như ta đã biết port 22 là SSH còn 80 là Apache httpd thì có nghĩa là nó đang host 1 cái web nào đó.  Tiến hành curl đến xem thử có tồn tại không và để lấy được source code của web được host ở đây nó đưa cho ta thông tin về server và web được code bằng PHP/5.3.3-7+squeeze14.  Truy cập GUI để cho dễ nhìn và ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-10-30-iredteam-from-DA-to-EA/" title="Ired.Team From Domain Admin to Enterprise Admin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team From Domain Admin to Enterprise Admin</div></div><div class="info-2"><div class="info-item-1">Ired.Team From Domain Admin to Enterprise AdminOverviewỞ lab này ta sẽ lợi dụng mối quan hệ giữa Parent-Child domain từ đó lợi dụng mối quan hệ đó và gây nên leo thang đặc quyền. Build lab SetUp domain đặt tên là offense.local đây là domain cha với IP là 192.168.10.10/24 và DNS: 127.0.0.1.   Đã cài xong Active Directory Domain Services (AD DS).  Đã promote máy thành Domain Controller cho domain: offense.local.  Đã có DNS Server chạy trên DC.  Đang dùng VMware host-only network.   Sau đó setup...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-03-I.redteam-Kerberoasting/" title="Ired.Team Kerberoasting (Credential Access)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team Kerberoasting (Credential Access)</div></div><div class="info-2"><div class="info-item-1">Ired.Team Kerberoasting (Credential Access)Giải thích về các khái niệmKerberos trong Active Directory Trong môi trường Windows Active Directory (AD), Kerberos là giao thức xác thực mặc định. Nó sử dụng các ticket để xác thực người dùng và dịch vụ mà không truyền mật khẩu qua mạng.  Các thành phần chính:  KDC (Key Distribution Center): Thường là Domain Controller (DC). TGT (Ticket Granting Ticket): Cấp cho user sau khi đăng nhập thành công → dùng để xin ticket cho dịch vụ. TGS (Ticket Granting...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-04-THM-Basic-Pentesting/" title="Tryhackme Basic Pentesting Challenge"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Tryhackme Basic Pentesting Challenge</div></div><div class="info-2"><div class="info-item-1">Tryhackme Basic Pentesting Challenge Sử dụng nmap để scan các port đang mở của target ở đây tôi sử dụng lệnh nmap -sV -T4 &lt;ip&gt; để scan cho nhanh và ta nhận được kết quả là 4 port đang mở. Với câu hỏi đầu là What is the name of the hidden directory on the web server ta sẽ tiến hành scan directory bằng gobuster ở đâu mình dùng lệnh :  1gobuster dir -u http://10.10.237.96 -w /usr/share/wordlists/dirb/common.txt -t 20 -x php,html,txt   Ta tìm được directory hidden đó là /development và trả ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#TryHackMe-Hammer-Web-Challenge-WriteUp"><span class="toc-number">1.</span> <span class="toc-text">TryHackMe Hammer Web Challenge WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumeration"><span class="toc-number">1.1.</span> <span class="toc-text">Enumeration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploitation"><span class="toc-number">1.2.</span> <span class="toc-text">Exploitation</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/2026-01-27-CVE-2025-14770/" title="Untitled">Untitled</a><time datetime="2026-01-27T14:19:14.489Z" title="Created 2026-01-27 21:19:14">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/2026-01-21-Ysoserial-CC3-Analyst/" title="Ysoserial Common Collections 3 Analyst (CC3)">Ysoserial Common Collections 3 Analyst (CC3)</a><time datetime="2026-01-21T05:35:18.206Z" title="Created 2026-01-21 12:35:18">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge">Velocity Server Side Template Injection Challenge</a><time datetime="2025-12-31T04:43:06.549Z" title="Created 2025-12-31 11:43:06">2025-12-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/25/2025-12-25-CBJS-Misconfiguration/" title="CBJS Java Misconfiguration Challenge">CBJS Java Misconfiguration Challenge</a><time datetime="2025-12-25T13:30:27.815Z" title="Created 2025-12-25 20:30:27">2025-12-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/05/2025-12-05-TryHackMe-Hammer/" title="Tryhackme Hammer challenge WriteUp">Tryhackme Hammer challenge WriteUp</a><time datetime="2025-12-04T18:19:12.763Z" title="Created 2025-12-05 01:19:12">2025-12-05</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>